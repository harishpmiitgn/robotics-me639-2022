/* USER CODE BEGIN Header */
/**
  ******************************************************************************
  * @file           : main.c
  * @brief          : Main program body
  ******************************************************************************
  * @attention
  *
  * Copyright (c) 2022 STMicroelectronics.
  * All rights reserved.
  *
  * This software is licensed under terms that can be found in the LICENSE file
  * in the root directory of this software component.
  * If no LICENSE file comes with this software, it is provided AS-IS.
  *
  ******************************************************************************
  */
/* USER CODE END Header */
/* Includes ------------------------------------------------------------------*/
#include "main.h"

/* Private includes ----------------------------------------------------------*/
/* USER CODE BEGIN Includes */
#include <string.h>
#include <stdio.h>
#include <math.h>
/* USER CODE END Includes */

/* Private typedef -----------------------------------------------------------*/
/* USER CODE BEGIN PTD */

/* USER CODE END PTD */

/* Private define ------------------------------------------------------------*/
/* USER CODE BEGIN PD */
/* USER CODE END PD */

/* Private macro -------------------------------------------------------------*/
/* USER CODE BEGIN PM */
#define ITM_Port32(n) (*((volatile unsigned long *)(0xE0000000+4*n)))
/* USER CODE END PM */

/* Private variables ---------------------------------------------------------*/
 ADC_HandleTypeDef hadc1;
ADC_HandleTypeDef hadc2;

TIM_HandleTypeDef htim3;
TIM_HandleTypeDef htim4;
TIM_HandleTypeDef htim5;
TIM_HandleTypeDef htim9;

UART_HandleTypeDef huart3;

/* USER CODE BEGIN PV */


///////////////////////motor_fxn///////////////////
int P_wm_m1=0;
int P_wm_m2=0;
////////th///////////////////
volatile float raw_enc1=0;
volatile float raw_enc2=0;


volatile float prev_enc1=32767;
volatile float prev_enc2=32767;

volatile float real_enc1=0;
volatile float real_enc2=0;

float eth1=0;
float eth2=0;
float th1=0;
float th2=0;

float spth1=1.57;
float spth2=0;


float DE_rrorm1=0;
float prev_th1=0;
float vel_DError_d1=0;

float DE_rrorm2=0;
float prev_th2=0;
float vel_DError_d2=0;
/////////th dot//////////////////
/////////////////////////time_var/////////////////////
double prev_time=0;
double now_time=0;
float D_t=1E-6;
double timeblock=65535;
double last_hlc_execute_time = 0.0;

////////////////////kalman_dot1////////////
//Kalman Variable3
volatile float measurement3=0;
volatile float estimate3=0;
volatile float measurement_variance3=0.5;
volatile float estimate_variance3=0.3;
volatile float estimate_measurement_weight3=0.001;
volatile float kalman_gain3;
volatile float old_estimate3;

////////////////////kalman_dot2////////////
//Kalman Variable4
volatile float measurement4=0;
volatile float estimate4=0;
volatile float measurement_variance4=0.5;
volatile float estimate_variance4=0.3;
volatile float estimate_measurement_weight4=0.001;
volatile float kalman_gain4;
volatile float old_estimate4;



///////////////////////motor_fxn///////////////////
///////////////////////array_var///////////////////
float data=0;
int arr_indx=0;
///////////////////////array_var///////////////////
////////////////////////current_var////////////////////
//acs var
 uint16_t raw;
 float current=0;
 float volt=0;
 float inivolt=0;

 //Kalman Variable
 volatile float measurement=0;
 volatile float estimate=0;
 volatile float measurement_variance=0.5;
 volatile float estimate_variance=0.3;
 volatile float estimate_measurement_weight=0.001;
 volatile float kalman_gain;
 volatile float old_estimate;

 //loop var
 float E_rror_m1=0;
 float D_current = 0;
 float kp =1500;

 //acs var2
 uint16_t raw2;
 float current2=0;
 float volt2=0;
 float inivolt2=0;

 //Kalman Variable2
 volatile float measurement2=0;
 volatile float estimate2=0;
 volatile float measurement_variance2=0.5;
 volatile float estimate_variance2=0.3;
 volatile float estimate_measurement_weight2=0.001;
 volatile float kalman_gain2;
 volatile float old_estimate2;

 //loop var2
 float E_rror_m2=0;
 float D_current2 = 0;
 float kp2 =1500;
 ////////////////////////current_var////////////////////


 /////////////////////////trac_ implementation/////////////////////////
/* Linear Trajectory */
//float thd1_trac[500]={1.57080e+00,1.60505e+00,1.61840e+00,1.62829e+00,1.63640e+00,1.64336e+00,1.64950e+00,1.65502e+00,1.66005e+00,1.66468e+00,1.66896e+00,1.67295e+00,1.67669e+00,1.68021e+00,1.68353e+00,1.68668e+00,1.68966e+00,1.69250e+00,1.69520e+00,1.69778e+00,1.70025e+00,1.70261e+00,1.70487e+00,1.70704e+00,1.70912e+00,1.71112e+00,1.71304e+00,1.71489e+00,1.71667e+00,1.71838e+00,1.72003e+00,1.72163e+00,1.72316e+00,1.72464e+00,1.72607e+00,1.72744e+00,1.72877e+00,1.73005e+00,1.73129e+00,1.73248e+00,1.73363e+00,1.73474e+00,1.73581e+00,1.73684e+00,1.73784e+00,1.73880e+00,1.73973e+00,1.74062e+00,1.74148e+00,1.74230e+00,1.74310e+00,1.74387e+00,1.74460e+00,1.74531e+00,1.74599e+00,1.74664e+00,1.74727e+00,1.74787e+00,1.74844e+00,1.74899e+00,1.74951e+00,1.75001e+00,1.75049e+00,1.75094e+00,1.75137e+00,1.75178e+00,1.75217e+00,1.75253e+00,1.75287e+00,1.75320e+00,1.75350e+00,1.75378e+00,1.75405e+00,1.75429e+00,1.75451e+00,1.75472e+00,1.75491e+00,1.75508e+00,1.75523e+00,1.75536e+00,1.75548e+00,1.75558e+00,1.75566e+00,1.75573e+00,1.75578e+00,1.75581e+00,1.75583e+00,1.75583e+00,1.75581e+00,1.75578e+00,1.75574e+00,1.75568e+00,1.75560e+00,1.75551e+00,1.75541e+00,1.75529e+00,1.75516e+00,1.75501e+00,1.75485e+00,1.75468e+00,1.75449e+00,1.75429e+00,1.75407e+00,1.75385e+00,1.75360e+00,1.75335e+00,1.75308e+00,1.75281e+00,1.75251e+00,1.75221e+00,1.75189e+00,1.75156e+00,1.75122e+00,1.75087e+00,1.75051e+00,1.75013e+00,1.74974e+00,1.74934e+00,1.74893e+00,1.74851e+00,1.74808e+00,1.74763e+00,1.74717e+00,1.74671e+00,1.74623e+00,1.74574e+00,1.74524e+00,1.74473e+00,1.74421e+00,1.74368e+00,1.74313e+00,1.74258e+00,1.74202e+00,1.74145e+00,1.74086e+00,1.74027e+00,1.73967e+00,1.73905e+00,1.73843e+00,1.73780e+00,1.73715e+00,1.73650e+00,1.73584e+00,1.73517e+00,1.73448e+00,1.73379e+00,1.73309e+00,1.73238e+00,1.73166e+00,1.73094e+00,1.73020e+00,1.72945e+00,1.72869e+00,1.72793e+00,1.72716e+00,1.72637e+00,1.72558e+00,1.72478e+00,1.72397e+00,1.72315e+00,1.72233e+00,1.72149e+00,1.72065e+00,1.71979e+00,1.71893e+00,1.71806e+00,1.71718e+00,1.71630e+00,1.71540e+00,1.71450e+00,1.71359e+00,1.71267e+00,1.71174e+00,1.71080e+00,1.70986e+00,1.70890e+00,1.70794e+00,1.70697e+00,1.70600e+00,1.70501e+00,1.70402e+00,1.70302e+00,1.70201e+00,1.70099e+00,1.69997e+00,1.69894e+00,1.69790e+00,1.69685e+00,1.69580e+00,1.69473e+00,1.69366e+00,1.69259e+00,1.69150e+00,1.69041e+00,1.68931e+00,1.68820e+00,1.68708e+00,1.68596e+00,1.68483e+00,1.68369e+00,1.68255e+00,1.68140e+00,1.68024e+00,1.67907e+00,1.67790e+00,1.67672e+00,1.67553e+00,1.67433e+00,1.67313e+00,1.67192e+00,1.67070e+00,1.66948e+00,1.66825e+00,1.66701e+00,1.66577e+00,1.66452e+00,1.66326e+00,1.66199e+00,1.66072e+00,1.65944e+00,1.65815e+00,1.65686e+00,1.65556e+00,1.65425e+00,1.65294e+00,1.65162e+00,1.65029e+00,1.64896e+00,1.64762e+00,1.64627e+00,1.64492e+00,1.64356e+00,1.64219e+00,1.64082e+00,1.63944e+00,1.63805e+00,1.63666e+00,1.63526e+00,1.63385e+00,1.63244e+00,1.63102e+00,1.62960e+00,1.62817e+00,1.62673e+00,1.62528e+00,1.62383e+00,1.62237e+00,1.62091e+00,1.61944e+00,1.61796e+00,1.61648e+00,1.61499e+00,1.61350e+00,1.61199e+00,1.61049e+00,1.60897e+00,1.60745e+00,1.60592e+00,1.60439e+00,1.60285e+00,1.60131e+00,1.59975e+00,1.59820e+00,1.59663e+00,1.59506e+00,1.59349e+00,1.59190e+00,1.59032e+00,1.58872e+00,1.58712e+00,1.58551e+00,1.58390e+00,1.58228e+00,1.58066e+00,1.57903e+00,1.57739e+00,1.57575e+00,1.57410e+00,1.57245e+00,1.57078e+00,1.56912e+00,1.56745e+00,1.56577e+00,1.56408e+00,1.56239e+00,1.56070e+00,1.55899e+00,1.55729e+00,1.55557e+00,1.55385e+00,1.55213e+00,1.55039e+00,1.54866e+00,1.54691e+00,1.54516e+00,1.54341e+00,1.54165e+00,1.53988e+00,1.53811e+00,1.53633e+00,1.53455e+00,1.53276e+00,1.53096e+00,1.52916e+00,1.52735e+00,1.52554e+00,1.52372e+00,1.52190e+00,1.52006e+00,1.51823e+00,1.51639e+00,1.51454e+00,1.51268e+00,1.51083e+00,1.50896e+00,1.50709e+00,1.50521e+00,1.50333e+00,1.50144e+00,1.49955e+00,1.49765e+00,1.49574e+00,1.49383e+00,1.49192e+00,1.48999e+00,1.48806e+00,1.48613e+00,1.48419e+00,1.48224e+00,1.48029e+00,1.47834e+00,1.47637e+00,1.47441e+00,1.47243e+00,1.47045e+00,1.46846e+00,1.46647e+00,1.46448e+00,1.46247e+00,1.46046e+00,1.45845e+00,1.45643e+00,1.45440e+00,1.45237e+00,1.45033e+00,1.44829e+00,1.44624e+00,1.44419e+00,1.44212e+00,1.44006e+00,1.43798e+00,1.43591e+00,1.43382e+00,1.43173e+00,1.42964e+00,1.42753e+00,1.42543e+00,1.42331e+00,1.42119e+00,1.41907e+00,1.41694e+00,1.41480e+00,1.41266e+00,1.41051e+00,1.40835e+00,1.40619e+00,1.40403e+00,1.40185e+00,1.39967e+00,1.39749e+00,1.39530e+00,1.39310e+00,1.39090e+00,1.38869e+00,1.38647e+00,1.38425e+00,1.38203e+00,1.37979e+00,1.37755e+00,1.37531e+00,1.37305e+00,1.37080e+00,1.36853e+00,1.36626e+00,1.36398e+00,1.36170e+00,1.35941e+00,1.35712e+00,1.35481e+00,1.35250e+00,1.35019e+00,1.34787e+00,1.34554e+00,1.34321e+00,1.34087e+00,1.33852e+00,1.33616e+00,1.33380e+00,1.33144e+00,1.32906e+00,1.32668e+00,1.32429e+00,1.32190e+00,1.31950e+00,1.31709e+00,1.31468e+00,1.31226e+00,1.30983e+00,1.30739e+00,1.30495e+00,1.30250e+00,1.30005e+00,1.29758e+00,1.29511e+00,1.29264e+00,1.29015e+00,1.28766e+00,1.28516e+00,1.28265e+00,1.28014e+00,1.27762e+00,1.27509e+00,1.27255e+00,1.27001e+00,1.26745e+00,1.26489e+00,1.26233e+00,1.25975e+00,1.25717e+00,1.25458e+00,1.25198e+00,1.24937e+00,1.24675e+00,1.24413e+00,1.24150e+00,1.23886e+00,1.23621e+00,1.23355e+00,1.23088e+00,1.22821e+00,1.22553e+00,1.22283e+00,1.22013e+00,1.21742e+00,1.21470e+00,1.21198e+00,1.20924e+00,1.20649e+00,1.20373e+00,1.20097e+00,1.19819e+00,1.19541e+00,1.19261e+00,1.18981e+00,1.18699e+00,1.18417e+00,1.18133e+00,1.17849e+00,1.17563e+00,1.17276e+00,1.16989e+00,1.16700e+00,1.16410e+00,1.16119e+00,1.15826e+00,1.15533e+00,1.15238e+00,1.14943e+00,1.14646e+00,1.14347e+00,1.14048e+00,1.13747e+00,1.13445e+00,1.13142e+00,1.12838e+00,1.12532e+00,1.12225e+00,1.11916e+00,1.11606e+00,1.11295e+00,1.10982e+00,1.10668e+00,1.10352e+00,1.10035e+00,1.09716e+00,1.09395e+00,1.09073e+00,1.08750e+00,1.08425e+00,1.08098e+00,1.07769e+00,1.07438e+00,1.07106e+00,1.06772e+00,1.06436e+00,1.06098e+00,1.05758e+00,1.05417e+00,1.05073e+00,1.04727e+00};
//float thd2_trac[500]={-0.00000e+00,-7.12405e-02,-1.00680e-01,-1.23222e-01,-1.42186e-01,-1.58859e-01,-1.73900e-01,-1.87702e-01,-2.00522e-01,-2.12536e-01,-2.23875e-01,-2.34636e-01,-2.44895e-01,-2.54713e-01,-2.64140e-01,-2.73215e-01,-2.81972e-01,-2.90441e-01,-2.98645e-01,-3.06606e-01,-3.14342e-01,-3.21870e-01,-3.29203e-01,-3.36354e-01,-3.43335e-01,-3.50156e-01,-3.56826e-01,-3.63352e-01,-3.69744e-01,-3.76006e-01,-3.82147e-01,-3.88171e-01,-3.94084e-01,-3.99891e-01,-4.05595e-01,-4.11203e-01,-4.16716e-01,-4.22140e-01,-4.27476e-01,-4.32730e-01,-4.37902e-01,-4.42997e-01,-4.48017e-01,-4.52964e-01,-4.57841e-01,-4.62649e-01,-4.67392e-01,-4.72070e-01,-4.76686e-01,-4.81241e-01,-4.85737e-01,-4.90176e-01,-4.94560e-01,-4.98889e-01,-5.03164e-01,-5.07389e-01,-5.11562e-01,-5.15687e-01,-5.19763e-01,-5.23792e-01,-5.27775e-01,-5.31714e-01,-5.35608e-01,-5.39459e-01,-5.43268e-01,-5.47035e-01,-5.50762e-01,-5.54449e-01,-5.58097e-01,-5.61707e-01,-5.65279e-01,-5.68815e-01,-5.72314e-01,-5.75777e-01,-5.79206e-01,-5.82600e-01,-5.85960e-01,-5.89286e-01,-5.92580e-01,-5.95842e-01,-5.99072e-01,-6.02271e-01,-6.05439e-01,-6.08576e-01,-6.11684e-01,-6.14762e-01,-6.17811e-01,-6.20831e-01,-6.23823e-01,-6.26787e-01,-6.29724e-01,-6.32633e-01,-6.35516e-01,-6.38372e-01,-6.41202e-01,-6.44006e-01,-6.46784e-01,-6.49537e-01,-6.52265e-01,-6.54969e-01,-6.57648e-01,-6.60303e-01,-6.62934e-01,-6.65542e-01,-6.68126e-01,-6.70688e-01,-6.73226e-01,-6.75742e-01,-6.78235e-01,-6.80706e-01,-6.83156e-01,-6.85583e-01,-6.87989e-01,-6.90374e-01,-6.92737e-01,-6.95080e-01,-6.97402e-01,-6.99703e-01,-7.01984e-01,-7.04245e-01,-7.06486e-01,-7.08706e-01,-7.10907e-01,-7.13089e-01,-7.15251e-01,-7.17394e-01,-7.19518e-01,-7.21623e-01,-7.23709e-01,-7.25777e-01,-7.27826e-01,-7.29857e-01,-7.31869e-01,-7.33864e-01,-7.35840e-01,-7.37799e-01,-7.39740e-01,-7.41663e-01,-7.43569e-01,-7.45457e-01,-7.47328e-01,-7.49182e-01,-7.51019e-01,-7.52839e-01,-7.54643e-01,-7.56429e-01,-7.58199e-01,-7.59952e-01,-7.61689e-01,-7.63410e-01,-7.65114e-01,-7.66803e-01,-7.68475e-01,-7.70131e-01,-7.71771e-01,-7.73396e-01,-7.75005e-01,-7.76598e-01,-7.78175e-01,-7.79737e-01,-7.81284e-01,-7.82816e-01,-7.84332e-01,-7.85833e-01,-7.87319e-01,-7.88789e-01,-7.90245e-01,-7.91686e-01,-7.93113e-01,-7.94524e-01,-7.95921e-01,-7.97303e-01,-7.98670e-01,-8.00023e-01,-8.01362e-01,-8.02686e-01,-8.03996e-01,-8.05291e-01,-8.06572e-01,-8.07839e-01,-8.09092e-01,-8.10331e-01,-8.11556e-01,-8.12767e-01,-8.13964e-01,-8.15147e-01,-8.16317e-01,-8.17472e-01,-8.18614e-01,-8.19742e-01,-8.20857e-01,-8.21958e-01,-8.23045e-01,-8.24119e-01,-8.25179e-01,-8.26226e-01,-8.27260e-01,-8.28280e-01,-8.29287e-01,-8.30281e-01,-8.31261e-01,-8.32229e-01,-8.33183e-01,-8.34124e-01,-8.35052e-01,-8.35966e-01,-8.36868e-01,-8.37757e-01,-8.38633e-01,-8.39496e-01,-8.40346e-01,-8.41183e-01,-8.42008e-01,-8.42819e-01,-8.43618e-01,-8.44404e-01,-8.45177e-01,-8.45938e-01,-8.46686e-01,-8.47421e-01,-8.48144e-01,-8.48854e-01,-8.49551e-01,-8.50236e-01,-8.50909e-01,-8.51569e-01,-8.52216e-01,-8.52851e-01,-8.53474e-01,-8.54084e-01,-8.54681e-01,-8.55267e-01,-8.55840e-01,-8.56400e-01,-8.56949e-01,-8.57485e-01,-8.58009e-01,-8.58520e-01,-8.59019e-01,-8.59506e-01,-8.59981e-01,-8.60443e-01,-8.60894e-01,-8.61332e-01,-8.61758e-01,-8.62172e-01,-8.62574e-01,-8.62963e-01,-8.63341e-01,-8.63706e-01,-8.64059e-01,-8.64400e-01,-8.64730e-01,-8.65047e-01,-8.65352e-01,-8.65645e-01,-8.65926e-01,-8.66195e-01,-8.66451e-01,-8.66696e-01,-8.66929e-01,-8.67150e-01,-8.67359e-01,-8.67556e-01,-8.67741e-01,-8.67914e-01,-8.68075e-01,-8.68224e-01,-8.68361e-01,-8.68487e-01,-8.68600e-01,-8.68701e-01,-8.68791e-01,-8.68868e-01,-8.68934e-01,-8.68987e-01,-8.69029e-01,-8.69059e-01,-8.69076e-01,-8.69082e-01,-8.69076e-01,-8.69058e-01,-8.69028e-01,-8.68987e-01,-8.68933e-01,-8.68867e-01,-8.68790e-01,-8.68700e-01,-8.68598e-01,-8.68485e-01,-8.68360e-01,-8.68222e-01,-8.68073e-01,-8.67912e-01,-8.67739e-01,-8.67554e-01,-8.67356e-01,-8.67147e-01,-8.66926e-01,-8.66693e-01,-8.66448e-01,-8.66191e-01,-8.65922e-01,-8.65641e-01,-8.65348e-01,-8.65042e-01,-8.64725e-01,-8.64396e-01,-8.64055e-01,-8.63701e-01,-8.63336e-01,-8.62958e-01,-8.62568e-01,-8.62166e-01,-8.61752e-01,-8.61326e-01,-8.60888e-01,-8.60437e-01,-8.59975e-01,-8.59500e-01,-8.59012e-01,-8.58513e-01,-8.58001e-01,-8.57478e-01,-8.56941e-01,-8.56393e-01,-8.55832e-01,-8.55259e-01,-8.54673e-01,-8.54075e-01,-8.53465e-01,-8.52842e-01,-8.52207e-01,-8.51560e-01,-8.50900e-01,-8.50227e-01,-8.49542e-01,-8.48844e-01,-8.48134e-01,-8.47411e-01,-8.46676e-01,-8.45928e-01,-8.45167e-01,-8.44393e-01,-8.43607e-01,-8.42808e-01,-8.41996e-01,-8.41172e-01,-8.40335e-01,-8.39484e-01,-8.38621e-01,-8.37745e-01,-8.36856e-01,-8.35954e-01,-8.35039e-01,-8.34111e-01,-8.33170e-01,-8.32216e-01,-8.31248e-01,-8.30267e-01,-8.29274e-01,-8.28266e-01,-8.27246e-01,-8.26212e-01,-8.25165e-01,-8.24104e-01,-8.23030e-01,-8.21943e-01,-8.20842e-01,-8.19727e-01,-8.18599e-01,-8.17457e-01,-8.16301e-01,-8.15131e-01,-8.13948e-01,-8.12751e-01,-8.11540e-01,-8.10315e-01,-8.09075e-01,-8.07822e-01,-8.06555e-01,-8.05273e-01,-8.03978e-01,-8.02668e-01,-8.01344e-01,-8.00005e-01,-7.98652e-01,-7.97284e-01,-7.95902e-01,-7.94505e-01,-7.93093e-01,-7.91667e-01,-7.90226e-01,-7.88770e-01,-7.87298e-01,-7.85812e-01,-7.84311e-01,-7.82795e-01,-7.81263e-01,-7.79716e-01,-7.78154e-01,-7.76576e-01,-7.74983e-01,-7.73374e-01,-7.71749e-01,-7.70108e-01,-7.68452e-01,-7.66780e-01,-7.65091e-01,-7.63387e-01,-7.61666e-01,-7.59929e-01,-7.58175e-01,-7.56405e-01,-7.54618e-01,-7.52815e-01,-7.50994e-01,-7.49157e-01,-7.47303e-01,-7.45432e-01,-7.43543e-01,-7.41637e-01,-7.39713e-01,-7.37772e-01,-7.35813e-01,-7.33837e-01,-7.31842e-01,-7.29829e-01,-7.27798e-01,-7.25749e-01,-7.23681e-01,-7.21595e-01,-7.19489e-01,-7.17365e-01,-7.15222e-01,-7.13059e-01,-7.10878e-01,-7.08676e-01,-7.06455e-01,-7.04214e-01,-7.01953e-01,-6.99672e-01,-6.97370e-01,-6.95048e-01,-6.92705e-01,-6.90341e-01,-6.87956e-01,-6.85550e-01,-6.83122e-01,-6.80673e-01,-6.78201e-01,-6.75708e-01,-6.73192e-01,-6.70653e-01,-6.68091e-01,-6.65507e-01,-6.62899e-01,-6.60267e-01,-6.57612e-01,-6.54932e-01,-6.52228e-01,-6.49500e-01,-6.46746e-01,-6.43968e-01,-6.41163e-01,-6.38333e-01,-6.35477e-01,-6.32594e-01,-6.29684e-01,-6.26747e-01,-6.23783e-01,-6.20790e-01,-6.17770e-01,-6.14720e-01,-6.11642e-01,-6.08534e-01,-6.05396e-01,-6.02227e-01,-5.99028e-01,-5.95798e-01,-5.92536e-01,-5.89241e-01,-5.85914e-01,-5.82554e-01,-5.79159e-01,-5.75730e-01,-5.72266e-01,-5.68767e-01,-5.65231e-01,-5.61658e-01,-5.58048e-01,-5.54399e-01,-5.50712e-01,-5.46984e-01,-5.43216e-01,-5.39407e-01,-5.35555e-01,-5.31660e-01,-5.27721e-01,-5.23738e-01};
//float trac_tvect[500]={0.00000e+00,2.00401e-03,4.00802e-03,6.01202e-03,8.01603e-03,1.00200e-02,1.20240e-02,1.40281e-02,1.60321e-02,1.80361e-02,2.00401e-02,2.20441e-02,2.40481e-02,2.60521e-02,2.80561e-02,3.00601e-02,3.20641e-02,3.40681e-02,3.60721e-02,3.80762e-02,4.00802e-02,4.20842e-02,4.40882e-02,4.60922e-02,4.80962e-02,5.01002e-02,5.21042e-02,5.41082e-02,5.61122e-02,5.81162e-02,6.01202e-02,6.21242e-02,6.41283e-02,6.61323e-02,6.81363e-02,7.01403e-02,7.21443e-02,7.41483e-02,7.61523e-02,7.81563e-02,8.01603e-02,8.21643e-02,8.41683e-02,8.61723e-02,8.81764e-02,9.01804e-02,9.21844e-02,9.41884e-02,9.61924e-02,9.81964e-02,1.00200e-01,1.02204e-01,1.04208e-01,1.06212e-01,1.08216e-01,1.10220e-01,1.12224e-01,1.14228e-01,1.16232e-01,1.18236e-01,1.20240e-01,1.22244e-01,1.24248e-01,1.26253e-01,1.28257e-01,1.30261e-01,1.32265e-01,1.34269e-01,1.36273e-01,1.38277e-01,1.40281e-01,1.42285e-01,1.44289e-01,1.46293e-01,1.48297e-01,1.50301e-01,1.52305e-01,1.54309e-01,1.56313e-01,1.58317e-01,1.60321e-01,1.62325e-01,1.64329e-01,1.66333e-01,1.68337e-01,1.70341e-01,1.72345e-01,1.74349e-01,1.76353e-01,1.78357e-01,1.80361e-01,1.82365e-01,1.84369e-01,1.86373e-01,1.88377e-01,1.90381e-01,1.92385e-01,1.94389e-01,1.96393e-01,1.98397e-01,2.00401e-01,2.02405e-01,2.04409e-01,2.06413e-01,2.08417e-01,2.10421e-01,2.12425e-01,2.14429e-01,2.16433e-01,2.18437e-01,2.20441e-01,2.22445e-01,2.24449e-01,2.26453e-01,2.28457e-01,2.30461e-01,2.32465e-01,2.34469e-01,2.36473e-01,2.38477e-01,2.40481e-01,2.42485e-01,2.44489e-01,2.46493e-01,2.48497e-01,2.50501e-01,2.52505e-01,2.54509e-01,2.56513e-01,2.58517e-01,2.60521e-01,2.62525e-01,2.64529e-01,2.66533e-01,2.68537e-01,2.70541e-01,2.72545e-01,2.74549e-01,2.76553e-01,2.78557e-01,2.80561e-01,2.82565e-01,2.84569e-01,2.86573e-01,2.88577e-01,2.90581e-01,2.92585e-01,2.94589e-01,2.96593e-01,2.98597e-01,3.00601e-01,3.02605e-01,3.04609e-01,3.06613e-01,3.08617e-01,3.10621e-01,3.12625e-01,3.14629e-01,3.16633e-01,3.18637e-01,3.20641e-01,3.22645e-01,3.24649e-01,3.26653e-01,3.28657e-01,3.30661e-01,3.32665e-01,3.34669e-01,3.36673e-01,3.38677e-01,3.40681e-01,3.42685e-01,3.44689e-01,3.46693e-01,3.48697e-01,3.50701e-01,3.52705e-01,3.54709e-01,3.56713e-01,3.58717e-01,3.60721e-01,3.62725e-01,3.64729e-01,3.66733e-01,3.68737e-01,3.70741e-01,3.72745e-01,3.74749e-01,3.76754e-01,3.78758e-01,3.80762e-01,3.82766e-01,3.84770e-01,3.86774e-01,3.88778e-01,3.90782e-01,3.92786e-01,3.94790e-01,3.96794e-01,3.98798e-01,4.00802e-01,4.02806e-01,4.04810e-01,4.06814e-01,4.08818e-01,4.10822e-01,4.12826e-01,4.14830e-01,4.16834e-01,4.18838e-01,4.20842e-01,4.22846e-01,4.24850e-01,4.26854e-01,4.28858e-01,4.30862e-01,4.32866e-01,4.34870e-01,4.36874e-01,4.38878e-01,4.40882e-01,4.42886e-01,4.44890e-01,4.46894e-01,4.48898e-01,4.50902e-01,4.52906e-01,4.54910e-01,4.56914e-01,4.58918e-01,4.60922e-01,4.62926e-01,4.64930e-01,4.66934e-01,4.68938e-01,4.70942e-01,4.72946e-01,4.74950e-01,4.76954e-01,4.78958e-01,4.80962e-01,4.82966e-01,4.84970e-01,4.86974e-01,4.88978e-01,4.90982e-01,4.92986e-01,4.94990e-01,4.96994e-01,4.98998e-01,5.01002e-01,5.03006e-01,5.05010e-01,5.07014e-01,5.09018e-01,5.11022e-01,5.13026e-01,5.15030e-01,5.17034e-01,5.19038e-01,5.21042e-01,5.23046e-01,5.25050e-01,5.27054e-01,5.29058e-01,5.31062e-01,5.33066e-01,5.35070e-01,5.37074e-01,5.39078e-01,5.41082e-01,5.43086e-01,5.45090e-01,5.47094e-01,5.49098e-01,5.51102e-01,5.53106e-01,5.55110e-01,5.57114e-01,5.59118e-01,5.61122e-01,5.63126e-01,5.65130e-01,5.67134e-01,5.69138e-01,5.71142e-01,5.73146e-01,5.75150e-01,5.77154e-01,5.79158e-01,5.81162e-01,5.83166e-01,5.85170e-01,5.87174e-01,5.89178e-01,5.91182e-01,5.93186e-01,5.95190e-01,5.97194e-01,5.99198e-01,6.01202e-01,6.03206e-01,6.05210e-01,6.07214e-01,6.09218e-01,6.11222e-01,6.13226e-01,6.15230e-01,6.17234e-01,6.19238e-01,6.21242e-01,6.23246e-01,6.25251e-01,6.27255e-01,6.29259e-01,6.31263e-01,6.33267e-01,6.35271e-01,6.37275e-01,6.39279e-01,6.41283e-01,6.43287e-01,6.45291e-01,6.47295e-01,6.49299e-01,6.51303e-01,6.53307e-01,6.55311e-01,6.57315e-01,6.59319e-01,6.61323e-01,6.63327e-01,6.65331e-01,6.67335e-01,6.69339e-01,6.71343e-01,6.73347e-01,6.75351e-01,6.77355e-01,6.79359e-01,6.81363e-01,6.83367e-01,6.85371e-01,6.87375e-01,6.89379e-01,6.91383e-01,6.93387e-01,6.95391e-01,6.97395e-01,6.99399e-01,7.01403e-01,7.03407e-01,7.05411e-01,7.07415e-01,7.09419e-01,7.11423e-01,7.13427e-01,7.15431e-01,7.17435e-01,7.19439e-01,7.21443e-01,7.23447e-01,7.25451e-01,7.27455e-01,7.29459e-01,7.31463e-01,7.33467e-01,7.35471e-01,7.37475e-01,7.39479e-01,7.41483e-01,7.43487e-01,7.45491e-01,7.47495e-01,7.49499e-01,7.51503e-01,7.53507e-01,7.55511e-01,7.57515e-01,7.59519e-01,7.61523e-01,7.63527e-01,7.65531e-01,7.67535e-01,7.69539e-01,7.71543e-01,7.73547e-01,7.75551e-01,7.77555e-01,7.79559e-01,7.81563e-01,7.83567e-01,7.85571e-01,7.87575e-01,7.89579e-01,7.91583e-01,7.93587e-01,7.95591e-01,7.97595e-01,7.99599e-01,8.01603e-01,8.03607e-01,8.05611e-01,8.07615e-01,8.09619e-01,8.11623e-01,8.13627e-01,8.15631e-01,8.17635e-01,8.19639e-01,8.21643e-01,8.23647e-01,8.25651e-01,8.27655e-01,8.29659e-01,8.31663e-01,8.33667e-01,8.35671e-01,8.37675e-01,8.39679e-01,8.41683e-01,8.43687e-01,8.45691e-01,8.47695e-01,8.49699e-01,8.51703e-01,8.53707e-01,8.55711e-01,8.57715e-01,8.59719e-01,8.61723e-01,8.63727e-01,8.65731e-01,8.67735e-01,8.69739e-01,8.71743e-01,8.73747e-01,8.75752e-01,8.77756e-01,8.79760e-01,8.81764e-01,8.83768e-01,8.85772e-01,8.87776e-01,8.89780e-01,8.91784e-01,8.93788e-01,8.95792e-01,8.97796e-01,8.99800e-01,9.01804e-01,9.03808e-01,9.05812e-01,9.07816e-01,9.09820e-01,9.11824e-01,9.13828e-01,9.15832e-01,9.17836e-01,9.19840e-01,9.21844e-01,9.23848e-01,9.25852e-01,9.27856e-01,9.29860e-01,9.31864e-01,9.33868e-01,9.35872e-01,9.37876e-01,9.39880e-01,9.41884e-01,9.43888e-01,9.45892e-01,9.47896e-01,9.49900e-01,9.51904e-01,9.53908e-01,9.55912e-01,9.57916e-01,9.59920e-01,9.61924e-01,9.63928e-01,9.65932e-01,9.67936e-01,9.69940e-01,9.71944e-01,9.73948e-01,9.75952e-01,9.77956e-01,9.79960e-01,9.81964e-01,9.83968e-01,9.85972e-01,9.87976e-01,9.89980e-01,9.91984e-01,9.93988e-01,9.95992e-01,9.97996e-01,1.00000e+00};
//Linear force track
float thd1_trac[500] = {1.57080e+00,1.64051e+00,1.66888e+00,1.69045e+00,1.70851e+00,1.72431e+00,1.73851e+00,1.75150e+00,1.76353e+00,1.77477e+00,1.78536e+00,1.79538e+00,1.80492e+00,1.81402e+00,1.82275e+00,1.83114e+00,1.83922e+00,1.84702e+00,1.85456e+00,1.86187e+00,1.86897e+00,1.87586e+00,1.88256e+00,1.88909e+00,1.89546e+00,1.90167e+00,1.90774e+00,1.91367e+00,1.91947e+00,1.92515e+00,1.93071e+00,1.93615e+00,1.94150e+00,1.94674e+00,1.95188e+00,1.95692e+00,1.96188e+00,1.96675e+00,1.97154e+00,1.97625e+00,1.98088e+00,1.98544e+00,1.98992e+00,1.99433e+00,1.99868e+00,2.00296e+00,2.00718e+00,2.01133e+00,2.01543e+00,2.01946e+00,2.02344e+00,2.02736e+00,2.03123e+00,2.03505e+00,2.03881e+00,2.04252e+00,2.04619e+00,2.04981e+00,2.05337e+00,2.05690e+00,2.06038e+00,2.06381e+00,2.06720e+00,2.07055e+00,2.07385e+00,2.07712e+00,2.08034e+00,2.08352e+00,2.08667e+00,2.08978e+00,2.09284e+00,2.09588e+00,2.09887e+00,2.10183e+00,2.10475e+00,2.10764e+00,2.11049e+00,2.11331e+00,2.11610e+00,2.11885e+00,2.12157e+00,2.12426e+00,2.12691e+00,2.12953e+00,2.13212e+00,2.13468e+00,2.13721e+00,2.13971e+00,2.14218e+00,2.14462e+00,2.14703e+00,2.14941e+00,2.15176e+00,2.15408e+00,2.15637e+00,2.15863e+00,2.16087e+00,2.16307e+00,2.16525e+00,2.16741e+00,2.16953e+00,2.17163e+00,2.17370e+00,2.17574e+00,2.17775e+00,2.17974e+00,2.18171e+00,2.18364e+00,2.18555e+00,2.18743e+00,2.18929e+00,2.19112e+00,2.19293e+00,2.19470e+00,2.19646e+00,2.19818e+00,2.19989e+00,2.20156e+00,2.20321e+00,2.20484e+00,2.20644e+00,2.20801e+00,2.20956e+00,2.21108e+00,2.21258e+00,2.21406e+00,2.21550e+00,2.21693e+00,2.21832e+00,2.21970e+00,2.22104e+00,2.22236e+00,2.22366e+00,2.22493e+00,2.22618e+00,2.22740e+00,2.22860e+00,2.22977e+00,2.23091e+00,2.23203e+00,2.23313e+00,2.23420e+00,2.23524e+00,2.23626e+00,2.23725e+00,2.23822e+00,2.23916e+00,2.24008e+00,2.24097e+00,2.24184e+00,2.24268e+00,2.24349e+00,2.24428e+00,2.24504e+00,2.24577e+00,2.24648e+00,2.24716e+00,2.24782e+00,2.24845e+00,2.24905e+00,2.24963e+00,2.25018e+00,2.25070e+00,2.25120e+00,2.25167e+00,2.25211e+00,2.25252e+00,2.25291e+00,2.25327e+00,2.25360e+00,2.25390e+00,2.25417e+00,2.25442e+00,2.25464e+00,2.25483e+00,2.25499e+00,2.25512e+00,2.25523e+00,2.25530e+00,2.25535e+00,2.25536e+00,2.25535e+00,2.25530e+00,2.25523e+00,2.25513e+00,2.25499e+00,2.25483e+00,2.25463e+00,2.25441e+00,2.25415e+00,2.25386e+00,2.25354e+00,2.25319e+00,2.25281e+00,2.25239e+00,2.25195e+00,2.25147e+00,2.25095e+00,2.25041e+00,2.24983e+00,2.24922e+00,2.24857e+00,2.24789e+00,2.24718e+00,2.24643e+00,2.24565e+00,2.24483e+00,2.24397e+00,2.24309e+00,2.24216e+00,2.24120e+00,2.24021e+00,2.23918e+00,2.23811e+00,2.23700e+00,2.23586e+00,2.23468e+00,2.23346e+00,2.23221e+00,2.23091e+00,2.22958e+00,2.22821e+00,2.22680e+00,2.22535e+00,2.22386e+00,2.22233e+00,2.22076e+00,2.21915e+00,2.21750e+00,2.21580e+00,2.21407e+00,2.21229e+00,2.21048e+00,2.20861e+00,2.20671e+00,2.20476e+00,2.20277e+00,2.20074e+00,2.19866e+00,2.19654e+00,2.19437e+00,2.19216e+00,2.18991e+00,2.18760e+00,2.18525e+00,2.18286e+00,2.18042e+00,2.17793e+00,2.17539e+00,2.17281e+00,2.17018e+00,2.16750e+00,2.16477e+00,2.16199e+00,2.15917e+00,2.15629e+00,2.15337e+00,2.15039e+00,2.14737e+00,2.14429e+00,2.14116e+00,2.13798e+00,2.13475e+00,2.13147e+00,2.12813e+00,2.12475e+00,2.12131e+00,2.11781e+00,2.11427e+00,2.11067e+00,2.10701e+00,2.10330e+00,2.09954e+00,2.09572e+00,2.09185e+00,2.08792e+00,2.08394e+00,2.07990e+00,2.07580e+00,2.07165e+00,2.06744e+00,2.06318e+00,2.05886e+00,2.05448e+00,2.05005e+00,2.04556e+00,2.04101e+00,2.03640e+00,2.03174e+00,2.02701e+00,2.02224e+00,2.01740e+00,2.01250e+00,2.00755e+00,2.00254e+00,1.99747e+00,1.99234e+00,1.98716e+00,1.98192e+00,1.97661e+00,1.97125e+00,1.96584e+00,1.96036e+00,1.95483e+00,1.94924e+00,1.94359e+00,1.93789e+00,1.93212e+00,1.92630e+00,1.92043e+00,1.91449e+00,1.90851e+00,1.90246e+00,1.89636e+00,1.89020e+00,1.88399e+00,1.87772e+00,1.87140e+00,1.86503e+00,1.85860e+00,1.85211e+00,1.84558e+00,1.83899e+00,1.83235e+00,1.82566e+00,1.81892e+00,1.81213e+00,1.80528e+00,1.79839e+00,1.79145e+00,1.78446e+00,1.77743e+00,1.77035e+00,1.76322e+00,1.75605e+00,1.74883e+00,1.74157e+00,1.73426e+00,1.72692e+00,1.71953e+00,1.71210e+00,1.70463e+00,1.69712e+00,1.68958e+00,1.68200e+00,1.67438e+00,1.66672e+00,1.65903e+00,1.65131e+00,1.64356e+00,1.63577e+00,1.62795e+00,1.62011e+00,1.61223e+00,1.60433e+00,1.59640e+00,1.58844e+00,1.58046e+00,1.57246e+00,1.56443e+00,1.55638e+00,1.54831e+00,1.54023e+00,1.53212e+00,1.52400e+00,1.51586e+00,1.50770e+00,1.49953e+00,1.49135e+00,1.48315e+00,1.47494e+00,1.46673e+00,1.45850e+00,1.45027e+00,1.44203e+00,1.43378e+00,1.42553e+00,1.41727e+00,1.40901e+00,1.40075e+00,1.39248e+00,1.38422e+00,1.37596e+00,1.36770e+00,1.35944e+00,1.35118e+00,1.34293e+00,1.33468e+00,1.32644e+00,1.31821e+00,1.30998e+00,1.30176e+00,1.29355e+00,1.28535e+00,1.27716e+00,1.26898e+00,1.26082e+00,1.25266e+00,1.24452e+00,1.23640e+00,1.22829e+00,1.22019e+00,1.21211e+00,1.20405e+00,1.19600e+00,1.18798e+00,1.17997e+00,1.17197e+00,1.16400e+00,1.15605e+00,1.14812e+00,1.14021e+00,1.13231e+00,1.12445e+00,1.11660e+00,1.10877e+00,1.10097e+00,1.09319e+00,1.08543e+00,1.07770e+00,1.06999e+00,1.06231e+00,1.05465e+00,1.04701e+00,1.03940e+00,1.03181e+00,1.02425e+00,1.01672e+00,1.00921e+00,1.00172e+00,9.94264e-01,9.86832e-01,9.79426e-01,9.72047e-01,9.64693e-01,9.57367e-01,9.50067e-01,9.42793e-01,9.35547e-01,9.28326e-01,9.21133e-01,9.13967e-01,9.06827e-01,8.99714e-01,8.92627e-01,8.85568e-01,8.78535e-01,8.71528e-01,8.64549e-01,8.57596e-01,8.50669e-01,8.43769e-01,8.36895e-01,8.30047e-01,8.23226e-01,8.16430e-01,8.09661e-01,8.02917e-01,7.96200e-01,7.89508e-01,7.82841e-01,7.76200e-01,7.69584e-01,7.62993e-01,7.56427e-01,7.49885e-01,7.43369e-01,7.36877e-01,7.30409e-01,7.23966e-01,7.17546e-01,7.11150e-01,7.04778e-01,6.98430e-01,6.92104e-01,6.85802e-01,6.79523e-01,6.73266e-01,6.67032e-01,6.60820e-01,6.54631e-01,6.48463e-01,6.42318e-01,6.36194e-01,6.30091e-01,6.24009e-01,6.17948e-01,6.11908e-01,6.05889e-01,5.99890e-01,5.93911e-01,5.87952e-01,5.82013e-01,5.76093e-01,5.70193e-01,5.64311e-01,5.58449e-01,5.52605e-01,5.46779e-01,5.40972e-01};
float thd2_trac[500] = {-0.00000e+00,-1.41156e-01,-1.99651e-01,-2.44554e-01,-2.82424e-01,-3.15801e-01,-3.45988e-01,-3.73758e-01,-3.99616e-01,-4.23912e-01,-4.46900e-01,-4.68774e-01,-4.89681e-01,-5.09742e-01,-5.29052e-01,-5.47691e-01,-5.65725e-01,-5.83210e-01,-6.00194e-01,-6.16719e-01,-6.32821e-01,-6.48530e-01,-6.63875e-01,-6.78880e-01,-6.93568e-01,-7.07958e-01,-7.22069e-01,-7.35915e-01,-7.49511e-01,-7.62872e-01,-7.76009e-01,-7.88933e-01,-8.01655e-01,-8.14183e-01,-8.26528e-01,-8.38696e-01,-8.50696e-01,-8.62533e-01,-8.74216e-01,-8.85750e-01,-8.97141e-01,-9.08393e-01,-9.19513e-01,-9.30505e-01,-9.41373e-01,-9.52122e-01,-9.62755e-01,-9.73276e-01,-9.83689e-01,-9.93997e-01,-1.00420e+00,-1.01431e+00,-1.02432e+00,-1.03424e+00,-1.04407e+00,-1.05381e+00,-1.06347e+00,-1.07304e+00,-1.08253e+00,-1.09195e+00,-1.10128e+00,-1.11054e+00,-1.11973e+00,-1.12885e+00,-1.13789e+00,-1.14687e+00,-1.15578e+00,-1.16463e+00,-1.17341e+00,-1.18213e+00,-1.19079e+00,-1.19939e+00,-1.20793e+00,-1.21641e+00,-1.22484e+00,-1.23321e+00,-1.24153e+00,-1.24980e+00,-1.25801e+00,-1.26618e+00,-1.27429e+00,-1.28235e+00,-1.29037e+00,-1.29834e+00,-1.30626e+00,-1.31414e+00,-1.32197e+00,-1.32975e+00,-1.33750e+00,-1.34520e+00,-1.35286e+00,-1.36048e+00,-1.36805e+00,-1.37559e+00,-1.38309e+00,-1.39054e+00,-1.39796e+00,-1.40535e+00,-1.41269e+00,-1.42000e+00,-1.42727e+00,-1.43451e+00,-1.44171e+00,-1.44888e+00,-1.45601e+00,-1.46311e+00,-1.47017e+00,-1.47720e+00,-1.48420e+00,-1.49117e+00,-1.49810e+00,-1.50501e+00,-1.51188e+00,-1.51872e+00,-1.52554e+00,-1.53232e+00,-1.53907e+00,-1.54579e+00,-1.55249e+00,-1.55915e+00,-1.56579e+00,-1.57240e+00,-1.57898e+00,-1.58554e+00,-1.59206e+00,-1.59856e+00,-1.60504e+00,-1.61148e+00,-1.61791e+00,-1.62430e+00,-1.63067e+00,-1.63701e+00,-1.64333e+00,-1.64963e+00,-1.65590e+00,-1.66214e+00,-1.66836e+00,-1.67456e+00,-1.68073e+00,-1.68688e+00,-1.69300e+00,-1.69910e+00,-1.70518e+00,-1.71123e+00,-1.71727e+00,-1.72328e+00,-1.72926e+00,-1.73523e+00,-1.74117e+00,-1.74709e+00,-1.75299e+00,-1.75886e+00,-1.76471e+00,-1.77055e+00,-1.77636e+00,-1.78215e+00,-1.78792e+00,-1.79366e+00,-1.79939e+00,-1.80509e+00,-1.81078e+00,-1.81644e+00,-1.82208e+00,-1.82771e+00,-1.83331e+00,-1.83889e+00,-1.84445e+00,-1.84999e+00,-1.85551e+00,-1.86101e+00,-1.86649e+00,-1.87195e+00,-1.87739e+00,-1.88281e+00,-1.88822e+00,-1.89360e+00,-1.89896e+00,-1.90430e+00,-1.90962e+00,-1.91493e+00,-1.92021e+00,-1.92547e+00,-1.93072e+00,-1.93594e+00,-1.94115e+00,-1.94633e+00,-1.95150e+00,-1.95665e+00,-1.96178e+00,-1.96689e+00,-1.97198e+00,-1.97705e+00,-1.98210e+00,-1.98713e+00,-1.99215e+00,-1.99714e+00,-2.00211e+00,-2.00707e+00,-2.01200e+00,-2.01692e+00,-2.02182e+00,-2.02670e+00,-2.03156e+00,-2.03639e+00,-2.04121e+00,-2.04602e+00,-2.05080e+00,-2.05556e+00,-2.06030e+00,-2.06502e+00,-2.06972e+00,-2.07441e+00,-2.07907e+00,-2.08372e+00,-2.08834e+00,-2.09294e+00,-2.09753e+00,-2.10209e+00,-2.10663e+00,-2.11116e+00,-2.11566e+00,-2.12015e+00,-2.12461e+00,-2.12905e+00,-2.13347e+00,-2.13787e+00,-2.14226e+00,-2.14662e+00,-2.15095e+00,-2.15527e+00,-2.15957e+00,-2.16385e+00,-2.16810e+00,-2.17233e+00,-2.17655e+00,-2.18074e+00,-2.18490e+00,-2.18905e+00,-2.19318e+00,-2.19728e+00,-2.20136e+00,-2.20542e+00,-2.20945e+00,-2.21347e+00,-2.21746e+00,-2.22142e+00,-2.22537e+00,-2.22929e+00,-2.23319e+00,-2.23706e+00,-2.24091e+00,-2.24474e+00,-2.24854e+00,-2.25232e+00,-2.25608e+00,-2.25981e+00,-2.26351e+00,-2.26719e+00,-2.27085e+00,-2.27448e+00,-2.27808e+00,-2.28166e+00,-2.28522e+00,-2.28874e+00,-2.29225e+00,-2.29572e+00,-2.29917e+00,-2.30259e+00,-2.30599e+00,-2.30936e+00,-2.31270e+00,-2.31601e+00,-2.31929e+00,-2.32255e+00,-2.32578e+00,-2.32898e+00,-2.33215e+00,-2.33530e+00,-2.33841e+00,-2.34150e+00,-2.34455e+00,-2.34758e+00,-2.35057e+00,-2.35353e+00,-2.35647e+00,-2.35937e+00,-2.36224e+00,-2.36509e+00,-2.36790e+00,-2.37067e+00,-2.37342e+00,-2.37613e+00,-2.37881e+00,-2.38146e+00,-2.38407e+00,-2.38666e+00,-2.38920e+00,-2.39172e+00,-2.39420e+00,-2.39664e+00,-2.39905e+00,-2.40143e+00,-2.40377e+00,-2.40608e+00,-2.40835e+00,-2.41058e+00,-2.41278e+00,-2.41494e+00,-2.41707e+00,-2.41915e+00,-2.42120e+00,-2.42322e+00,-2.42519e+00,-2.42713e+00,-2.42903e+00,-2.43089e+00,-2.43271e+00,-2.43450e+00,-2.43624e+00,-2.43794e+00,-2.43961e+00,-2.44123e+00,-2.44282e+00,-2.44436e+00,-2.44587e+00,-2.44733e+00,-2.44876e+00,-2.45014e+00,-2.45148e+00,-2.45277e+00,-2.45403e+00,-2.45525e+00,-2.45642e+00,-2.45755e+00,-2.45864e+00,-2.45968e+00,-2.46068e+00,-2.46164e+00,-2.46256e+00,-2.46343e+00,-2.46426e+00,-2.46505e+00,-2.46579e+00,-2.46649e+00,-2.46714e+00,-2.46775e+00,-2.46832e+00,-2.46884e+00,-2.46932e+00,-2.46976e+00,-2.47014e+00,-2.47049e+00,-2.47079e+00,-2.47104e+00,-2.47125e+00,-2.47142e+00,-2.47154e+00,-2.47162e+00,-2.47165e+00,-2.47164e+00,-2.47158e+00,-2.47148e+00,-2.47133e+00,-2.47114e+00,-2.47090e+00,-2.47062e+00,-2.47029e+00,-2.46992e+00,-2.46951e+00,-2.46905e+00,-2.46854e+00,-2.46800e+00,-2.46740e+00,-2.46677e+00,-2.46609e+00,-2.46536e+00,-2.46459e+00,-2.46378e+00,-2.46293e+00,-2.46203e+00,-2.46109e+00,-2.46010e+00,-2.45908e+00,-2.45801e+00,-2.45689e+00,-2.45574e+00,-2.45454e+00,-2.45330e+00,-2.45202e+00,-2.45070e+00,-2.44933e+00,-2.44793e+00,-2.44648e+00,-2.44499e+00,-2.44346e+00,-2.44190e+00,-2.44029e+00,-2.43864e+00,-2.43695e+00,-2.43522e+00,-2.43346e+00,-2.43165e+00,-2.42981e+00,-2.42792e+00,-2.42600e+00,-2.42404e+00,-2.42204e+00,-2.42001e+00,-2.41794e+00,-2.41583e+00,-2.41368e+00,-2.41150e+00,-2.40928e+00,-2.40702e+00,-2.40473e+00,-2.40241e+00,-2.40004e+00,-2.39765e+00,-2.39522e+00,-2.39275e+00,-2.39025e+00,-2.38772e+00,-2.38515e+00,-2.38255e+00,-2.37991e+00,-2.37725e+00,-2.37455e+00,-2.37181e+00,-2.36905e+00,-2.36625e+00,-2.36343e+00,-2.36057e+00,-2.35768e+00,-2.35475e+00,-2.35180e+00,-2.34882e+00,-2.34581e+00,-2.34276e+00,-2.33969e+00,-2.33659e+00,-2.33346e+00,-2.33030e+00,-2.32711e+00,-2.32389e+00,-2.32065e+00,-2.31737e+00,-2.31407e+00,-2.31074e+00,-2.30739e+00,-2.30400e+00,-2.30059e+00,-2.29715e+00,-2.29369e+00,-2.29020e+00,-2.28668e+00,-2.28314e+00,-2.27957e+00,-2.27597e+00,-2.27235e+00,-2.26871e+00,-2.26504e+00,-2.26134e+00,-2.25762e+00,-2.25388e+00,-2.25011e+00,-2.24632e+00,-2.24250e+00,-2.23866e+00,-2.23480e+00,-2.23091e+00,-2.22700e+00,-2.22306e+00,-2.21910e+00,-2.21512e+00,-2.21112e+00,-2.20709e+00,-2.20304e+00,-2.19897e+00,-2.19488e+00,-2.19076e+00,-2.18663e+00,-2.18247e+00,-2.17829e+00,-2.17408e+00,-2.16986e+00,-2.16561e+00,-2.16135e+00,-2.15706e+00,-2.15275e+00,-2.14842e+00,-2.14407e+00,-2.13969e+00,-2.13530e+00,-2.13089e+00,-2.12645e+00,-2.12200e+00,-2.11752e+00,-2.11303e+00,-2.10851e+00,-2.10398e+00};
float trac_tvect[500] ={0.00000e+00,2.00401e-03,4.00802e-03,6.01202e-03,8.01603e-03,1.00200e-02,1.20240e-02,1.40281e-02,1.60321e-02,1.80361e-02,2.00401e-02,2.20441e-02,2.40481e-02,2.60521e-02,2.80561e-02,3.00601e-02,3.20641e-02,3.40681e-02,3.60721e-02,3.80762e-02,4.00802e-02,4.20842e-02,4.40882e-02,4.60922e-02,4.80962e-02,5.01002e-02,5.21042e-02,5.41082e-02,5.61122e-02,5.81162e-02,6.01202e-02,6.21242e-02,6.41283e-02,6.61323e-02,6.81363e-02,7.01403e-02,7.21443e-02,7.41483e-02,7.61523e-02,7.81563e-02,8.01603e-02,8.21643e-02,8.41683e-02,8.61723e-02,8.81764e-02,9.01804e-02,9.21844e-02,9.41884e-02,9.61924e-02,9.81964e-02,1.00200e-01,1.02204e-01,1.04208e-01,1.06212e-01,1.08216e-01,1.10220e-01,1.12224e-01,1.14228e-01,1.16232e-01,1.18236e-01,1.20240e-01,1.22244e-01,1.24248e-01,1.26253e-01,1.28257e-01,1.30261e-01,1.32265e-01,1.34269e-01,1.36273e-01,1.38277e-01,1.40281e-01,1.42285e-01,1.44289e-01,1.46293e-01,1.48297e-01,1.50301e-01,1.52305e-01,1.54309e-01,1.56313e-01,1.58317e-01,1.60321e-01,1.62325e-01,1.64329e-01,1.66333e-01,1.68337e-01,1.70341e-01,1.72345e-01,1.74349e-01,1.76353e-01,1.78357e-01,1.80361e-01,1.82365e-01,1.84369e-01,1.86373e-01,1.88377e-01,1.90381e-01,1.92385e-01,1.94389e-01,1.96393e-01,1.98397e-01,2.00401e-01,2.02405e-01,2.04409e-01,2.06413e-01,2.08417e-01,2.10421e-01,2.12425e-01,2.14429e-01,2.16433e-01,2.18437e-01,2.20441e-01,2.22445e-01,2.24449e-01,2.26453e-01,2.28457e-01,2.30461e-01,2.32465e-01,2.34469e-01,2.36473e-01,2.38477e-01,2.40481e-01,2.42485e-01,2.44489e-01,2.46493e-01,2.48497e-01,2.50501e-01,2.52505e-01,2.54509e-01,2.56513e-01,2.58517e-01,2.60521e-01,2.62525e-01,2.64529e-01,2.66533e-01,2.68537e-01,2.70541e-01,2.72545e-01,2.74549e-01,2.76553e-01,2.78557e-01,2.80561e-01,2.82565e-01,2.84569e-01,2.86573e-01,2.88577e-01,2.90581e-01,2.92585e-01,2.94589e-01,2.96593e-01,2.98597e-01,3.00601e-01,3.02605e-01,3.04609e-01,3.06613e-01,3.08617e-01,3.10621e-01,3.12625e-01,3.14629e-01,3.16633e-01,3.18637e-01,3.20641e-01,3.22645e-01,3.24649e-01,3.26653e-01,3.28657e-01,3.30661e-01,3.32665e-01,3.34669e-01,3.36673e-01,3.38677e-01,3.40681e-01,3.42685e-01,3.44689e-01,3.46693e-01,3.48697e-01,3.50701e-01,3.52705e-01,3.54709e-01,3.56713e-01,3.58717e-01,3.60721e-01,3.62725e-01,3.64729e-01,3.66733e-01,3.68737e-01,3.70741e-01,3.72745e-01,3.74749e-01,3.76754e-01,3.78758e-01,3.80762e-01,3.82766e-01,3.84770e-01,3.86774e-01,3.88778e-01,3.90782e-01,3.92786e-01,3.94790e-01,3.96794e-01,3.98798e-01,4.00802e-01,4.02806e-01,4.04810e-01,4.06814e-01,4.08818e-01,4.10822e-01,4.12826e-01,4.14830e-01,4.16834e-01,4.18838e-01,4.20842e-01,4.22846e-01,4.24850e-01,4.26854e-01,4.28858e-01,4.30862e-01,4.32866e-01,4.34870e-01,4.36874e-01,4.38878e-01,4.40882e-01,4.42886e-01,4.44890e-01,4.46894e-01,4.48898e-01,4.50902e-01,4.52906e-01,4.54910e-01,4.56914e-01,4.58918e-01,4.60922e-01,4.62926e-01,4.64930e-01,4.66934e-01,4.68938e-01,4.70942e-01,4.72946e-01,4.74950e-01,4.76954e-01,4.78958e-01,4.80962e-01,4.82966e-01,4.84970e-01,4.86974e-01,4.88978e-01,4.90982e-01,4.92986e-01,4.94990e-01,4.96994e-01,4.98998e-01,5.01002e-01,5.03006e-01,5.05010e-01,5.07014e-01,5.09018e-01,5.11022e-01,5.13026e-01,5.15030e-01,5.17034e-01,5.19038e-01,5.21042e-01,5.23046e-01,5.25050e-01,5.27054e-01,5.29058e-01,5.31062e-01,5.33066e-01,5.35070e-01,5.37074e-01,5.39078e-01,5.41082e-01,5.43086e-01,5.45090e-01,5.47094e-01,5.49098e-01,5.51102e-01,5.53106e-01,5.55110e-01,5.57114e-01,5.59118e-01,5.61122e-01,5.63126e-01,5.65130e-01,5.67134e-01,5.69138e-01,5.71142e-01,5.73146e-01,5.75150e-01,5.77154e-01,5.79158e-01,5.81162e-01,5.83166e-01,5.85170e-01,5.87174e-01,5.89178e-01,5.91182e-01,5.93186e-01,5.95190e-01,5.97194e-01,5.99198e-01,6.01202e-01,6.03206e-01,6.05210e-01,6.07214e-01,6.09218e-01,6.11222e-01,6.13226e-01,6.15230e-01,6.17234e-01,6.19238e-01,6.21242e-01,6.23246e-01,6.25251e-01,6.27255e-01,6.29259e-01,6.31263e-01,6.33267e-01,6.35271e-01,6.37275e-01,6.39279e-01,6.41283e-01,6.43287e-01,6.45291e-01,6.47295e-01,6.49299e-01,6.51303e-01,6.53307e-01,6.55311e-01,6.57315e-01,6.59319e-01,6.61323e-01,6.63327e-01,6.65331e-01,6.67335e-01,6.69339e-01,6.71343e-01,6.73347e-01,6.75351e-01,6.77355e-01,6.79359e-01,6.81363e-01,6.83367e-01,6.85371e-01,6.87375e-01,6.89379e-01,6.91383e-01,6.93387e-01,6.95391e-01,6.97395e-01,6.99399e-01,7.01403e-01,7.03407e-01,7.05411e-01,7.07415e-01,7.09419e-01,7.11423e-01,7.13427e-01,7.15431e-01,7.17435e-01,7.19439e-01,7.21443e-01,7.23447e-01,7.25451e-01,7.27455e-01,7.29459e-01,7.31463e-01,7.33467e-01,7.35471e-01,7.37475e-01,7.39479e-01,7.41483e-01,7.43487e-01,7.45491e-01,7.47495e-01,7.49499e-01,7.51503e-01,7.53507e-01,7.55511e-01,7.57515e-01,7.59519e-01,7.61523e-01,7.63527e-01,7.65531e-01,7.67535e-01,7.69539e-01,7.71543e-01,7.73547e-01,7.75551e-01,7.77555e-01,7.79559e-01,7.81563e-01,7.83567e-01,7.85571e-01,7.87575e-01,7.89579e-01,7.91583e-01,7.93587e-01,7.95591e-01,7.97595e-01,7.99599e-01,8.01603e-01,8.03607e-01,8.05611e-01,8.07615e-01,8.09619e-01,8.11623e-01,8.13627e-01,8.15631e-01,8.17635e-01,8.19639e-01,8.21643e-01,8.23647e-01,8.25651e-01,8.27655e-01,8.29659e-01,8.31663e-01,8.33667e-01,8.35671e-01,8.37675e-01,8.39679e-01,8.41683e-01,8.43687e-01,8.45691e-01,8.47695e-01,8.49699e-01,8.51703e-01,8.53707e-01,8.55711e-01,8.57715e-01,8.59719e-01,8.61723e-01,8.63727e-01,8.65731e-01,8.67735e-01,8.69739e-01,8.71743e-01,8.73747e-01,8.75752e-01,8.77756e-01,8.79760e-01,8.81764e-01,8.83768e-01,8.85772e-01,8.87776e-01,8.89780e-01,8.91784e-01,8.93788e-01,8.95792e-01,8.97796e-01,8.99800e-01,9.01804e-01,9.03808e-01,9.05812e-01,9.07816e-01,9.09820e-01,9.11824e-01,9.13828e-01,9.15832e-01,9.17836e-01,9.19840e-01,9.21844e-01,9.23848e-01,9.25852e-01,9.27856e-01,9.29860e-01,9.31864e-01,9.33868e-01,9.35872e-01,9.37876e-01,9.39880e-01,9.41884e-01,9.43888e-01,9.45892e-01,9.47896e-01,9.49900e-01,9.51904e-01,9.53908e-01,9.55912e-01,9.57916e-01,9.59920e-01,9.61924e-01,9.63928e-01,9.65932e-01,9.67936e-01,9.69940e-01,9.71944e-01,9.73948e-01,9.75952e-01,9.77956e-01,9.79960e-01,9.81964e-01,9.83968e-01,9.85972e-01,9.87976e-01,9.89980e-01,9.91984e-01,9.93988e-01,9.95992e-01,9.97996e-01,1.00000e+00};

/* Circular Trjectory */
//float thd1_trac[500]={1.57080e+00,1.57339e+00,1.57598e+00,1.57857e+00,1.58116e+00,1.58375e+00,1.58634e+00,1.58893e+00,1.59152e+00,1.59412e+00,1.59671e+00,1.59931e+00,1.60190e+00,1.60450e+00,1.60709e+00,1.60969e+00,1.61229e+00,1.61489e+00,1.61749e+00,1.62009e+00,1.62270e+00,1.62530e+00,1.62791e+00,1.63052e+00,1.63313e+00,1.63574e+00,1.63835e+00,1.64097e+00,1.64358e+00,1.64620e+00,1.64882e+00,1.65145e+00,1.65407e+00,1.65670e+00,1.65933e+00,1.66196e+00,1.66460e+00,1.66724e+00,1.66988e+00,1.67252e+00,1.67516e+00,1.67781e+00,1.68046e+00,1.68312e+00,1.68577e+00,1.68843e+00,1.69110e+00,1.69376e+00,1.69643e+00,1.69911e+00,1.70178e+00,1.70446e+00,1.70715e+00,1.70983e+00,1.71252e+00,1.71522e+00,1.71792e+00,1.72062e+00,1.72332e+00,1.72603e+00,1.72875e+00,1.73147e+00,1.73419e+00,1.73691e+00,1.73965e+00,1.74238e+00,1.74512e+00,1.74787e+00,1.75061e+00,1.75337e+00,1.75613e+00,1.75889e+00,1.76166e+00,1.76443e+00,1.76721e+00,1.76999e+00,1.77277e+00,1.77557e+00,1.77836e+00,1.78117e+00,1.78397e+00,1.78679e+00,1.78961e+00,1.79243e+00,1.79526e+00,1.79809e+00,1.80093e+00,1.80378e+00,1.80663e+00,1.80949e+00,1.81235e+00,1.81522e+00,1.81809e+00,1.82097e+00,1.82386e+00,1.82675e+00,1.82965e+00,1.83255e+00,1.83546e+00,1.83838e+00,1.84130e+00,1.84423e+00,1.84716e+00,1.85010e+00,1.85305e+00,1.85600e+00,1.85896e+00,1.86192e+00,1.86489e+00,1.86787e+00,1.87085e+00,1.87384e+00,1.87684e+00,1.87984e+00,1.88285e+00,1.88587e+00,1.88889e+00,1.89192e+00,1.89495e+00,1.89799e+00,1.90104e+00,1.90409e+00,1.90715e+00,1.91021e+00,1.91329e+00,1.91636e+00,1.91945e+00,1.92254e+00,1.92564e+00,1.92874e+00,1.93185e+00,1.93496e+00,1.93808e+00,1.94121e+00,1.94434e+00,1.94748e+00,1.95062e+00,1.95377e+00,1.95693e+00,1.96009e+00,1.96326e+00,1.96643e+00,1.96961e+00,1.97279e+00,1.97598e+00,1.97917e+00,1.98237e+00,1.98557e+00,1.98878e+00,1.99199e+00,1.99521e+00,1.99843e+00,2.00166e+00,2.00489e+00,2.00812e+00,2.01136e+00,2.01460e+00,2.01785e+00,2.02110e+00,2.02435e+00,2.02761e+00,2.03086e+00,2.03413e+00,2.03739e+00,2.04066e+00,2.04392e+00,2.04720e+00,2.05047e+00,2.05374e+00,2.05702e+00,2.06029e+00,2.06357e+00,2.06685e+00,2.07013e+00,2.07341e+00,2.07669e+00,2.07997e+00,2.08324e+00,2.08652e+00,2.08980e+00,2.09307e+00,2.09634e+00,2.09962e+00,2.10288e+00,2.10615e+00,2.10941e+00,2.11267e+00,2.11593e+00,2.11918e+00,2.12243e+00,2.12567e+00,2.12891e+00,2.13214e+00,2.13537e+00,2.13859e+00,2.14180e+00,2.14501e+00,2.14821e+00,2.15140e+00,2.15458e+00,2.15776e+00,2.16092e+00,2.16408e+00,2.16722e+00,2.17036e+00,2.17348e+00,2.17660e+00,2.17970e+00,2.18279e+00,2.18586e+00,2.18893e+00,2.19198e+00,2.19501e+00,2.19803e+00,2.20104e+00,2.20403e+00,2.20700e+00,2.20996e+00,2.21290e+00,2.21582e+00,2.21872e+00,2.22160e+00,2.22447e+00,2.22731e+00,2.23014e+00,2.23294e+00,2.23572e+00,2.23848e+00,2.24122e+00,2.24393e+00,2.24662e+00,2.24929e+00,2.25193e+00,2.25454e+00,2.25713e+00,2.25970e+00,2.26223e+00,2.26474e+00,2.26722e+00,2.26967e+00,2.27209e+00,2.27448e+00,2.27684e+00,2.27918e+00,2.28147e+00,2.28374e+00,2.28598e+00,2.28818e+00,2.29034e+00,2.29248e+00,2.29458e+00,2.29664e+00,2.29867e+00,2.30066e+00,2.30261e+00,2.30453e+00,2.30641e+00,2.30825e+00,2.31005e+00,2.31182e+00,2.31354e+00,2.31523e+00,2.31687e+00,2.31847e+00,2.32003e+00,2.32155e+00,2.32303e+00,2.32446e+00,2.32585e+00,2.32720e+00,2.32851e+00,2.32976e+00,2.33098e+00,2.33215e+00,2.33327e+00,2.33435e+00,2.33539e+00,2.33637e+00,2.33731e+00,2.33821e+00,2.33905e+00,2.33985e+00,2.34060e+00,2.34131e+00,2.34196e+00,2.34257e+00,2.34312e+00,2.34363e+00,2.34409e+00,2.34450e+00,2.34486e+00,2.34517e+00,2.34543e+00,2.34565e+00,2.34581e+00,2.34592e+00,2.34598e+00,2.34599e+00,2.34595e+00,2.34586e+00,2.34571e+00,2.34552e+00,2.34528e+00,2.34498e+00,2.34463e+00,2.34424e+00,2.34379e+00,2.34329e+00,2.34274e+00,2.34214e+00,2.34149e+00,2.34079e+00,2.34003e+00,2.33923e+00,2.33837e+00,2.33746e+00,2.33651e+00,2.33550e+00,2.33444e+00,2.33333e+00,2.33217e+00,2.33096e+00,2.32971e+00,2.32840e+00,2.32704e+00,2.32563e+00,2.32417e+00,2.32266e+00,2.32111e+00,2.31950e+00,2.31785e+00,2.31614e+00,2.31439e+00,2.31259e+00,2.31074e+00,2.30885e+00,2.30690e+00,2.30491e+00,2.30287e+00,2.30079e+00,2.29866e+00,2.29648e+00,2.29425e+00,2.29198e+00,2.28966e+00,2.28730e+00,2.28490e+00,2.28244e+00,2.27995e+00,2.27740e+00,2.27482e+00,2.27219e+00,2.26952e+00,2.26680e+00,2.26404e+00,2.26124e+00,2.25839e+00,2.25551e+00,2.25258e+00,2.24961e+00,2.24660e+00,2.24355e+00,2.24045e+00,2.23732e+00,2.23415e+00,2.23093e+00,2.22768e+00,2.22439e+00,2.22106e+00,2.21769e+00,2.21428e+00,2.21084e+00,2.20736e+00,2.20384e+00,2.20028e+00,2.19669e+00,2.19306e+00,2.18940e+00,2.18570e+00,2.18196e+00,2.17819e+00,2.17439e+00,2.17055e+00,2.16668e+00,2.16277e+00,2.15883e+00,2.15486e+00,2.15086e+00,2.14682e+00,2.14275e+00,2.13865e+00,2.13452e+00,2.13035e+00,2.12616e+00,2.12194e+00,2.11768e+00,2.11340e+00,2.10909e+00,2.10475e+00,2.10038e+00,2.09598e+00,2.09155e+00,2.08710e+00,2.08262e+00,2.07811e+00,2.07358e+00,2.06901e+00,2.06443e+00,2.05981e+00,2.05518e+00,2.05051e+00,2.04582e+00,2.04111e+00,2.03637e+00,2.03161e+00,2.02683e+00,2.02202e+00,2.01719e+00,2.01234e+00,2.00746e+00,2.00256e+00,1.99764e+00,1.99270e+00,1.98774e+00,1.98276e+00,1.97776e+00,1.97273e+00,1.96769e+00,1.96263e+00,1.95754e+00,1.95244e+00,1.94732e+00,1.94219e+00,1.93703e+00,1.93186e+00,1.92667e+00,1.92146e+00,1.91623e+00,1.91099e+00,1.90573e+00,1.90046e+00,1.89517e+00,1.88986e+00,1.88454e+00,1.87920e+00,1.87385e+00,1.86849e+00,1.86311e+00,1.85772e+00,1.85231e+00,1.84689e+00,1.84146e+00,1.83602e+00,1.83056e+00,1.82509e+00,1.81961e+00,1.81412e+00,1.80861e+00,1.80310e+00,1.79757e+00,1.79204e+00,1.78649e+00,1.78093e+00,1.77537e+00,1.76979e+00,1.76421e+00,1.75861e+00,1.75301e+00,1.74740e+00,1.74178e+00,1.73616e+00,1.73052e+00,1.72488e+00,1.71924e+00,1.71358e+00,1.70792e+00,1.70225e+00,1.69658e+00,1.69090e+00,1.68522e+00,1.67953e+00,1.67383e+00,1.66814e+00,1.66243e+00,1.65673e+00,1.65101e+00,1.64530e+00,1.63958e+00,1.63386e+00,1.62814e+00,1.62241e+00,1.61668e+00,1.61095e+00,1.60522e+00,1.59948e+00,1.59375e+00,1.58801e+00,1.58227e+00,1.57653e+00,1.57080e+00};
//float thd2_trac[500]={-3.65002e-08,-8.32850e-03,-1.66568e-02,-2.49848e-02,-3.33121e-02,-4.16388e-02,-4.99645e-02,-5.82891e-02,-6.66124e-02,-7.49342e-02,-8.32543e-02,-9.15726e-02,-9.98888e-02,-1.08203e-01,-1.16514e-01,-1.24823e-01,-1.33130e-01,-1.41433e-01,-1.49733e-01,-1.58029e-01,-1.66322e-01,-1.74612e-01,-1.82897e-01,-1.91178e-01,-1.99455e-01,-2.07728e-01,-2.15996e-01,-2.24259e-01,-2.32516e-01,-2.40769e-01,-2.49016e-01,-2.57257e-01,-2.65493e-01,-2.73722e-01,-2.81945e-01,-2.90162e-01,-2.98372e-01,-3.06575e-01,-3.14772e-01,-3.22961e-01,-3.31142e-01,-3.39316e-01,-3.47482e-01,-3.55640e-01,-3.63789e-01,-3.71930e-01,-3.80063e-01,-3.88186e-01,-3.96301e-01,-4.04406e-01,-4.12501e-01,-4.20587e-01,-4.28663e-01,-4.36729e-01,-4.44784e-01,-4.52829e-01,-4.60863e-01,-4.68886e-01,-4.76898e-01,-4.84898e-01,-4.92886e-01,-5.00863e-01,-5.08827e-01,-5.16779e-01,-5.24718e-01,-5.32645e-01,-5.40558e-01,-5.48459e-01,-5.56345e-01,-5.64218e-01,-5.72077e-01,-5.79922e-01,-5.87752e-01,-5.95567e-01,-6.03368e-01,-6.11153e-01,-6.18923e-01,-6.26677e-01,-6.34415e-01,-6.42136e-01,-6.49842e-01,-6.57530e-01,-6.65202e-01,-6.72856e-01,-6.80493e-01,-6.88113e-01,-6.95714e-01,-7.03296e-01,-7.10861e-01,-7.18406e-01,-7.25932e-01,-7.33439e-01,-7.40927e-01,-7.48394e-01,-7.55841e-01,-7.63268e-01,-7.70674e-01,-7.78059e-01,-7.85422e-01,-7.92764e-01,-8.00084e-01,-8.07381e-01,-8.14656e-01,-8.21909e-01,-8.29138e-01,-8.36344e-01,-8.43526e-01,-8.50684e-01,-8.57817e-01,-8.64926e-01,-8.72011e-01,-8.79069e-01,-8.86102e-01,-8.93110e-01,-9.00091e-01,-9.07045e-01,-9.13973e-01,-9.20873e-01,-9.27746e-01,-9.34590e-01,-9.41407e-01,-9.48195e-01,-9.54954e-01,-9.61684e-01,-9.68384e-01,-9.75055e-01,-9.81695e-01,-9.88304e-01,-9.94883e-01,-1.00143e+00,-1.00795e+00,-1.01443e+00,-1.02088e+00,-1.02730e+00,-1.03368e+00,-1.04003e+00,-1.04635e+00,-1.05263e+00,-1.05888e+00,-1.06510e+00,-1.07127e+00,-1.07742e+00,-1.08352e+00,-1.08959e+00,-1.09562e+00,-1.10162e+00,-1.10758e+00,-1.11350e+00,-1.11938e+00,-1.12522e+00,-1.13102e+00,-1.13679e+00,-1.14251e+00,-1.14819e+00,-1.15383e+00,-1.15943e+00,-1.16499e+00,-1.17051e+00,-1.17598e+00,-1.18141e+00,-1.18680e+00,-1.19214e+00,-1.19744e+00,-1.20270e+00,-1.20791e+00,-1.21307e+00,-1.21819e+00,-1.22327e+00,-1.22829e+00,-1.23327e+00,-1.23820e+00,-1.24309e+00,-1.24792e+00,-1.25271e+00,-1.25744e+00,-1.26213e+00,-1.26677e+00,-1.27136e+00,-1.27589e+00,-1.28038e+00,-1.28481e+00,-1.28919e+00,-1.29352e+00,-1.29780e+00,-1.30202e+00,-1.30619e+00,-1.31031e+00,-1.31437e+00,-1.31837e+00,-1.32232e+00,-1.32622e+00,-1.33006e+00,-1.33384e+00,-1.33756e+00,-1.34123e+00,-1.34484e+00,-1.34840e+00,-1.35189e+00,-1.35533e+00,-1.35870e+00,-1.36202e+00,-1.36528e+00,-1.36847e+00,-1.37161e+00,-1.37468e+00,-1.37770e+00,-1.38065e+00,-1.38354e+00,-1.38637e+00,-1.38913e+00,-1.39184e+00,-1.39448e+00,-1.39705e+00,-1.39956e+00,-1.40201e+00,-1.40439e+00,-1.40671e+00,-1.40897e+00,-1.41115e+00,-1.41328e+00,-1.41533e+00,-1.41732e+00,-1.41925e+00,-1.42111e+00,-1.42290e+00,-1.42462e+00,-1.42628e+00,-1.42787e+00,-1.42939e+00,-1.43085e+00,-1.43223e+00,-1.43355e+00,-1.43480e+00,-1.43598e+00,-1.43709e+00,-1.43814e+00,-1.43911e+00,-1.44002e+00,-1.44085e+00,-1.44162e+00,-1.44232e+00,-1.44294e+00,-1.44350e+00,-1.44399e+00,-1.44441e+00,-1.44476e+00,-1.44504e+00,-1.44525e+00,-1.44539e+00,-1.44546e+00,-1.44546e+00,-1.44539e+00,-1.44525e+00,-1.44504e+00,-1.44476e+00,-1.44441e+00,-1.44399e+00,-1.44350e+00,-1.44294e+00,-1.44232e+00,-1.44162e+00,-1.44085e+00,-1.44002e+00,-1.43911e+00,-1.43814e+00,-1.43709e+00,-1.43598e+00,-1.43480e+00,-1.43355e+00,-1.43223e+00,-1.43085e+00,-1.42939e+00,-1.42787e+00,-1.42628e+00,-1.42462e+00,-1.42290e+00,-1.42111e+00,-1.41925e+00,-1.41732e+00,-1.41533e+00,-1.41328e+00,-1.41115e+00,-1.40897e+00,-1.40671e+00,-1.40439e+00,-1.40201e+00,-1.39956e+00,-1.39705e+00,-1.39448e+00,-1.39184e+00,-1.38913e+00,-1.38637e+00,-1.38354e+00,-1.38065e+00,-1.37770e+00,-1.37468e+00,-1.37161e+00,-1.36847e+00,-1.36528e+00,-1.36202e+00,-1.35870e+00,-1.35533e+00,-1.35189e+00,-1.34840e+00,-1.34484e+00,-1.34123e+00,-1.33756e+00,-1.33384e+00,-1.33006e+00,-1.32622e+00,-1.32232e+00,-1.31837e+00,-1.31437e+00,-1.31031e+00,-1.30619e+00,-1.30202e+00,-1.29780e+00,-1.29352e+00,-1.28919e+00,-1.28481e+00,-1.28038e+00,-1.27589e+00,-1.27136e+00,-1.26677e+00,-1.26213e+00,-1.25744e+00,-1.25271e+00,-1.24792e+00,-1.24309e+00,-1.23820e+00,-1.23327e+00,-1.22829e+00,-1.22327e+00,-1.21819e+00,-1.21307e+00,-1.20791e+00,-1.20270e+00,-1.19744e+00,-1.19214e+00,-1.18680e+00,-1.18141e+00,-1.17598e+00,-1.17051e+00,-1.16499e+00,-1.15943e+00,-1.15383e+00,-1.14819e+00,-1.14251e+00,-1.13679e+00,-1.13102e+00,-1.12522e+00,-1.11938e+00,-1.11350e+00,-1.10758e+00,-1.10162e+00,-1.09562e+00,-1.08959e+00,-1.08352e+00,-1.07742e+00,-1.07127e+00,-1.06510e+00,-1.05888e+00,-1.05263e+00,-1.04635e+00,-1.04003e+00,-1.03368e+00,-1.02730e+00,-1.02088e+00,-1.01443e+00,-1.00795e+00,-1.00143e+00,-9.94883e-01,-9.88304e-01,-9.81695e-01,-9.75055e-01,-9.68384e-01,-9.61684e-01,-9.54954e-01,-9.48195e-01,-9.41407e-01,-9.34590e-01,-9.27746e-01,-9.20873e-01,-9.13973e-01,-9.07045e-01,-9.00091e-01,-8.93110e-01,-8.86102e-01,-8.79069e-01,-8.72011e-01,-8.64926e-01,-8.57817e-01,-8.50684e-01,-8.43526e-01,-8.36344e-01,-8.29138e-01,-8.21909e-01,-8.14656e-01,-8.07381e-01,-8.00084e-01,-7.92764e-01,-7.85422e-01,-7.78059e-01,-7.70674e-01,-7.63268e-01,-7.55841e-01,-7.48394e-01,-7.40927e-01,-7.33439e-01,-7.25932e-01,-7.18406e-01,-7.10861e-01,-7.03296e-01,-6.95714e-01,-6.88113e-01,-6.80493e-01,-6.72856e-01,-6.65202e-01,-6.57530e-01,-6.49842e-01,-6.42136e-01,-6.34415e-01,-6.26677e-01,-6.18923e-01,-6.11153e-01,-6.03368e-01,-5.95567e-01,-5.87752e-01,-5.79922e-01,-5.72077e-01,-5.64218e-01,-5.56345e-01,-5.48459e-01,-5.40558e-01,-5.32645e-01,-5.24718e-01,-5.16779e-01,-5.08827e-01,-5.00863e-01,-4.92886e-01,-4.84898e-01,-4.76898e-01,-4.68886e-01,-4.60863e-01,-4.52829e-01,-4.44784e-01,-4.36729e-01,-4.28663e-01,-4.20587e-01,-4.12501e-01,-4.04406e-01,-3.96301e-01,-3.88186e-01,-3.80063e-01,-3.71930e-01,-3.63789e-01,-3.55640e-01,-3.47482e-01,-3.39316e-01,-3.31142e-01,-3.22961e-01,-3.14772e-01,-3.06575e-01,-2.98372e-01,-2.90162e-01,-2.81945e-01,-2.73722e-01,-2.65493e-01,-2.57257e-01,-2.49016e-01,-2.40769e-01,-2.32516e-01,-2.24259e-01,-2.15996e-01,-2.07728e-01,-1.99455e-01,-1.91178e-01,-1.82897e-01,-1.74612e-01,-1.66322e-01,-1.58029e-01,-1.49733e-01,-1.41433e-01,-1.33130e-01,-1.24823e-01,-1.16514e-01,-1.08203e-01,-9.98888e-02,-9.15726e-02,-8.32543e-02,-7.49342e-02,-6.66124e-02,-5.82891e-02,-4.99645e-02,-4.16388e-02,-3.33121e-02,-2.49848e-02,-1.66568e-02,-8.32850e-03,-3.65002e-08};
//float trac_tvect[500]={0.00000e+00,2.00401e-03,4.00802e-03,6.01202e-03,8.01603e-03,1.00200e-02,1.20240e-02,1.40281e-02,1.60321e-02,1.80361e-02,2.00401e-02,2.20441e-02,2.40481e-02,2.60521e-02,2.80561e-02,3.00601e-02,3.20641e-02,3.40681e-02,3.60721e-02,3.80762e-02,4.00802e-02,4.20842e-02,4.40882e-02,4.60922e-02,4.80962e-02,5.01002e-02,5.21042e-02,5.41082e-02,5.61122e-02,5.81162e-02,6.01202e-02,6.21242e-02,6.41283e-02,6.61323e-02,6.81363e-02,7.01403e-02,7.21443e-02,7.41483e-02,7.61523e-02,7.81563e-02,8.01603e-02,8.21643e-02,8.41683e-02,8.61723e-02,8.81764e-02,9.01804e-02,9.21844e-02,9.41884e-02,9.61924e-02,9.81964e-02,1.00200e-01,1.02204e-01,1.04208e-01,1.06212e-01,1.08216e-01,1.10220e-01,1.12224e-01,1.14228e-01,1.16232e-01,1.18236e-01,1.20240e-01,1.22244e-01,1.24248e-01,1.26253e-01,1.28257e-01,1.30261e-01,1.32265e-01,1.34269e-01,1.36273e-01,1.38277e-01,1.40281e-01,1.42285e-01,1.44289e-01,1.46293e-01,1.48297e-01,1.50301e-01,1.52305e-01,1.54309e-01,1.56313e-01,1.58317e-01,1.60321e-01,1.62325e-01,1.64329e-01,1.66333e-01,1.68337e-01,1.70341e-01,1.72345e-01,1.74349e-01,1.76353e-01,1.78357e-01,1.80361e-01,1.82365e-01,1.84369e-01,1.86373e-01,1.88377e-01,1.90381e-01,1.92385e-01,1.94389e-01,1.96393e-01,1.98397e-01,2.00401e-01,2.02405e-01,2.04409e-01,2.06413e-01,2.08417e-01,2.10421e-01,2.12425e-01,2.14429e-01,2.16433e-01,2.18437e-01,2.20441e-01,2.22445e-01,2.24449e-01,2.26453e-01,2.28457e-01,2.30461e-01,2.32465e-01,2.34469e-01,2.36473e-01,2.38477e-01,2.40481e-01,2.42485e-01,2.44489e-01,2.46493e-01,2.48497e-01,2.50501e-01,2.52505e-01,2.54509e-01,2.56513e-01,2.58517e-01,2.60521e-01,2.62525e-01,2.64529e-01,2.66533e-01,2.68537e-01,2.70541e-01,2.72545e-01,2.74549e-01,2.76553e-01,2.78557e-01,2.80561e-01,2.82565e-01,2.84569e-01,2.86573e-01,2.88577e-01,2.90581e-01,2.92585e-01,2.94589e-01,2.96593e-01,2.98597e-01,3.00601e-01,3.02605e-01,3.04609e-01,3.06613e-01,3.08617e-01,3.10621e-01,3.12625e-01,3.14629e-01,3.16633e-01,3.18637e-01,3.20641e-01,3.22645e-01,3.24649e-01,3.26653e-01,3.28657e-01,3.30661e-01,3.32665e-01,3.34669e-01,3.36673e-01,3.38677e-01,3.40681e-01,3.42685e-01,3.44689e-01,3.46693e-01,3.48697e-01,3.50701e-01,3.52705e-01,3.54709e-01,3.56713e-01,3.58717e-01,3.60721e-01,3.62725e-01,3.64729e-01,3.66733e-01,3.68737e-01,3.70741e-01,3.72745e-01,3.74749e-01,3.76754e-01,3.78758e-01,3.80762e-01,3.82766e-01,3.84770e-01,3.86774e-01,3.88778e-01,3.90782e-01,3.92786e-01,3.94790e-01,3.96794e-01,3.98798e-01,4.00802e-01,4.02806e-01,4.04810e-01,4.06814e-01,4.08818e-01,4.10822e-01,4.12826e-01,4.14830e-01,4.16834e-01,4.18838e-01,4.20842e-01,4.22846e-01,4.24850e-01,4.26854e-01,4.28858e-01,4.30862e-01,4.32866e-01,4.34870e-01,4.36874e-01,4.38878e-01,4.40882e-01,4.42886e-01,4.44890e-01,4.46894e-01,4.48898e-01,4.50902e-01,4.52906e-01,4.54910e-01,4.56914e-01,4.58918e-01,4.60922e-01,4.62926e-01,4.64930e-01,4.66934e-01,4.68938e-01,4.70942e-01,4.72946e-01,4.74950e-01,4.76954e-01,4.78958e-01,4.80962e-01,4.82966e-01,4.84970e-01,4.86974e-01,4.88978e-01,4.90982e-01,4.92986e-01,4.94990e-01,4.96994e-01,4.98998e-01,5.01002e-01,5.03006e-01,5.05010e-01,5.07014e-01,5.09018e-01,5.11022e-01,5.13026e-01,5.15030e-01,5.17034e-01,5.19038e-01,5.21042e-01,5.23046e-01,5.25050e-01,5.27054e-01,5.29058e-01,5.31062e-01,5.33066e-01,5.35070e-01,5.37074e-01,5.39078e-01,5.41082e-01,5.43086e-01,5.45090e-01,5.47094e-01,5.49098e-01,5.51102e-01,5.53106e-01,5.55110e-01,5.57114e-01,5.59118e-01,5.61122e-01,5.63126e-01,5.65130e-01,5.67134e-01,5.69138e-01,5.71142e-01,5.73146e-01,5.75150e-01,5.77154e-01,5.79158e-01,5.81162e-01,5.83166e-01,5.85170e-01,5.87174e-01,5.89178e-01,5.91182e-01,5.93186e-01,5.95190e-01,5.97194e-01,5.99198e-01,6.01202e-01,6.03206e-01,6.05210e-01,6.07214e-01,6.09218e-01,6.11222e-01,6.13226e-01,6.15230e-01,6.17234e-01,6.19238e-01,6.21242e-01,6.23246e-01,6.25251e-01,6.27255e-01,6.29259e-01,6.31263e-01,6.33267e-01,6.35271e-01,6.37275e-01,6.39279e-01,6.41283e-01,6.43287e-01,6.45291e-01,6.47295e-01,6.49299e-01,6.51303e-01,6.53307e-01,6.55311e-01,6.57315e-01,6.59319e-01,6.61323e-01,6.63327e-01,6.65331e-01,6.67335e-01,6.69339e-01,6.71343e-01,6.73347e-01,6.75351e-01,6.77355e-01,6.79359e-01,6.81363e-01,6.83367e-01,6.85371e-01,6.87375e-01,6.89379e-01,6.91383e-01,6.93387e-01,6.95391e-01,6.97395e-01,6.99399e-01,7.01403e-01,7.03407e-01,7.05411e-01,7.07415e-01,7.09419e-01,7.11423e-01,7.13427e-01,7.15431e-01,7.17435e-01,7.19439e-01,7.21443e-01,7.23447e-01,7.25451e-01,7.27455e-01,7.29459e-01,7.31463e-01,7.33467e-01,7.35471e-01,7.37475e-01,7.39479e-01,7.41483e-01,7.43487e-01,7.45491e-01,7.47495e-01,7.49499e-01,7.51503e-01,7.53507e-01,7.55511e-01,7.57515e-01,7.59519e-01,7.61523e-01,7.63527e-01,7.65531e-01,7.67535e-01,7.69539e-01,7.71543e-01,7.73547e-01,7.75551e-01,7.77555e-01,7.79559e-01,7.81563e-01,7.83567e-01,7.85571e-01,7.87575e-01,7.89579e-01,7.91583e-01,7.93587e-01,7.95591e-01,7.97595e-01,7.99599e-01,8.01603e-01,8.03607e-01,8.05611e-01,8.07615e-01,8.09619e-01,8.11623e-01,8.13627e-01,8.15631e-01,8.17635e-01,8.19639e-01,8.21643e-01,8.23647e-01,8.25651e-01,8.27655e-01,8.29659e-01,8.31663e-01,8.33667e-01,8.35671e-01,8.37675e-01,8.39679e-01,8.41683e-01,8.43687e-01,8.45691e-01,8.47695e-01,8.49699e-01,8.51703e-01,8.53707e-01,8.55711e-01,8.57715e-01,8.59719e-01,8.61723e-01,8.63727e-01,8.65731e-01,8.67735e-01,8.69739e-01,8.71743e-01,8.73747e-01,8.75752e-01,8.77756e-01,8.79760e-01,8.81764e-01,8.83768e-01,8.85772e-01,8.87776e-01,8.89780e-01,8.91784e-01,8.93788e-01,8.95792e-01,8.97796e-01,8.99800e-01,9.01804e-01,9.03808e-01,9.05812e-01,9.07816e-01,9.09820e-01,9.11824e-01,9.13828e-01,9.15832e-01,9.17836e-01,9.19840e-01,9.21844e-01,9.23848e-01,9.25852e-01,9.27856e-01,9.29860e-01,9.31864e-01,9.33868e-01,9.35872e-01,9.37876e-01,9.39880e-01,9.41884e-01,9.43888e-01,9.45892e-01,9.47896e-01,9.49900e-01,9.51904e-01,9.53908e-01,9.55912e-01,9.57916e-01,9.59920e-01,9.61924e-01,9.63928e-01,9.65932e-01,9.67936e-01,9.69940e-01,9.71944e-01,9.73948e-01,9.75952e-01,9.77956e-01,9.79960e-01,9.81964e-01,9.83968e-01,9.85972e-01,9.87976e-01,9.89980e-01,9.91984e-01,9.93988e-01,9.95992e-01,9.97996e-01,1.00000e+00};

 float thd1=1.57-0.52;
 float thd2=0.52;
 int flag=1;

 float J_T[2][2];

 float F[2] = {0,-2};	// N

 float t1ini=0;
 float t2ini=0;
 float t1fi=0;
 float t2fi=0;
 //*********velocity desired arry***********//
 float vel_track_d1[500]={-0.000463201296152516,-0.000482105204424599,-0.000501780312467393,-0.000522258189805669,-0.000543571827382738,-0.000565756090198377,-0.000588844357163332,-0.000612875614092179,-0.000637887850374330,-0.000663920501464688,-0.000691015488163416,-0.000719216336875217,-0.000748568201702771,-0.000779118097593567,-0.000810914008331221,-0.000844008202161017,-0.000878452855790357,-0.000914303491972301,-0.000951616657141052,-0.000990452834748190,-0.00103087386482681,-0.00107294489182230,-0.00111673244990174,-0.00116230735214273,-0.00120974189260492,-0.00125911224868602,-0.00131049780660586,-0.00136398020667006,-0.00141964517796911,-0.00147758203089543,-0.00153788344081640,-0.00160064539078686,-0.00166596913464545,-0.00173395860725289,-0.00180472274946553,-0.00187837491966159,-0.00195503276417819,-0.00203481927346649,-0.00211786177534146,-0.00220429324271354,-0.00229425238679193,-0.00238788229989240,-0.00248533373259363,-0.00258676211795095,-0.00269232988869828,-0.00280220589377045,-0.00291656607931401,-0.00303559334763337,-0.00315947823265050,-0.00328841896701793,-0.00342262186425746,-0.00356230158654602,-0.00370768188667769,-0.00385899519173005,-0.00401648370917940,-0.00418039939853454,-0.00435100466911198,-0.00452857246130423,-0.00471338684787659,-0.00490574368949837,-0.00510595084440846,-0.00531432840017443,-0.00553121007995649,-0.00575694289106643,-0.00599188793043437,-0.00623642125485713,-0.00649093415744373,-0.00675583390569168,-0.00703154429138042,-0.00731850669583034,-0.00761718010894308,-0.00792804264215796,-0.00825159156225830,-0.00858834476863413,-0.00893884097841191,-0.00930364118895133,-0.00968332901574165,-0.0100785120718538,-0.0104898227310524,-0.0109179191696840,-0.0113634863092016,-0.0118272372439665,-0.0123099140233451,-0.0128122888879978,-0.0133351657829461,-0.0138793814300486,-0.0144458065423070,-0.0150353474821507,-0.0156489476081378,-0.0162875887082525,-0.0169522926464771,-0.0176441230365643,-0.0183641867991247,-0.0191136361067379,-0.0198936700657737,-0.0207055367565379,-0.0215505351587875,-0.0224300172286251,-0.0233453901555825,-0.0242981184253588,-0.0252897263580132,-0.0263218003627719,-0.0273959916726740,-0.0285140187866184,-0.0296776703341273,-0.0308888078562886,-0.0321493688817953,-0.0334613698922959,-0.0348269096211440,-0.0362481723928387,-0.0377274315909726,-0.0392670532393113,-0.0408694998900172,-0.0425373344211111,-0.0442732241816013,-0.0460799452608462,-0.0479603868248080,-0.0499175557922560,-0.0519545815664269,-0.0540747210315828,-0.0562813637137172,-0.0585780371507028,-0.0609684124977528,-0.0634563103630303,-0.0660457068110687,-0.0687407396905426,-0.0715457151415633,-0.0744651144374275,-0.0775036009964536,-0.0806660277704041,-0.0839574448592284,-0.0873831074231779,-0.0909484839633490,-0.0946592648314315,-0.0985213711782174,-0.102540964126929,-0.106724454387364,-0.111078512213370,-0.115610077711215,-0.120326371534696,-0.125234906053817,-0.130343496812790,-0.135660274508065,-0.141193697361708,-0.146952563922886,-0.152946026369283,-0.159183604201085,-0.165675198497139,-0.172431106565174,-0.179462037129596,-0.186779126007397,-0.194393952253125,-0.202318554846537,-0.210565449830447,-0.219147647993023,-0.228078672995569,-0.237372580025041,-0.247043974878014,-0.257108033532294,-0.267580522104072,-0.278477817247047,-0.289816926895947,-0.301615511317910,-0.313891904454577,-0.326665135447934,-0.339954950305865,-0.353781833596967,-0.368167030093070,-0.383132566212863,-0.398701271144386,-0.414896797489739,-0.431743641215454,-0.449267160734901,-0.467493594837720,-0.486450079209555,-0.506164661227326,-0.526666312632707,-0.547984939707646,-0.570151390468898,-0.593197458340633,-0.617155881727283,-0.642060338805428,-0.667945436773509,-0.694846694710316,-0.722800519106615,-0.751844170974736,-0.782015723382268,-0.813354008056877,-0.845898549616919,-0.879689485774937,-0.914767471732414,-0.951173566758945,-0.988949100782788,-1.02813551858455,-1.06877419898133,-1.11090624614885,-1.15457224999488,-1.19981201224895,-1.24666423470671,-1.29516616582304,-1.34535320162943,-1.39725843676330,-1.45091216124438,-1.50634129849803,-1.56356878013453,-1.62261285298992,-1.68348631415044,-1.74619566994627,-1.81074021542282,-1.87711103146909,-1.94528989775289,-2.01524812087417,-2.08694527874326,-2.16032788422943,-2.23532797357867,-2.31186162809549,-2.38982744111343,-2.46910494639985,-2.54955302887833,-2.63100834388624,-2.71328377709890,-2.79616698367263,-2.87941905194872,-2.96277334407336,-3.04593457283814,-3.12857818063278,-3.21035009220394,-3.29086691743502,-3.36971668304709,-3.44646017229328,-3.52063294875132,-3.59174813347740,-3.65929999346842,-3.72276838305685,-3.78162405816856,-3.83533485628595,-3.88337270269684,-3.92522136693141,-3.96038485333367,-3.98839626819536,-4.00882696495403,-4.02129573118534,-4.02547774936529,-4.02111304052313,-4.00801408871446,-3.98607234699175,-3.95526334379442,-3.91565014301187,-3.86738496078884,-3.81070880562509,-3.74594908241876,-3.67351518174044,-3.59389215799549,-3.50763267906912,-3.41534750053352,-3.31769477503566,-3.21536854860954,-3.10908681813113,-2.99957952719873,-2.88757686205718,-2.77379817679463,-2.65894183100693,-2.54367616722476,-2.42863179377906,-2.31439527552049,-2.20150427365856,-2.09044412005249,-1.98164576294135,-1.87548498185694,-1.77228274003055,-1.67230652298228,-1.57577250153546,-1.48284835521054,-1.39365659647203,-1.30827824617791,-1.22675672435454,-1.14910183669781,-1.07529375477552,-1.00528690575510,-0.939013704779251,-0.876388079282003,-0.817308749146928,-0.761662239443850,-0.709325613419021,-0.660168922483551,-0.614057377223809,-0.570853249097891,-0.530417516663384,-0.492611273088639,-0.457296913544181,-0.424339122027051,-0.393605677425135,-0.364968098331087,-0.338302145411196,-0.313488199128131,-0.290411529423884,-0.268962472650236,-0.249036529667013,-0.230534397654580,-0.213361946844903,-0.197430152089839,-0.182654987980924,-0.168957295111571,-0.156262624046555,-0.144501062633917,-0.133607051453877,-0.123519191455146,-0.114180047169454,-0.105535948310920,-0.0975367920645343,-0.0901358479270531,-0.0832895665842104,-0.0769573939853330,-0.0711015915003110,-0.0656870628099604,-0.0606811879841351,-0.0560536650419663,-0.0517763591491582,-0.0478231595004708,-0.0441698438437554,-0.0407939505323585,-0.0376746579336396,-0.0347926709821644,-0.0321301146287145,-0.0296704339174392,-0.0273983004044354,-0.0252995246232679,-0.0233609742968377,-0.0215704979974474,-0.0199168539547490,-0.0183896437226383,-0.0169792504197130,-0.0156767812679592,-0.0144740141641009,-0.0133633480318140,-0.0123377567089467,-0.0113907461406493,-0.0105163146599252,-0.00970891614598957,-0.00896342586670373,-0.00827510881978855,-0.00763959039912221,-0.00705282922380812,-0.00651109197746802,-0.00601093011332043,-0.00554915829453773,-0.00512283444098483,-0.00472924126998509,-0.00436586921920279,-0.00403040065299898,-0.00372069525611529,-0.00343477652942070,-0.00317081930356622,-0.00292713819782797,-0.00270217695169661,-0.00249449856526418,-0.00230277618801233,-0.00212578469882541,-0.00196239292682421,-0.00181155646361564,-0.00167231102338183,-0.00154376630850939,-0.00142510034317755,-0.00131555423943386,-0.00121442736283894,-0.00112107286742713,-0.00103489357178299,-0.000955338150754326,-0.000881897618099092,-0.000814102079083057,-0.000751517729991047,-0.000693744090118909,-0.000640411442875966,-0.000591178475062293,-0.000545730096168651,-0.000503775425098052,-0.000465045931097308,-0.000429293717463253,-0.000396289936976935,-0.000365823328407622,-0.000337698866037517,-0.000311736512270677,-0.000287770066276227,-0.000265646101005324,-0.000245222981420934,-0.000226369959055450,-0.000208966334791505,-0.000192900686979414,-0.000178070158840526,-0.000164379799383330,-0.000151741956833096,-0.000140075716748012,-0.000129306384988315,-0.000119365008988126,-0.000110187937107931,-0.000101716410294550,-9.38961871033150e-05,-8.66771955876367e-05,-8.00132130551745e-05,-7.38615705264678e-05,-6.81828790649597e-05,-6.29407778118818e-05,-5.81017015055529e-05,-5.36346649870900e-05,-4.95110655251985e-05,-4.57044989632394e-05,-4.21905915204412e-05,-3.89468429173867e-05,-3.59524829351976e-05,-3.31883379112163e-05,-3.06367085034509e-05,-2.82812561147594e-05,-2.61068979767742e-05,-2.40997112266328e-05,-2.22468433674905e-05,-2.05364297789501e-05,-1.89575184439406e-05,-1.74999987834212e-05,-1.61545380961137e-05,-1.49125208848133e-05,-1.37659940113721e-05,-1.27076160705286e-05,-1.17306098168513e-05,-1.08287190325740e-05,-9.99616872610076e-06,-9.22762782851194e-06,-8.51817494318397e-06,-7.86326731505582e-06,-7.25871118767429e-06,-6.70063549090827e-06,-6.18546658337493e-06,-5.70990577042352e-06,-5.27090765478633e-06,-4.86566126278731e-06,-4.49157172566217e-06,-4.14624351519066e-06,-3.82746534466349e-06,-3.53319595802759e-06,-3.26155102925441e-06,-3.01079122744241e-06,-2.77931067049764e-06,-2.56562721068221e-06,-2.36837244260713e-06,-2.18628343207072e-06,-2.01819394529679e-06,-1.86302789861870e-06,-1.71979158691826e-06,-1.58756768842139e-06,-1.46550976909410e-06,-1.35283600988245e-06,-1.24882504337620e-06,-1.15281084678287e-06,-1.06417857859142e-06,-9.82360637280522e-07,-9.06833164115994e-07,-8.37112490437164e-07,-7.72752251076980e-07,-7.13340275737551e-07,-6.58496035477185e-07,-6.07868477775497e-07,-5.61133306486994e-07,-5.17991372017690e-07,-4.78166284345605e-07,-4.41403136264285e-07,-4.07466393959055e-07,-3.76138953317451e-07,-3.47219974994317e-07,-3.20524440322600e-07,-2.95881374956508e-07,-2.73132960693090e-07,-2.52133425249212e-07,-2.32748542661199e-07,-2.14853967950290e-07,-1.98335237122649e-07,-1.83086434901725e-07,-1.69010139217107e-07,-1.56016033425743e-07,-1.44020906311937e-07,-1.32948041464687e-07,-1.22726551143870e-07,-1.13290876679883e-07,-1.04580621940187e-07,-9.65401647512465e-08,-8.91177132089638e-08,-8.22660828347921e-08,-7.59411422635026e-08,-7.01024793769989e-08,-6.47127906816536e-08,-5.97374372190984e-08,-5.51446110996778e-08,-5.09048359020881e-08,-4.69911332068307e-08,-4.33783009512467e-08,-4.00431909852728e-08,-3.69644870268360e-08,-3.41225381284005e-08,-3.14990811212113e-08,-2.90773516375964e-08,-2.68417510440599e-08,-2.47780684858867e-08};
 float vel_track_d2[500]={0.000926402592348742,0.000964210408819274,0.00100356062501172,0.00104451637958505,0.00108714365469811,0.00113151218039839,0.00117768871438769,0.00122575122820875,0.00127577570070294,0.00132784100291168,0.00138203097639661,0.00143843267366085,0.00149713640343542,0.00155823619523914,0.00162182801663047,0.00168801640431074,0.00175690571159570,0.00182860698389003,0.00190323331427641,0.00198090566957730,0.00206174772961314,0.00214588978364046,0.00223346489977927,0.00232461470426790,0.00241948378523031,0.00251822449740144,0.00262099561319237,0.00272796041331882,0.00283929035593024,0.00295516406186330,0.00307576688163723,0.00320129078155885,0.00333193826926320,0.00346791721449809,0.00360944549892915,0.00375674983930695,0.00391006552843977,0.00406963854684414,0.00423572355075261,0.00440858648536960,0.00458850477365373,0.00477576459976816,0.00497066746518475,0.00517352423590043,0.00538465977738397,0.00560441178751938,0.00583313215859205,0.00607118669537394,0.00631895646527182,0.00657683793405436,0.00684524372841972,0.00712460317318046,0.00741536377327060,0.00771799038352345,0.00803296741838801,0.00836079879699842,0.00870200933828966,0.00905714492252676,0.00942677369584886,0.00981148737899115,0.0102119016887684,0.0106286568003651,0.0110624201599191,0.0115138857820915,0.0119837758609321,0.0124728425097064,0.0129818683148951,0.0135116678113467,0.0140630885827094,0.0146370133916958,0.0152343602179167,0.0158560852842531,0.0165031831245425,0.0171766895373272,0.0178776819567894,0.0186072823779486,0.0193666580314406,0.0201570241437262,0.0209796454620988,0.0218358383393443,0.0227269726184263,0.0236544744878681,0.0246198280466847,0.0256245777760113,0.0266703315659614,0.0277587628600586,0.0288916130846690,0.0300706949642894,0.0312978952161997,0.0325751774165506,0.0339045852929733,0.0352882460730578,0.0367283735982784,0.0382272722134684,0.0397873401316153,0.0414110735130694,0.0431010703174808,0.0448600344572941,0.0466907803112072,0.0485962368506822,0.0505794527160377,0.0526436007255880,0.0547919833453359,0.0570280375731466,0.0593553406683207,0.0617776157125992,0.0642987377635230,0.0669227397846741,0.0696538192421939,0.0724963447856723,0.0754548631819521,0.0785341064786700,0.0817389997800348,0.0850746688422000,0.0885464483631774,0.0921598905217831,0.0959207736495622,0.0998351115844578,0.103909163132914,0.108149442063190,0.112562727427418,0.117156074301421,0.121936824995481,0.126912620726049,0.132091413622095,0.137481479381149,0.143091430283095,0.148930228874918,0.155007201992850,0.161332055540868,0.167914889718396,0.174766214846394,0.181896967926654,0.189318529662892,0.197042742356416,0.205081928253918,0.213448908774643,0.222157024426748,0.231220155422424,0.240652743069396,0.250469812107603,0.260686993625662,0.271320549016087,0.282387394723381,0.293905127845857,0.305892052738572,0.318367208402171,0.331350396994253,0.344862213130286,0.358924074259269,0.373558252014778,0.388787904506202,0.404637109693132,0.421130899660848,0.438295295986053,0.456157345991136,0.474745160050064,0.494087949756090,0.514216067064581,0.535161044208090,0.556955634494177,0.579633853791851,0.603231022635826,0.627783808909137,0.653330270895928,0.679909900611723,0.707563667193840,0.736334060186167,0.766265132425750,0.797402542288772,0.829793594979440,0.863487282430887,0.898534321469822,0.934987189675503,0.972900158419027,1.01232932245468,1.05333262526541,1.09596987941537,1.14030278093775,1.18639491668125,1.23431176345458,1.28412067761089,1.33589087354693,1.38969338942066,1.44560103821323,1.50368834194953,1.56403144676454,1.62670801611373,1.69179709923387,1.75937897154986,1.82953494346484,1.90234713351785,1.97789820156553,2.05627103716908,2.13754839796265,2.22181249229776,2.30914449998978,2.39962402449784,2.49332846941348,2.59033233164606,2.69070640325882,2.79451687352657,2.90182432248873,3.01268259699607,3.12713756026910,3.24522570597983,3.36697262830088,3.49239133989256,3.62148043084567,3.75422206293817,3.89057979550583,4.03049624174830,4.17389055748652,4.32065576845886,4.47065594715737,4.62372325619095,4.77965488222683,4.93820989279969,5.09910605775671,5.26201668777243,5.42656755419779,5.59233396734526,5.75883810389749,5.92554668814663,6.09186914567633,6.25715636126553,6.42070018440788,6.58173383487010,6.73943336609417,6.89292034458650,7.04126589750265,7.18349626695480,7.31859998693687,7.44553676611362,7.56324811633718,7.67066971257194,7.76674540539363,7.85044273386287,7.92076970666733,7.97679253639072,8.01765392990805,8.04259146237069,8.05095549873058,8.04222608104627,8.01602817742891,7.97214469398350,7.91052668758885,7.83130028602375,7.73476992157768,7.62141761125018,7.49189816483753,7.34703036348089,7.18778431599099,7.01526535813823,6.83069500106703,6.63538955007126,6.43073709721914,6.21817363626226,5.99915905439752,5.77515372411430,5.54759635358926,5.31788366201386,5.08735233444957,4.85726358755806,4.62879055104098,4.40300854731712,4.18088824010499,3.96329152588271,3.75096996371388,3.54456548006105,3.34461304596456,3.15154500307091,2.96569671042113,2.78731319294412,2.61655649235576,2.45351344870909,2.29820367339562,2.15058750955111,2.01057381151015,1.87802740955845,1.75277615856406,1.63461749829386,1.52332447888770,1.41865122683804,1.32033784496710,1.22811475444762,1.14170649819578,1.06083503332677,0.985222546177278,0.914593827088361,0.848678244054102,0.787211354850270,0.729936196662173,0.676604290822391,0.626976398256263,0.580823058847768,0.537924945300472,0.498073059334025,0.461068795309161,0.426723893689807,0.394860304179678,0.365309975961847,0.337914590223143,0.312525248093110,0.289002125267834,0.267214102907754,0.247038382910292,0.228360094338909,0.211071896621839,0.195073584129069,0.180271695854106,0.166579133168421,0.153914787970666,0.142203183000622,0.131374125619921,0.121362375968270,0.112107330083933,0.103552718298316,0.0956463190009416,0.0883396876875109,0.0815879010647169,0.0753493158672791,0.0695853419643289,0.0642602292574290,0.0593408678348784,0.0547966008088707,0.0505990492465358,0.0467219485936754,0.0431409959948947,0.0398337079094979,0.0367792874452766,0.0339585008394261,0.0313535625359185,0.0289480283282018,0.0267266960636281,0.0246755134178933,0.0227814922812986,0.0210326293198504,0.0194178322919791,0.0179268517334075,0.0165502176395771,0.0152791807982444,0.0141056584476162,0.0130221839549360,0.0120218602266409,0.0110983165890755,0.0102456688819697,0.00945848253997017,0.00873173843840558,0.00806080130599796,0.00744139051223058,0.00686955305884140,0.00634163860713244,0.00585427639565594,0.00540435390339322,0.00498899713052836,0.00460555237602467,0.00425156939765081,0.00392478585364842,0.00362311292723128,0.00334462204676367,0.00308753261701877,0.00285020068635511,0.00263110847886772,0.00242885472567789,0.00224214573485426,0.00206978714356598,0.00191067630150865,0.00176379523619818,0.00162820415816611,0.00150303545998209,0.00138748818023782,0.00128082288575193,0.00118235695012459,0.00109146019233730,0.00100755085019610,0.000930091862194615,0.000858587434926506,0.000792579873953869,0.000731646656815244,0.000675397732075034,0.000623473024541354,0.000575540132552455,0.000531292202010647,0.000490445962841868,0.000452739918110900,0.000417932669583010,0.000385801373958827,0.000356140317681053,0.000328759598766659,0.000303483913666192,0.000280151433496023,0.000258612769976629,0.000238730017976252,0.000220375874215861,0.000203432820589100,0.000187792374206630,0.000173354391175273,0.000160026426110349,0.000147723141052936,0.000136365758129919,0.000125881555623764,0.000116203403011106,0.000107269329974180,9.90221310503969e-05,9.14089979264787e-05,8.43811830408825e-05,7.78936858347734e-05,7.19049658703952e-05,6.63766758224327e-05,6.12734170069018e-05,5.65625122295188e-05,5.22137959535485e-05,4.81994224532656e-05,4.44936867349810e-05,4.10728595579002e-05,3.79150368878811e-05,3.49999975668425e-05,3.23090761922273e-05,2.98250417696266e-05,2.75319880227443e-05,2.54152321410572e-05,2.34612196337025e-05,2.16574380651480e-05,1.99923374522015e-05,1.84552556570239e-05,1.70363498863679e-05,1.57265346301116e-05,1.45174223753486e-05,1.34012709818165e-05,1.23709331667499e-05,1.14198115408470e-05,1.05418153095727e-05,9.73132252557463e-06,8.98314345132434e-06,8.29248703038132e-06,7.65493068932699e-06,7.06639191605518e-06,6.52310205850881e-06,6.02158245488482e-06,5.55862134099527e-06,5.13125442136442e-06,4.73674488521425e-06,4.37256686414145e-06,4.03638789059357e-06,3.72605579723739e-06,3.43958317383652e-06,3.17513537684278e-06,2.93101953818820e-06,2.70567201976490e-06,2.49765008675240e-06,2.30562169356574e-06,2.12835715718285e-06,1.96472127456104e-06,1.81366632823199e-06,1.67422498087433e-06,1.54550450215396e-06,1.42668055147510e-06,1.31699207095437e-06,1.21573695555099e-06,1.12226661297399e-06,1.03598274403538e-06,9.56332568691209e-07,8.82806272528569e-07,8.14932787918110e-07,7.52277906634902e-07,6.94439949988635e-07,6.41048880645201e-07,5.91762749913016e-07,5.46265921386180e-07,5.04266850498425e-07,4.65497085322397e-07,4.29707935900581e-07,3.96670474245298e-07,3.66172869803449e-07,3.38020278434215e-07,3.12032066851486e-07,2.88041812623874e-07,2.65896082929373e-07,2.45453102287740e-07,2.26581753359767e-07,2.09161243880374e-07,1.93080329502493e-07,1.78235426417928e-07,1.64532165669584e-07,1.51882284527005e-07,1.40204958753998e-07,1.29425581363307e-07,1.19474874438197e-07,1.10289222199356e-07,1.01809671804176e-07,9.39822664136614e-08,8.67566019024935e-08,8.00863819705455e-08,7.39289740536719e-08,6.82450762568010e-08,6.29981622424225e-08,5.81547032751928e-08,5.36835020881199e-08,4.95561369717734e-08};
 //*********velocity desired arry***********//
float time_vectt=0;


/*********fxn var***********/
float d_theta1=0;
float d_theta2=0;
float vd_theta1=0;
float vd_theta2=0;
/*********fxn var***********/

/*********Osake Brewers*******/
float integral1 = 0;
float integral2 = 0;
/*********Osake Brewers*******/
/* USER CODE END PV */

/* Private function prototypes -----------------------------------------------*/
void SystemClock_Config(void);
static void MX_GPIO_Init(void);
static void MX_ADC1_Init(void);
static void MX_ADC2_Init(void);
static void MX_TIM3_Init(void);
static void MX_TIM4_Init(void);
static void MX_TIM5_Init(void);
static void MX_USART3_UART_Init(void);
static void MX_TIM9_Init(void);
/* USER CODE BEGIN PFP */

/* USER CODE END PFP */

/* Private user code ---------------------------------------------------------*/
/* USER CODE BEGIN 0 */
#include"impl_tsk.h"

int _write(int file, char *ptr, int len){

	/* Implement your write code here, this is used by puts and printf for example */
	int i=0;
	for (i=0; i<len; i++){
		ITM_SendChar((ptr++));
	}
	return len;

}

void HAL_TIM_PeriodElapsedCallback(TIM_HandleTypeDef* htim)
{
	  timeblock+=65535;
}

void Motor_control_1(int PWM,int cap) {
  if (PWM >= 0) {
    if (abs(PWM) > cap) {
      PWM = cap;
    }
    HAL_GPIO_WritePin(GPIOD, GPIO_PIN_12, GPIO_PIN_RESET);
    TIM4->CCR3 = abs(PWM);
    HAL_TIM_PWM_Start(&htim4, TIM_CHANNEL_3);
  }
  else if (PWM < 0) {
    if (abs(PWM) > cap) {
      PWM = cap;
    }
    HAL_GPIO_WritePin(GPIOD, GPIO_PIN_12, GPIO_PIN_SET);
    TIM4->CCR3 = abs(PWM);
	HAL_TIM_PWM_Start(&htim4, TIM_CHANNEL_3);
  }
}

void Motor_control_2(int PWM,int cap) {
  if (PWM >= 0) {
    if (abs(PWM) > cap) {
      PWM = cap;
    }
    HAL_GPIO_WritePin(GPIOD, GPIO_PIN_13, GPIO_PIN_SET);
    TIM4->CCR4 = abs(PWM);
    HAL_TIM_PWM_Start(&htim4, TIM_CHANNEL_4);
  }
  else if (PWM < 0) {
    if (abs(PWM) > cap) {
      PWM = cap;
    }
    HAL_GPIO_WritePin(GPIOD, GPIO_PIN_13, GPIO_PIN_RESET);
    TIM4->CCR4 = abs(PWM);
	HAL_TIM_PWM_Start(&htim4, TIM_CHANNEL_4);
  }
}
/* USER CODE END 0 */

/**
  * @brief  The application entry point.
  * @retval int
  */
int main(void)
{
  /* USER CODE BEGIN 1 */
	char msg[10];
  /* USER CODE END 1 */

  /* MCU Configuration--------------------------------------------------------*/

  /* Reset of all peripherals, Initializes the Flash interface and the Systick. */
  HAL_Init();

  /* USER CODE BEGIN Init */

  /* USER CODE END Init */

  /* Configure the system clock */
  SystemClock_Config();

  /* USER CODE BEGIN SysInit */
  ITM_Port32(31)=1;
  /* USER CODE END SysInit */

  /* Initialize all configured peripherals */
  MX_GPIO_Init();
  MX_ADC1_Init();
  MX_ADC2_Init();
  MX_TIM3_Init();
  MX_TIM4_Init();
  MX_TIM5_Init();
  MX_USART3_UART_Init();
  MX_TIM9_Init();
  /* USER CODE BEGIN 2 */
  ITM_Port32(31) = 2;

  HAL_TIM_Encoder_Start_IT(&htim3, TIM_CHANNEL_ALL);
    HAL_TIM_Encoder_Start_IT(&htim5, TIM_CHANNEL_ALL);
    HAL_TIM_Base_Start_IT(&htim9);
  //set timer to some intial value to remove the bounce
    TIM3->CNT=32767;
    TIM5->CNT=32767;

    for(int i=0;i<200;i++){
    	  HAL_ADC_Start(&hadc1);
    	  HAL_ADC_PollForConversion(&hadc1, HAL_MAX_DELAY);
    	  raw = HAL_ADC_GetValue(&hadc1);
    	  inivolt+=(raw*3.3/ 4096);
      }
      inivolt=inivolt/200;

      for(int i=0;i<200;i++){
       	  HAL_ADC_Start(&hadc2);
       	  HAL_ADC_PollForConversion(&hadc2, HAL_MAX_DELAY);
       	  raw = HAL_ADC_GetValue(&hadc2);
       	  inivolt2+=(raw*3.3/ 4096);
	 }
	 inivolt2=inivolt2/200;

  /* USER CODE END 2 */

  /* Infinite loop */
  /* USER CODE BEGIN WHILE */
  while (1)
  {
    /* USER CODE END WHILE */

    /* USER CODE BEGIN 3 */

////////////////////////////////////////////////current_start//////////////////////////////////////////////
//cuiwali motor2
// ADC conversion
	HAL_ADC_Start(&hadc1);
	HAL_ADC_PollForConversion(&hadc1, HAL_MAX_DELAY);
	raw = HAL_ADC_GetValue(&hadc1);
	volt=(raw*3.3/ 4096);
	current2=(inivolt-volt)*10  + 0.2;
// Kalman Filtering
	old_estimate2=estimate2;
    measurement2=current2; // current measurement
    kalman_gain2= estimate_variance2/(estimate_variance2+measurement_variance2); // Kalman gain
    estimate2=estimate2 + kalman_gain2*(measurement2-estimate2); // update in estimate
    estimate_variance2=(1-kalman_gain2)*(estimate_variance2) + fabs(old_estimate2-estimate2)*estimate_measurement_weight2;  //update in estimate variance


// control loop
	  E_rror_m2 = D_current2 - estimate2;
	  P_wm_m2=kp2*E_rror_m2;
	  Motor_control_2(P_wm_m2,1000);



//robokits motor1
// ADC conversion
	HAL_ADC_Start(&hadc2);
	HAL_ADC_PollForConversion(&hadc2, HAL_MAX_DELAY);
	raw2 = HAL_ADC_GetValue(&hadc2);
	volt2=(raw2*3.3/ 4096);
	current=(inivolt2-volt2)*10;
// Kalman Filtering
	old_estimate=estimate;
    measurement=current; // current measurement
    kalman_gain= estimate_variance/(estimate_variance+measurement_variance); // Kalman gain
    estimate=estimate + kalman_gain*(measurement-estimate); // update in estimate
	estimate_variance=(1-kalman_gain)*(estimate_variance) + fabs(old_estimate-estimate)*estimate_measurement_weight;  //update in estimate
// control loop
	  E_rror_m1 = D_current - estimate;
	  P_wm_m1=kp*E_rror_m1;
	  Motor_control_1(P_wm_m1,1000);
////////////////////////////////////////////////current_end//////////////////////////////////////////////
////////////////////////////////////////////////th and thdot_start///////////////////////////////////////
//read encoder
	  raw_enc1=(TIM3->CNT);
	  raw_enc2=(TIM5->CNT);
	if(raw_enc1 != prev_enc1){
		real_enc1+=(raw_enc1-prev_enc1);
		prev_enc1=raw_enc1;
	}
	if(raw_enc2 != prev_enc2){
		real_enc2+=(raw_enc2-prev_enc2);
		prev_enc2=raw_enc2;
	}

	  eth2=(real_enc1/(2*4096))*6.28;
	  eth1=-(real_enc2/2000)*6.28;

	  th1=eth1+ spth1;
	  th2=eth2-th1+spth2 + spth1;


	  //////////////th_dot
	  now_time=__HAL_TIM_GET_COUNTER(&htim9)+timeblock;
	  D_t=now_time-prev_time;
	  DE_rrorm1=((th1-prev_th1)/D_t)*10E6;
	  DE_rrorm2=((th2-prev_th2)/D_t)*10E6;

	  prev_th1=th1;
	  prev_th2=th2;
	  prev_time=now_time;


	  // Kalman Filtering
		old_estimate3=estimate3;
		measurement3=DE_rrorm1; // current measurement
		kalman_gain3= estimate_variance3/(estimate_variance3+measurement_variance3); // Kalman gain
		estimate3=estimate3 + kalman_gain3*(measurement3-estimate3); // update in estimate
		estimate_variance3=(1-kalman_gain3)*(estimate_variance3) + fabs(old_estimate3-estimate3)*estimate_measurement_weight3;  //update in estimate variance

		// Kalman Filtering
		old_estimate4=estimate4;
		measurement4=DE_rrorm2; // current measurement
		kalman_gain4= estimate_variance4/(estimate_variance4+measurement_variance4); // Kalman gain
		estimate4=estimate4 + kalman_gain4*(measurement4-estimate4); // update in estimate
		estimate_variance4=(1-kalman_gain4)*(estimate_variance4) + fabs(old_estimate4-estimate4)*estimate_measurement_weight4;  //update in estimate variance

////////////////////////////////////////////////th and thdot_end///////////////////////////////////////

/////////////////////////////////tracj_sec_strt////////////////////////////////////////////////////
		data+=0.01;
	    arr_indx=data;
	    time_vectt+=0.002*arr_indx;

////////////////////////////////////////////////////////////////////////////////////////////////

//	  D_current= (1*(thd1-th1))*10+ (vel_DError_d1-estimate3)*0.000;
//	  D_current2= (1*(thd2-th2))*10 +(vel_DError_d2-estimate4)*0.000;

/////////////////////////////////tracj_sec_clsd////////////////////////////////////////////////////
	  sprintf(msg, "%d\r\n",arr_indx);
	  HAL_UART_Transmit(&huart3, (uint8_t*)msg, strlen(msg), HAL_MAX_DELAY);

////*************************implementation tsk1**************************//
//	  /* Point control + PID Tuning */
//	  if (now_time - last_hlc_execute_time > 1E3)
//	  {
//		  integral1 += (thd1 - th1) * D_t * 10E-6;
//		  D_current = 10.0 * (thd1-th1) + 1.5 * integral1; //+ 0.0001 * (vel_DError_d1-estimate3);
//
//		  integral2 += (thd2 - th2) * D_t * 10E-6;
//		  D_current2 = 1.5 * (thd2-th2) + 0.5 * integral2; //+ 0.0001 * (vel_DError_d2-estimate4);
//
//		  last_hlc_execute_time = now_time;
//	  }

	  /* Trajectory control */
	  if (arr_indx < 500)
	  {
		  if (now_time - last_hlc_execute_time > 10E3)
		  {
			  thd1=thd1_trac[arr_indx];
			  thd2=thd2_trac[arr_indx];

			  integral1 += (thd1 - th1) * D_t * 10E-6;
			  D_current = 10.0 * (thd1-th1) + 1.5 * integral1; //+ 0.0001 * (vel_DError_d1-estimate3);

			  integral2 += (thd2 - th2) * D_t * 10E-6;
			  D_current2 = 1.5 * (thd2-th2) + 0.5 * integral2; //+ 0.0001 * (vel_DError_d2-estimate4);

			  last_hlc_execute_time = now_time;
		  }
	  }

////*************************implementation tsk1 end**************************//


	  if (arr_indx >= 500 && arr_indx < 600)
	  {
		  if (now_time - last_hlc_execute_time > 10E3)
		  {
			  D_current = 0.99 * D_current;
			  D_current2 = 0.99 * D_current2;
			  last_hlc_execute_time = now_time;
		  }
	  }

//*************************implementation tsk2**************************//

	  /* Spring */
	  F[0] = - 50.0 * ((0.1 * cos(th1) + 0.1 * cos(th1 + th2)) - (0.1 * cos(thd1) + 0.1 * cos(thd1 + thd2)));
	  F[1] = - 50.0 * ((0.1 * sin(th1) + 0.1 * sin(th1 + th2)) - (0.1 * sin(thd1) + 0.1 * sin(thd1 + thd2)));

	  if (arr_indx >= 600)
	  {
		  if (now_time - last_hlc_execute_time > 10E3)
		  {
			  float abs_th2 = th1 + th2;

			  J_T[0][0] = - 0.1 * sin(th1);
			  J_T[0][1] =   0.1 * cos(th1);
			  J_T[1][0] = - 0.1 * sin(abs_th2);
			  J_T[1][1] =   0.1 * cos(abs_th2);

			  D_current  = 0.4 * 10. * (J_T[0][0] * F[0] + J_T[0][1] * F[1]);
			  D_current2 = 0.4 * 10. * (J_T[1][0] * F[0] + J_T[1][1] * F[1]);

			  last_hlc_execute_time = now_time;
		  }
	  }

////*************************implementation tsk2 end**************************//
//
	  if (D_current  > 4.0) D_current  = 4.0;
	  if (D_current  <-4.0) D_current  =-4.0;
	  if (D_current2 > 4.0) D_current2 = 4.0;
	  if (D_current2 <-4.0) D_current2 =-4.0;
//	  D_current=1.5;
//	  D_current2=1.5;

	  ////////////////////////////test zone///////////////////////////
//	  Motor_control_1(-100,800);
//	  Motor_control_2(100,800);
//	  D_current=0;//m1
//	  D_current2=0;//m2
//    D_current= (1*(0-th1))*10;
//    D_current2= (1*(0-th2))*10;
	  ////////////////////////////test zone///////////////////////////

  }
  /* USER CODE END 3 */
}

/**
  * @brief System Clock Configuration
  * @retval None
  */
void SystemClock_Config(void)
{
  RCC_OscInitTypeDef RCC_OscInitStruct = {0};
  RCC_ClkInitTypeDef RCC_ClkInitStruct = {0};

  /** Configure the main internal regulator output voltage
  */
  __HAL_RCC_PWR_CLK_ENABLE();
  __HAL_PWR_VOLTAGESCALING_CONFIG(PWR_REGULATOR_VOLTAGE_SCALE1);

  /** Initializes the RCC Oscillators according to the specified parameters
  * in the RCC_OscInitTypeDef structure.
  */
  RCC_OscInitStruct.OscillatorType = RCC_OSCILLATORTYPE_HSE;
  RCC_OscInitStruct.HSEState = RCC_HSE_ON;
  RCC_OscInitStruct.PLL.PLLState = RCC_PLL_ON;
  RCC_OscInitStruct.PLL.PLLSource = RCC_PLLSOURCE_HSE;
  RCC_OscInitStruct.PLL.PLLM = 8;
  RCC_OscInitStruct.PLL.PLLN = 336;
  RCC_OscInitStruct.PLL.PLLP = RCC_PLLP_DIV2;
  RCC_OscInitStruct.PLL.PLLQ = 7;
  if (HAL_RCC_OscConfig(&RCC_OscInitStruct) != HAL_OK)
  {
    Error_Handler();
  }

  /** Initializes the CPU, AHB and APB buses clocks
  */
  RCC_ClkInitStruct.ClockType = RCC_CLOCKTYPE_HCLK|RCC_CLOCKTYPE_SYSCLK
                              |RCC_CLOCKTYPE_PCLK1|RCC_CLOCKTYPE_PCLK2;
  RCC_ClkInitStruct.SYSCLKSource = RCC_SYSCLKSOURCE_PLLCLK;
  RCC_ClkInitStruct.AHBCLKDivider = RCC_SYSCLK_DIV1;
  RCC_ClkInitStruct.APB1CLKDivider = RCC_HCLK_DIV4;
  RCC_ClkInitStruct.APB2CLKDivider = RCC_HCLK_DIV2;

  if (HAL_RCC_ClockConfig(&RCC_ClkInitStruct, FLASH_LATENCY_5) != HAL_OK)
  {
    Error_Handler();
  }
}

/**
  * @brief ADC1 Initialization Function
  * @param None
  * @retval None
  */
static void MX_ADC1_Init(void)
{

  /* USER CODE BEGIN ADC1_Init 0 */

  /* USER CODE END ADC1_Init 0 */

  ADC_ChannelConfTypeDef sConfig = {0};

  /* USER CODE BEGIN ADC1_Init 1 */

  /* USER CODE END ADC1_Init 1 */

  /** Configure the global features of the ADC (Clock, Resolution, Data Alignment and number of conversion)
  */
  hadc1.Instance = ADC1;
  hadc1.Init.ClockPrescaler = ADC_CLOCK_SYNC_PCLK_DIV4;
  hadc1.Init.Resolution = ADC_RESOLUTION_12B;
  hadc1.Init.ScanConvMode = DISABLE;
  hadc1.Init.ContinuousConvMode = DISABLE;
  hadc1.Init.DiscontinuousConvMode = DISABLE;
  hadc1.Init.ExternalTrigConvEdge = ADC_EXTERNALTRIGCONVEDGE_NONE;
  hadc1.Init.ExternalTrigConv = ADC_SOFTWARE_START;
  hadc1.Init.DataAlign = ADC_DATAALIGN_RIGHT;
  hadc1.Init.NbrOfConversion = 1;
  hadc1.Init.DMAContinuousRequests = DISABLE;
  hadc1.Init.EOCSelection = ADC_EOC_SINGLE_CONV;
  if (HAL_ADC_Init(&hadc1) != HAL_OK)
  {
    Error_Handler();
  }

  /** Configure for the selected ADC regular channel its corresponding rank in the sequencer and its sample time.
  */
  sConfig.Channel = ADC_CHANNEL_14;
  sConfig.Rank = 1;
  sConfig.SamplingTime = ADC_SAMPLETIME_3CYCLES;
  if (HAL_ADC_ConfigChannel(&hadc1, &sConfig) != HAL_OK)
  {
    Error_Handler();
  }
  /* USER CODE BEGIN ADC1_Init 2 */

  /* USER CODE END ADC1_Init 2 */

}

/**
  * @brief ADC2 Initialization Function
  * @param None
  * @retval None
  */
static void MX_ADC2_Init(void)
{

  /* USER CODE BEGIN ADC2_Init 0 */

  /* USER CODE END ADC2_Init 0 */

  ADC_ChannelConfTypeDef sConfig = {0};

  /* USER CODE BEGIN ADC2_Init 1 */

  /* USER CODE END ADC2_Init 1 */

  /** Configure the global features of the ADC (Clock, Resolution, Data Alignment and number of conversion)
  */
  hadc2.Instance = ADC2;
  hadc2.Init.ClockPrescaler = ADC_CLOCK_SYNC_PCLK_DIV4;
  hadc2.Init.Resolution = ADC_RESOLUTION_12B;
  hadc2.Init.ScanConvMode = DISABLE;
  hadc2.Init.ContinuousConvMode = DISABLE;
  hadc2.Init.DiscontinuousConvMode = DISABLE;
  hadc2.Init.ExternalTrigConvEdge = ADC_EXTERNALTRIGCONVEDGE_NONE;
  hadc2.Init.ExternalTrigConv = ADC_SOFTWARE_START;
  hadc2.Init.DataAlign = ADC_DATAALIGN_RIGHT;
  hadc2.Init.NbrOfConversion = 1;
  hadc2.Init.DMAContinuousRequests = DISABLE;
  hadc2.Init.EOCSelection = ADC_EOC_SINGLE_CONV;
  if (HAL_ADC_Init(&hadc2) != HAL_OK)
  {
    Error_Handler();
  }

  /** Configure for the selected ADC regular channel its corresponding rank in the sequencer and its sample time.
  */
  sConfig.Channel = ADC_CHANNEL_8;
  sConfig.Rank = 1;
  sConfig.SamplingTime = ADC_SAMPLETIME_3CYCLES;
  if (HAL_ADC_ConfigChannel(&hadc2, &sConfig) != HAL_OK)
  {
    Error_Handler();
  }
  /* USER CODE BEGIN ADC2_Init 2 */

  /* USER CODE END ADC2_Init 2 */

}

/**
  * @brief TIM3 Initialization Function
  * @param None
  * @retval None
  */
static void MX_TIM3_Init(void)
{

  /* USER CODE BEGIN TIM3_Init 0 */

  /* USER CODE END TIM3_Init 0 */

  TIM_Encoder_InitTypeDef sConfig = {0};
  TIM_MasterConfigTypeDef sMasterConfig = {0};

  /* USER CODE BEGIN TIM3_Init 1 */

  /* USER CODE END TIM3_Init 1 */
  htim3.Instance = TIM3;
  htim3.Init.Prescaler = 0;
  htim3.Init.CounterMode = TIM_COUNTERMODE_UP;
  htim3.Init.Period = 65535;
  htim3.Init.ClockDivision = TIM_CLOCKDIVISION_DIV1;
  htim3.Init.AutoReloadPreload = TIM_AUTORELOAD_PRELOAD_DISABLE;
  sConfig.EncoderMode = TIM_ENCODERMODE_TI1;
  sConfig.IC1Polarity = TIM_ICPOLARITY_RISING;
  sConfig.IC1Selection = TIM_ICSELECTION_DIRECTTI;
  sConfig.IC1Prescaler = TIM_ICPSC_DIV1;
  sConfig.IC1Filter = 0;
  sConfig.IC2Polarity = TIM_ICPOLARITY_RISING;
  sConfig.IC2Selection = TIM_ICSELECTION_DIRECTTI;
  sConfig.IC2Prescaler = TIM_ICPSC_DIV1;
  sConfig.IC2Filter = 0;
  if (HAL_TIM_Encoder_Init(&htim3, &sConfig) != HAL_OK)
  {
    Error_Handler();
  }
  sMasterConfig.MasterOutputTrigger = TIM_TRGO_RESET;
  sMasterConfig.MasterSlaveMode = TIM_MASTERSLAVEMODE_DISABLE;
  if (HAL_TIMEx_MasterConfigSynchronization(&htim3, &sMasterConfig) != HAL_OK)
  {
    Error_Handler();
  }
  /* USER CODE BEGIN TIM3_Init 2 */

  /* USER CODE END TIM3_Init 2 */

}

/**
  * @brief TIM4 Initialization Function
  * @param None
  * @retval None
  */
static void MX_TIM4_Init(void)
{

  /* USER CODE BEGIN TIM4_Init 0 */

  /* USER CODE END TIM4_Init 0 */

  TIM_MasterConfigTypeDef sMasterConfig = {0};
  TIM_OC_InitTypeDef sConfigOC = {0};

  /* USER CODE BEGIN TIM4_Init 1 */

  /* USER CODE END TIM4_Init 1 */
  htim4.Instance = TIM4;
  htim4.Init.Prescaler = 84;
  htim4.Init.CounterMode = TIM_COUNTERMODE_UP;
  htim4.Init.Period = 1000;
  htim4.Init.ClockDivision = TIM_CLOCKDIVISION_DIV1;
  htim4.Init.AutoReloadPreload = TIM_AUTORELOAD_PRELOAD_DISABLE;
  if (HAL_TIM_PWM_Init(&htim4) != HAL_OK)
  {
    Error_Handler();
  }
  sMasterConfig.MasterOutputTrigger = TIM_TRGO_RESET;
  sMasterConfig.MasterSlaveMode = TIM_MASTERSLAVEMODE_DISABLE;
  if (HAL_TIMEx_MasterConfigSynchronization(&htim4, &sMasterConfig) != HAL_OK)
  {
    Error_Handler();
  }
  sConfigOC.OCMode = TIM_OCMODE_PWM1;
  sConfigOC.Pulse = 0;
  sConfigOC.OCPolarity = TIM_OCPOLARITY_HIGH;
  sConfigOC.OCFastMode = TIM_OCFAST_DISABLE;
  if (HAL_TIM_PWM_ConfigChannel(&htim4, &sConfigOC, TIM_CHANNEL_3) != HAL_OK)
  {
    Error_Handler();
  }
  if (HAL_TIM_PWM_ConfigChannel(&htim4, &sConfigOC, TIM_CHANNEL_4) != HAL_OK)
  {
    Error_Handler();
  }
  /* USER CODE BEGIN TIM4_Init 2 */

  /* USER CODE END TIM4_Init 2 */
  HAL_TIM_MspPostInit(&htim4);

}

/**
  * @brief TIM5 Initialization Function
  * @param None
  * @retval None
  */
static void MX_TIM5_Init(void)
{

  /* USER CODE BEGIN TIM5_Init 0 */

  /* USER CODE END TIM5_Init 0 */

  TIM_Encoder_InitTypeDef sConfig = {0};
  TIM_MasterConfigTypeDef sMasterConfig = {0};

  /* USER CODE BEGIN TIM5_Init 1 */

  /* USER CODE END TIM5_Init 1 */
  htim5.Instance = TIM5;
  htim5.Init.Prescaler = 0;
  htim5.Init.CounterMode = TIM_COUNTERMODE_UP;
  htim5.Init.Period = 65535;
  htim5.Init.ClockDivision = TIM_CLOCKDIVISION_DIV1;
  htim5.Init.AutoReloadPreload = TIM_AUTORELOAD_PRELOAD_DISABLE;
  sConfig.EncoderMode = TIM_ENCODERMODE_TI1;
  sConfig.IC1Polarity = TIM_ICPOLARITY_RISING;
  sConfig.IC1Selection = TIM_ICSELECTION_DIRECTTI;
  sConfig.IC1Prescaler = TIM_ICPSC_DIV1;
  sConfig.IC1Filter = 0;
  sConfig.IC2Polarity = TIM_ICPOLARITY_RISING;
  sConfig.IC2Selection = TIM_ICSELECTION_DIRECTTI;
  sConfig.IC2Prescaler = TIM_ICPSC_DIV1;
  sConfig.IC2Filter = 0;
  if (HAL_TIM_Encoder_Init(&htim5, &sConfig) != HAL_OK)
  {
    Error_Handler();
  }
  sMasterConfig.MasterOutputTrigger = TIM_TRGO_RESET;
  sMasterConfig.MasterSlaveMode = TIM_MASTERSLAVEMODE_DISABLE;
  if (HAL_TIMEx_MasterConfigSynchronization(&htim5, &sMasterConfig) != HAL_OK)
  {
    Error_Handler();
  }
  /* USER CODE BEGIN TIM5_Init 2 */

  /* USER CODE END TIM5_Init 2 */

}

/**
  * @brief TIM9 Initialization Function
  * @param None
  * @retval None
  */
static void MX_TIM9_Init(void)
{

  /* USER CODE BEGIN TIM9_Init 0 */

  /* USER CODE END TIM9_Init 0 */

  TIM_ClockConfigTypeDef sClockSourceConfig = {0};

  /* USER CODE BEGIN TIM9_Init 1 */

  /* USER CODE END TIM9_Init 1 */
  htim9.Instance = TIM9;
  htim9.Init.Prescaler = 168;
  htim9.Init.CounterMode = TIM_COUNTERMODE_UP;
  htim9.Init.Period = 0xffff-1;
  htim9.Init.ClockDivision = TIM_CLOCKDIVISION_DIV1;
  htim9.Init.AutoReloadPreload = TIM_AUTORELOAD_PRELOAD_DISABLE;
  if (HAL_TIM_Base_Init(&htim9) != HAL_OK)
  {
    Error_Handler();
  }
  sClockSourceConfig.ClockSource = TIM_CLOCKSOURCE_INTERNAL;
  if (HAL_TIM_ConfigClockSource(&htim9, &sClockSourceConfig) != HAL_OK)
  {
    Error_Handler();
  }
  /* USER CODE BEGIN TIM9_Init 2 */

  /* USER CODE END TIM9_Init 2 */

}

/**
  * @brief USART3 Initialization Function
  * @param None
  * @retval None
  */
static void MX_USART3_UART_Init(void)
{

  /* USER CODE BEGIN USART3_Init 0 */

  /* USER CODE END USART3_Init 0 */

  /* USER CODE BEGIN USART3_Init 1 */

  /* USER CODE END USART3_Init 1 */
  huart3.Instance = USART3;
  huart3.Init.BaudRate = 115200;
  huart3.Init.WordLength = UART_WORDLENGTH_8B;
  huart3.Init.StopBits = UART_STOPBITS_1;
  huart3.Init.Parity = UART_PARITY_NONE;
  huart3.Init.Mode = UART_MODE_TX_RX;
  huart3.Init.HwFlowCtl = UART_HWCONTROL_NONE;
  huart3.Init.OverSampling = UART_OVERSAMPLING_16;
  if (HAL_UART_Init(&huart3) != HAL_OK)
  {
    Error_Handler();
  }
  /* USER CODE BEGIN USART3_Init 2 */

  /* USER CODE END USART3_Init 2 */

}

/**
  * @brief GPIO Initialization Function
  * @param None
  * @retval None
  */
static void MX_GPIO_Init(void)
{
  GPIO_InitTypeDef GPIO_InitStruct = {0};

  /* GPIO Ports Clock Enable */
  __HAL_RCC_GPIOC_CLK_ENABLE();
  __HAL_RCC_GPIOH_CLK_ENABLE();
  __HAL_RCC_GPIOA_CLK_ENABLE();
  __HAL_RCC_GPIOB_CLK_ENABLE();
  __HAL_RCC_GPIOD_CLK_ENABLE();

  /*Configure GPIO pin Output Level */
  HAL_GPIO_WritePin(GPIOD, GPIO_PIN_12|GPIO_PIN_13, GPIO_PIN_RESET);

  /*Configure GPIO pins : PD12 PD13 */
  GPIO_InitStruct.Pin = GPIO_PIN_12|GPIO_PIN_13;
  GPIO_InitStruct.Mode = GPIO_MODE_OUTPUT_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_HIGH;
  HAL_GPIO_Init(GPIOD, &GPIO_InitStruct);

}

/* USER CODE BEGIN 4 */

/* USER CODE END 4 */

/**
  * @brief  This function is executed in case of error occurrence.
  * @retval None
  */
void Error_Handler(void)
{
  /* USER CODE BEGIN Error_Handler_Debug */
  /* User can add his own implementation to report the HAL error return state */
  __disable_irq();
  while (1)
  {
  }
  /* USER CODE END Error_Handler_Debug */
}

#ifdef  USE_FULL_ASSERT
/**
  * @brief  Reports the name of the source file and the source line number
  *         where the assert_param error has occurred.
  * @param  file: pointer to the source file name
  * @param  line: assert_param error line source number
  * @retval None
  */
void assert_failed(uint8_t *file, uint32_t line)
{
  /* USER CODE BEGIN 6 */
  /* User can add his own implementation to report the file name and line number,
     ex: printf("Wrong parameters value: file %s on line %d\r\n", file, line) */
  /* USER CODE END 6 */
}
#endif /* USE_FULL_ASSERT */
