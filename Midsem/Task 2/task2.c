/* USER CODE BEGIN Header */
/**
  ******************************************************************************
  * @file           : main.c
  * @brief          : Main program body
  ******************************************************************************
  * @attention
  *
  * Copyright (c) 2022 STMicroelectronics.
  * All rights reserved.
  *
  * This software is licensed under terms that can be found in the LICENSE file
  * in the root directory of this software component.
  * If no LICENSE file comes with this software, it is provided AS-IS.
  *
  ******************************************************************************
  */
/* USER CODE END Header */
/* Includes ------------------------------------------------------------------*/
#include "main.h"

/* Private includes ----------------------------------------------------------*/
/* USER CODE BEGIN Includes */
#include <string.h>
#include <stdio.h>
#include <math.h>
/* USER CODE END Includes */

/* Private typedef -----------------------------------------------------------*/
/* USER CODE BEGIN PTD */

/* USER CODE END PTD */

/* Private define ------------------------------------------------------------*/
/* USER CODE BEGIN PD */
/* USER CODE END PD */

/* Private macro -------------------------------------------------------------*/
/* USER CODE BEGIN PM */
#define ITM_Port32(n) (*((volatile unsigned long *)(0xE0000000+4*n)))
/* USER CODE END PM */

/* Private variables ---------------------------------------------------------*/
 ADC_HandleTypeDef hadc1;
ADC_HandleTypeDef hadc2;

TIM_HandleTypeDef htim3;
TIM_HandleTypeDef htim4;
TIM_HandleTypeDef htim5;
TIM_HandleTypeDef htim9;

UART_HandleTypeDef huart3;

/* USER CODE BEGIN PV */


///////////////////////motor_fxn///////////////////
int P_wm_m1=0;
int P_wm_m2=0;
////////th///////////////////
volatile float raw_enc1=0;
volatile float raw_enc2=0;


volatile float prev_enc1=32767;
volatile float prev_enc2=32767;

volatile float real_enc1=0;
volatile float real_enc2=0;

float eth1=0;
float eth2=0;
float th1=0;
float th2=0;

float spth1=0.6458;
float spth2=-2.2166;


float DE_rrorm1=0;
float prev_th1=0;
float vel_DError_d1=0;

float DE_rrorm2=0;
float prev_th2=0;
float vel_DError_d2=0;
/////////th dot//////////////////
/////////////////////////time_var/////////////////////
double prev_time=0;
double now_time=0;
float D_t=1E-6;
double timeblock=65535;

////////////////////kalman_dot1////////////
//Kalman Variable3
volatile float measurement3=0;
volatile float estimate3=0;
volatile float measurement_variance3=0.5;
volatile float estimate_variance3=0.3;
volatile float estimate_measurement_weight3=0.001;
volatile float kalman_gain3;
volatile float old_estimate3;

////////////////////kalman_dot2////////////
//Kalman Variable4
volatile float measurement4=0;
volatile float estimate4=0;
volatile float measurement_variance4=0.5;
volatile float estimate_variance4=0.3;
volatile float estimate_measurement_weight4=0.001;
volatile float kalman_gain4;
volatile float old_estimate4;



///////////////////////motor_fxn///////////////////
///////////////////////array_var///////////////////
float data=0;
int arr_indx=0;
///////////////////////array_var///////////////////
////////////////////////current_var////////////////////
//acs var
 uint16_t raw;
 float current=0;
 float volt=0;
 float inivolt=0;

 //Kalman Variable
 volatile float measurement=0;
 volatile float estimate=0;
 volatile float measurement_variance=0.5;
 volatile float estimate_variance=0.3;
 volatile float estimate_measurement_weight=0.001;
 volatile float kalman_gain;
 volatile float old_estimate;

 //loop var
 float E_rror_m1=0;
 float D_current = 0;
 float kp =1500;

 //acs var2
 uint16_t raw2;
 float current2=0;
 float volt2=0;
 float inivolt2=0;

 //Kalman Variable2
 volatile float measurement2=0;
 volatile float estimate2=0;
 volatile float measurement_variance2=0.5;
 volatile float estimate_variance2=0.3;
 volatile float estimate_measurement_weight2=0.001;
 volatile float kalman_gain2;
 volatile float old_estimate2;

 //loop var2
 float E_rror_m2=0;
 float D_current2 = 0;
 float kp2 =1500;
 ////////////////////////current_var////////////////////


 /////////////////////////trac_ implementation/////////////////////////


 // infintiy
 float thd1_trac[647]={-0.7331691626684769, -0.7435799822385839, -0.7539647201893519, -0.7643213459953963, -0.7746477848643577, -0.7849419177966594, -0.795201581786004, -0.8054245701653555, -0.8156086331028027, -0.825751478251338, -0.8358507715561246, -0.845904138222358, -0.8559091638462557, -0.8658633957111368, -0.8757643442498977, -0.8856094846744955, -0.8953962587723304, -0.905122076868623, -0.9147843199530983, -0.9243803419684312, -0.9339074722570615, -0.9433630181620939, -0.9527442677771327, -0.9620484928389795, -0.9712729517562727, -0.9804148927662427, -0.9894715572109227, -0.9984401829233356, -1.0073180077133825, -1.0161022729424287, -1.0247902271748996, -1.0333791298945771, -1.0418662552727265, -1.0502488959747243, -1.058524366991443, -1.0666900094813492, -1.0747431946090606, -1.0826813273659528, -1.0905018503584336, -1.0982022475495024, -1.1057800479394502, -1.113232829171768, -1.120558221050719, -1.1277539089574806, -1.1348176371522933, -1.1417472119506862, -1.1485405047625534, -1.1551954549836223, -1.1617100727296887, -1.1680824414049078, -1.1743107200963365, -1.1803931457879344, -1.186328035388207, -1.192113787566736, -1.1977488843958535, -1.2032318927947707, -1.208561465774503, -1.2137363434829633, -1.2187553540505665, -1.2236174142376874, -1.2283215298862176, -1.232866796178354, -1.2372523977066048, -1.241477608359752, -1.2455417910302584, -1.2494443971492495, -1.2531849660558068, -1.2567631242078383, -1.2601785842422606, -1.263431143892614, -1.2665206847725772, -1.2694471710341082, -1.2722106479091386, -1.2748112401438825, -1.2772491503349295, -1.2795246571762706, -1.2816381136264245, -1.2835899450047203, -1.285380647025687, -1.287010783780325, -1.288480985672836, -1.2897919473211537, -1.2909444254293434, -1.2919392366396494, -1.2927772553716583, -1.2934594116557108, -1.293986688967344, -1.294360122069199, -1.2945807948664558, -1.2946498382814857, -1.2945684281530565, -1.2943377831650307, -1.2939591628091618, -1.2934338653862059, -1.2927632260492237, -1.2919486148926225, -1.290991435090122, -1.2898931210845377, -1.2886551368319599, -1.2872789741026078, -1.2857661508403793, -1.2841182095828338, -1.2823367159431336, -1.2804232571552006, -1.2783794406831808, -1.2762068928960675, -1.2739072578082058, -1.2714821958861933, -1.2689333829225884, -1.2662625089766792, -1.2634712773824677, -1.2605614038239308, -1.2575346154775233, -1.2543926502218303, -1.2511372559142204, -1.2477701897343096, -1.2442932175940153, -1.2407081136139668, -1.2370166596660397, -1.2332206449817715, -1.2293218658264622, -1.2253221252387572, -1.221223232835578, -1.217027004682297, -1.2127352632281059, -1.2083498373066004, -1.2038725622016686, -1.1993052797788473, -1.1946498386823936, -1.1899080945984148, -1.1850819105844834, -1.1801731574662755, -1.1751837143018635, -1.170115468914395, -1.164970318494023, -1.1597501702700215, -1.1544569422541695, -1.1490925640565535, -1.1436589777750832, -1.1381581389600814, -1.1325920176554258, -1.1269625995177828, -1.1212718870155838, -1.1155219007094106, -1.1097146806155511, -1.1038522876544512, -1.09793680518586, -1.0919703406323684, -1.0859550271930223, -1.0798930256485717, -1.0737865262597521, -1.0676377507598147, -1.0614489544422163, -1.0552224283440497, -1.0489605015253614, -1.0426655434439476, -1.0363399664246002, -1.029986228220974, -1.0236068346673228, -1.0172043424162824, -1.0107813617575832, -1.004340559511093, -0.997884661985881, -0.9914164579950283, -0.984938801913635, -0.9784546167649409, -0.9719668973165404, -0.9654787131654574, -0.9589932117871648, -0.9525136215196165, -0.9460432544488756, -0.939585509158023, -0.933143873295745, -0.9267219259152124, -0.920323339527778, -0.9139518818095484, -0.9076114168921617, -0.9013059061622104, -0.8950394084868172, -0.8888160797760967, -0.8826401717867838, -0.8765160300654844, -0.8704480909250921, -0.8644408773442921, -0.8584989936781126, -0.8526271190677168, -0.8468299994404225, -0.841112437996985, -0.8354792840927985, -0.8299354204335281, -0.8244857485241536, -0.8191351723338163, -0.8138885801675142, -0.8087508247695241, -0.8037267017223308, -0.7988209262483008, -0.794038108568523, -0.7893827280231493, -0.7848591062084898, -0.780471379436534, -0.776223470870131, -0.7721190627295611, -0.7681615690013727, -0.7643541091055879, -0.760699482990721, -0.7572001481256743, -0.7538581988422011, -0.7506753484507803, -0.7476529145065716, -0.7447918075417577, -0.7420925235078681, -0.7395551400892497, -0.7371793169600469, -0.7349642999653361, -0.7329089291164935, -0.7310116502049888, -0.729270529761205, -0.72768327301837, -0.7262472444885278, -0.7249594907190603, -0.7238167647752116, -0.7228155519860804, -0.7219520964977888, -0.7212224281963598, -0.7206223895923672, -0.7201476622973921, -0.7197937927663569, -0.7195562170276171, -0.7194302841721818, -0.719411278422601, -0.7194944396493622, -0.7196749822468735, -0.7199481123211916, -0.7203090431771988, -0.7207530091233871, -0.7212752776379376, -0.7218711599603022, -0.7225360201884432, -0.723265282973584, -0.7240544399122066, -0.7248990547396494, -0.7257947674314684, -0.7267372973182236, -0.7277224453169717, -0.7287460953789664, -0.729804215248147, -0.7308928566193817, -0.7320081547792995, -0.7331463278061483, -0.7343036753986889, -0.735476577397733, -0.7366614920577659, -0.7378549541201457, -0.7390535727338022, -0.7402540292641284, -0.741453075025898, -0.7426475289716457, -0.7438342753628526, -0.7450102614476527, -0.7461724951654541, -0.7473180428959502, -0.7484440272673403, -0.7495476250362949, -0.7506260650501231, -0.7516766262998372, -0.7526966360712284, -0.7536834681997118, -0.7546345414335409, -0.7555473179089549, -0.7564193017399852, -0.7572480377248774, -0.7580311101704891, -0.7587661418354641, -0.7594507929925477, -0.7600827606100335, -0.7606597776519979, -0.761179612496734, -0.7616400684725458, -0.7620389835098925, -0.7623742299087031, -0.7626437142195313, -0.7628453772370964, -0.762977194104648, -0.7630371745274761, -0.7630233630937671, -0.7629338397009281, -0.762766720085359, -0.7625201564535591, -0.7621923382123109, -0.7617814927955575, -0.7612858865854425, -0.7607038259248118, -0.7600336582183165, -0.7592737731190508, -0.7584226037974637, -0.7574786282890631, -0.7564403709171865, -0.7553064037868679, -0.7540753483455671, -0.7527458770062293, -0.7513167148278714, -0.7497866412485631, -0.7481544918653723, -0.7464191602554929, -0.7445795998324646, -0.7426348257310404, -0.7405839167139086, -0.7384260170931491, -0.7361603386589596, -0.7337861626078396, -0.7313028414621209, -0.7287098009723982, -0.7260065419941397, -0.7231926423294658, -0.7202677585248535, -0.7172316276152871, -0.7140840688052142, -0.7108249850764796, -0.7074543647133528, -0.7039722827346552, -0.7003789022230223, -0.6966744755413463, -0.6928593454265748, -0.688933945951175, -0.6848988033428189, -0.6807545366531169, -0.676501858266599, -0.6721415742415542, -0.6676745844748444, -0.663101882683375, -0.6584245561955171, -0.6536437855465153, -0.6487608438726293, -0.6437770960996365, -0.638693997922162, -0.6335130945712727, -0.6282360193687376, -0.6228644920673884, -0.6174003169780816, -0.6118453808848369, -0.6062016507508406, -0.600471171219122, -0.5946560619128121, -0.588758514541014, -0.5827807898173986, -0.5767252141996919, -0.5705941764592555, -0.5643901240909273, -0.5581155595742094, -0.5517730364977538, -0.5453651555598606, -0.5388945604584248, -0.5323639336843661, -0.5257759922331082, -0.5191334832490967, -0.512439179618665, -0.5056958755267931, -0.4989063819933949, -0.49207352240481994, -0.48520012805612195, -0.4782890337194873, -0.47134307325389607, -0.4643650752707314, -0.4573578588695282, -0.45032422945755446, -0.4432669746662055, -0.43618886037654836, -0.42909262686553085, -0.4219809850835768, -0.4148566130733892, -0.40772215253890304, -0.4005802055723585, -0.3934333315465438, -0.3862840441782544, -0.37913480876807704, -0.37198803962061877, -0.3648460976483655, -0.35771128816141134, -0.35058585884441, -0.34347199792121735, -0.3363718325068611, -0.3292874271456996, -0.32222078253385533, -0.31517383442335195, -0.3081484527047176, -0.3011464406642275, -0.294169534411447, -0.2872194024722418, -0.28029764554199443, -0.2734057963934422, -0.2665453199331774, -0.2597176134006549, -0.2529240067033085, -0.2461657628812376, -0.2394440786948031, -0.23276008532843184, -0.22611484920386882, -0.21950937289617511, -0.21294459614577166, -0.20642139695996653, -0.1999405927974761, -0.19350294182959848, -0.18710914427188596, -0.18075984378031462, -0.17445562890616928, -0.16819703460408264, -0.1619845437878884, -0.1558185889291892, -0.14969955369379828, -0.14362777461145093, -0.13760354277446551, -0.131627105561268, -0.12569866838096422, -0.11981839643541992, -0.1139864164955412, -0.10820281868872494, -0.10246765829467663, -0.09678095754707527, -0.09114270743876074, -0.08555286952839769, -0.08001137774675593, -0.07451814020100944, -0.06907304097564415, -0.0636759419287718, -0.05832668448286771, -0.05302509140912004, -0.047770968604783914, -0.042564106863094975, -0.037404283635489866, -0.03229126478602584, -0.02722480633807356, -0.022204656213499874, -0.01723055596470424, -0.01230224250003209, -0.007419449803208078, -0.0025819106475990505, 0.00221064169379781, 0.00695847174156583, 0.011661840105112953, 0.016321001778648703, 0.02093620443646549, 0.02550768672600101, 0.03003567655700845, 0.03452038938508062, 0.03896202648763436, 0.04336077323038379, 0.04771679732217615, 0.05203024705600745, 0.05630124953389726, 0.06052990887321785, 0.06471630439196197, 0.06886048877036621, 0.07296248618617529, 0.07702229042080866, 0.08103986293356114, 0.08501513090094581, 0.08894798521821345, 0.09283827846005488, 0.09668582279746285, 0.10049038786774411, 0.1042516985946797, 0.10796943295588601, 0.11164321969453639, 0.11527263597268922, 0.1188572049636939, 0.12239639338131336, 0.12588960894355022, 0.12933619776948946, 0.1327354417079213, 0.13608655559708266, 0.13938868445546926, 0.1426409006044848, 0.1458422007246048, 0.14899150284780938, 0.15208764329033436, 0.15512937353123668, 0.1581153570439815, 0.1610441660902021, 0.16391427848702966, 0.16672407436189823, 0.16947183291161688, 0.17215572918569583, 0.17477383091753923, 0.1773240954311009, 0.17980436665500282, 0.18221237228100468, 0.18454572110892792, 0.18680190062587532, 0.18897827487362845, 0.19107208266456588, 0.19308043621311688, 0.19500032025668662, 0.19682859174690487, 0.1985619801989224, 0.20019708879297549, 0.20173039632841638, 0.2031582601355113, 0.20447692005415669, 0.2056825035909456, 0.2067710323661957, 0.20773842996016811, 0.20858053126228893, 0.20929309341812158, 0.2098718084557582, 0.21031231765555697, 0.21061022770461002, 0.21076112864948093, 0.21076061362780807, 0.21060430032121807, 0.21028785402925282, 0.20980701221738385, 0.20915761034262648, 0.20833560870939616, 0.20733712005764987, 0.20615843753723728, 0.20479606267884753, 0.20324673293559137, 0.20150744834225487, 0.19957549682390457, 0.19744847768369356, 0.19512432281261116, 0.19260131519234858, 0.1898781043062408, 0.1869537181314861, 0.18382757145676165, 0.18049947035044334, 0.1769696126927321, 0.17323858477646426, 0.16930735407245534, 0.16517725834208857, 0.1608499913590336, 0.15632758557045034, 0.15161239208342553, 0.14670705840330317, 0.14161450437603312, 0.13633789679710112, 0.13088062314551163, 0.12524626488441276, 0.11943857074200348, 0.11346143034958894, 0.1073188485705186, 0.10101492080631158, 0.09455380951705378, 0.08793972214379486, 0.0811768905730102, 0.07426955223845483, 0.0672219329149914, 0.060038231222668825, 0.05272260482814389, 0.04527915830422813, 0.03771193258710115, 0.030024895954108066, 0.02222193643276077, 0.014306855543148311, 0.006283363270876974, -0.0018449258344798714, -0.010074495540266681, -0.018401929893651636, -0.026823914365601886, -0.03533723627016627, -0.04393878454776812, -0.052625548995047566, -0.0613946190174372, -0.07024318197413087, -0.0791685211786724, -0.08816801361212967, -0.0972391273997894, -0.10637941909663512, -0.11558653082153808, -0.12485818727514775, -0.13419219267194343, -0.14358642761274326, -0.1530388459202366, -0.16254747145669618, -0.17211039494003, -0.18172577077161534, -0.19139181388698334, -0.2011067966383258, -0.21086904571594783, -0.22067693911421615, -0.23052890314612923, -0.24042340950948682, -0.25035897240659144, -0.2603341457185828, -0.2703475202347545, -0.2803977209366309, -0.29048340433608366, -0.3006032558663841, -0.3107559873247707, -0.32094033436489056, -0.33115505403730716, -0.34139892237617275, -0.3516707320300847, -0.3619692899351654, -0.3722934150284172, -0.3826419359994908, -0.3930136890790781, -0.4034075158622938, -0.4138222611655351, -0.42425677091551667, -0.4347098900693227, -0.445180460564565, -0.45566731929895754, -0.4661692961388277, -0.47668521195637814, -0.487213876695735, -0.49775408746812483, -0.5083046266767662, -0.5188642601724004, -0.5294317354406197, -0.5400057798224958, -0.5505850987702867, -0.5611683741403312, -0.5717542625255027, -0.5823413936299349, -0.5929283686890151, -0.6035137589379409, -0.6140961041324219, -0.6246739111253808, -0.6352456525038028, -0.6458097652901129, -0.6563646497127078, -0.666908668050502, -0.6774401435565311, -0.687957359465862, -0.6984585580931693, -0.7089419400255003, -0.7194056634158155, -0.7298478433829569, -0.7402665515237127, -0.7506598155426116, -0.7610256190050378, -0.7713619012191131, -0.7816665572516682, -0.7919374380833801, -0.8021723509079157, -0.8123690595795946, -0.8225252852137376, -0.8326387069434042, -0.8427069628357964, -0.852727650971045, -0.8626983306855315, -0.8726165239812597, -0.8824797171021209, -0.8922853622771706, -0.9020308796302708, -0.9117136592546912};
 float thd2_trac[647]={1.4529608243665304, 1.4603177763780937, 1.4675371977687939, 1.4746169744809978, 1.4815550337270866, 1.4883493454656278, 1.4949979239138262, 1.501498829091074, 1.5078501683881782, 1.5140500981566511, 1.5200968253122231, 1.5259886089465786, 1.5317237619410924, 1.5373006525762323, 1.5427177061301212, 1.5479734064596509, 1.5530662975574574, 1.5579949850779724, 1.5627581378257758, 1.567354489199439, 1.571782838584096, 1.5760420526860395, 1.580131066802762, 1.5840488860219657, 1.5877945863432932, 1.5913673157167036, 1.5947662949917036, 1.5979908187719323, 1.6010402561699169, 1.6039140514572, 1.6066117246054292, 1.6091328717144404, 1.611477165323821, 1.6136443546049322, 1.6156342654308953, 1.617446800322553, 1.6190819382690043, 1.6205397344218304, 1.62182031966276, 1.6229239000450306, 1.6238507561093467, 1.6246012420758604, 1.6251757849141926, 1.6255748832940506, 1.6257991064195565, 1.6258490927508862, 1.625725548617335, 1.6254292467263902, 1.6249610245738035, 1.624321782760089, 1.6235124832192052, 1.622534147365534, 1.6213878541655344, 1.6200747381407115, 1.6185959873087383, 1.6169528410697307, 1.615146588044796, 1.61317856387406, 1.6110501489814029, 1.6087627663131419, 1.6063178790578616, 1.6037169883544844, 1.6009616309956156, 1.5980533771329828, 1.5949938279916809, 1.5917846135996705, 1.5884273905387998, 1.5849238397233183, 1.5812756642116308, 1.5774845870567, 1.5735523492002483, 1.5694807074155726, 1.5652714323034667, 1.5609263063454162, 1.5564471220179235, 1.5518356799714446, 1.547093787277137, 1.5422232557442614, 1.53722590031076, 1.5321035375092398, 1.5268579840102576, 1.521491055244537, 1.5160045641054332, 1.5104003197327198, 1.504680126378488, 1.4988457823557326, 1.4928990790699423, 1.4868418001338202, 1.4806757205650574, 1.474402606066887, 1.4680242123910086, 1.4615422847822939, 1.4549585575045687, 1.448274753446647, 1.44149258380767, 1.434613747860761, 1.4276399327938698, 1.420572813626685, 1.4134140532024064, 1.4061653022531535, 1.3988281995377703, 1.3914043720507707, 1.383895435301199, 1.3763029936601527, 1.368628640775807, 1.360873960054755, 1.353040525208582, 1.345129900864614, 1.3371436432398722, 1.3290833008773355, 1.3209504154436889, 1.3127465225878603, 1.304473152859712, 1.2961318326884008, 1.287724085420005, 1.2792514324141762, 1.2707153941996645, 1.2621174916887492, 1.2534592474507147, 1.24474218704468, 1.235967840412258, 1.2271377433306427, 1.218253438926959, 1.2093164792548121, 1.2003284269342083, 1.1912908568561729, 1.182205357953606, 1.1730735350400856, 1.1638970107185407, 1.1546774273619342, 1.1454164491682681, 1.136115764292464, 1.1267770870578653, 1.1174021602503177, 1.1079927574980106, 1.0985506857404523, 1.0890777877901718, 1.0795759449909161, 1.0700470799763464, 1.060493159533361, 1.0509161975743941, 1.041318258223128, 1.0317014590182534, 1.0220679742399286, 1.0124200383637338, 1.002759949646852, 0.9930900738512695, 0.9834128481086215, 0.97373078493121, 0.9640464763734582, 0.9543625983477173, 0.9446819150979437, 0.9350072838341317, 0.9253416595296959, 0.915688099883105, 0.9060497704439322, 0.8964299499022191, 0.886832035538418, 0.877259548829334, 0.8677161412032814, 0.8582055999350868, 0.8487318541685821, 0.8392989810507666, 0.8299112119578959, 0.8205729387891503, 0.8112887202984806, 0.8020632884293115, 0.7929015546103458, 0.7838086159633265, 0.7747897613655698, 0.7658504773010746, 0.756996453424234, 0.7482335877495363, 0.7395679913691011, 0.7310059925876771, 0.7225541403517847, 0.7142192068362073, 0.7060081890372563, 0.6979283092083326, 0.6899870139597578, 0.6821919718319222, 0.6745510691391263, 0.6670724038716714, 0.659764277436465, 0.6526351840125018, 0.645693797298004, 0.6389489544315976, 0.6324096368819728, 0.626084948119697, 0.6199840879125643, 0.6141163231227625, 0.6084909549309744, 0.6031172824697861, 0.5980045629164641, 0.5931619681729162, 0.5885985383475735, 0.5843231323482792, 0.5803443759950514, 0.5766706081634578, 0.5733098255701199, 0.5702696269069734, 0.5675571571159235, 0.5651790526657519, 0.5631413887436216, 0.561449629300143, 0.5601085808862244, 0.559122351189137, 0.5584943131135237, 0.5582270751607107, 0.5583224587389317, 0.5587814828916216, 0.559604356766088, 0.5607904799671923, 0.5623384507572616, 0.5642460818822608, 0.5665104236324929, 0.569127793590845, 0.5720938123885825, 0.5754034446823326, 0.5790510444890358, 0.58303040396951, 0.5873348047352721, 0.5919570707656978, 0.5968896220602535, 0.602124528209538, 0.6076535611447965, 0.6134682464136064, 0.6195599124250237, 0.6259197372064316, 0.6325387923126158, 0.6394080836221909, 0.6465185888449138, 0.6538612916435634, 0.6614272123450994, 0.6692074352767147, 0.6771931328133804, 0.685375586264512, 0.6937462037592217, 0.7022965353129882, 0.7110182852742895, 0.7199033223589492, 0.7289436874835085, 0.7381315996079024, 0.7474594597929094, 0.756919853670232, 0.7665055525131954, 0.7762095130847776, 0.7860248764273329, 0.7959449657456166, 0.8059632835217299, 0.8160735079878169, 0.8262694890699412, 0.8365452439046346, 0.8468949520184413, 0.8573129502502539, 0.867793727486528, 0.8783319192705658, 0.8889223023389089, 0.8995597891305348, 0.9102394223079184, 0.9209563693231371, 0.9317059170568824, 0.9424834665536242, 0.9532845278720578, 0.9641047150663756, 0.9749397413107896, 0.9857854141769921, 0.9966376310719622, 1.0074923748414644, 1.0183457095429354, 1.0291937763899717, 1.040032789869478, 1.0508590340314636, 1.0616688589507226, 1.0724586773588993, 1.0832249614449512, 1.0939642398215699, 1.104673094654815, 1.115348158953973, 1.1259861140184937, 1.1365836870387453, 1.1471376488472658, 1.1576448118172042, 1.1681020279046401, 1.1785061868315085, 1.188854214405965, 1.199143070977065, 1.2093697500207523, 1.219531276854253, 1.2296247074760474, 1.2396471275287468, 1.249595651382256, 1.2594674213347314, 1.269259606928934, 1.2789694043816369, 1.2885940361238577, 1.2981307504497221, 1.3075768212718069, 1.3169295479808978, 1.3261862554080468, 1.3353442938868842, 1.3444010394141028, 1.3533538939060137, 1.3622002855490303, 1.3709376692418833, 1.3795635271273212, 1.3880753692108978, 1.3964707340644262, 1.4047471896114931, 1.4129023339923263, 1.4209337965051418, 1.4288392386209492, 1.436616355068592, 1.4442628749866502, 1.4517765631385733, 1.4591552211872783, 1.4663966890251672, 1.4734988461553211, 1.4804596131194172, 1.4872769529676544, 1.4939488727657715, 1.5004734251339982, 1.506848709812563, 1.5130728752481752, 1.5191441201956735, 1.525060695328856, 1.5308209048543246, 1.5364231081220092, 1.541865721225893, 1.5471472185883572, 1.5522661345214461, 1.5572210647583011, 1.562010667947974, 1.5666336671068122, 1.5710888510196455, 1.5753750755840612, 1.579491265091163, 1.5834364134363175, 1.5872095852536061, 1.5908099169678693, 1.5942366177585165, 1.5974889704295347, 1.6005663321804788, 1.6034681352735678, 1.6061938875924169, 1.608743173088367, 1.6111156521108185, 1.6133110616184778, 1.6153292152689225, 1.6171700033844252, 1.6188333927925374, 1.620319426540468, 1.6216282234828956, 1.6227599777434079, 1.6237149580503456, 1.6244935069484125, 1.6250960398879601, 1.6255230441944302, 1.6257750779209725, 1.6258527685877708, 1.6257568118121064, 1.625487969833665, 1.6250470699400306, 1.6244350027977015, 1.623652720694366, 1.622701235698465, 1.6215816177424107, 1.6202949926360377, 1.6188425400171127, 1.6172254912458663, 1.615445127250669, 1.6135027763320204, 1.611399811932106, 1.6091376503771495, 1.6067177485997568, 1.604141601848401, 1.6014107413910432, 1.5985267322197974, 1.595491170763326, 1.5923056826134918, 1.5889719202725348, 1.585491560926828, 1.581866304252956, 1.5780978702616149, 1.5741879971845112, 1.570138439409118, 1.5659509654658532, 1.5616273560718947, 1.5571694022355114, 1.5525789034245039, 1.5478576658019452, 1.5430075005321504, 1.5380302221594493, 1.5329276470620214, 1.5277015919827543, 1.5223538726387946, 1.5168863024111519, 1.5113006911154763, 1.5055988438548344, 1.499782559955097, 1.4938536319832998, 1.4878138448491223, 1.481664974989446, 1.4754087896357528, 1.4690470461639629, 1.4625814915261568, 1.4560138617635037, 1.4493458815995675, 1.442579264113089, 1.4357157104892297, 1.4287569098482051, 1.4217045391501617, 1.4145602631751018, 1.4073257345766528, 1.4000025940084215, 1.3925924703217012, 1.385096980833265, 1.3775177316620482, 1.3698563181334893, 1.3621143252503964, 1.3542933282291902, 1.346394893100507, 1.3384205773731495, 1.3303719307604753, 1.3222504959684134, 1.3140578095443531, 1.3057954027862995, 1.2974648027117541, 1.2890675330859303, 1.2806051155090057, 1.2720790705622829, 1.2634909190132315, 1.254842183079538, 1.2461343877524638, 1.237369062179925, 1.2285477411099224, 1.2196719663950646, 1.210743288559138, 1.2017632684268535, 1.1927334788180626, 1.1836555063079555, 1.1745309530549126, 1.1653614386979192, 1.1561486023256238, 1.1468941045193513, 1.1375996294725477, 1.128266887189417, 1.1188976157656418, 1.1094935837543463, 1.1000565926206356, 1.0905884792882865, 1.0810911187823098, 1.0715664269713723, 1.0620163634141706, 1.052442934314071, 1.0428481955864624, 1.0332342560433974, 1.0236032807001991, 1.0139574942087837, 1.0042991844224698, 0.994630706097032, 0.9849544847326911, 0.9752730205615506, 0.9655888926848242, 0.9559047633638079, 0.9462233824682103, 0.9365475920848074, 0.926880331288762, 0.9172246410790588, 0.9075836694784079, 0.8979606767967288, 0.8883590410557798, 0.8787822635706409, 0.8692339746816748, 0.8597179396279884, 0.8502380645505858, 0.8407984026099647, 0.8314031601990693, 0.8220567032280242, 0.8127635634520965, 0.8035284448085724, 0.7943562297218401, 0.7852519853287961, 0.7762209695686795, 0.7672686370726889, 0.7584006447789797, 0.7496228571881931, 0.7409413511632519, 0.732362420165058, 0.723892577802852, 0.7155385605646408, 0.7073073295792879, 0.6992060712480447, 0.6912421965695728, 0.6834233389695207, 0.6757573504337844, 0.6682522957344039, 0.66091644452934, 0.6537582611128414, 0.6467863915927711, 0.6400096482760359, 0.6334369910541146, 0.6270775055988123, 0.6209403782045797, 0.6150348671491717, 0.6093702704895881, 0.6039558902658962, 0.5988009931514632, 0.5939147676644315, 0.5893062781407759, 0.5849844157625597, 0.5809578470341347, 0.5772349602007989, 0.5738238102056288, 0.5707320628764793, 0.5679669391222102, 0.5655351599899292, 0.5634428934890604, 0.561695704118781, 0.5602985060390421, 0.5592555207996253, 0.558570240484855, 0.5582453970440182, 0.558282938461091, 0.558684012275552, 0.5594489568039047, 0.5605773002353827, 0.5620677675923441, 0.5639182953637875, 0.5661260534466853, 0.5686874738715252, 0.5715982856515321, 0.5748535549842833, 0.5784477299526173, 0.5823746888208646, 0.5866277910015475, 0.5911999297759248, 0.5960835858855517, 0.6012708811679415, 0.6067536314830062, 0.6125233982632466, 0.6185715381155343, 0.6248892500008372, 0.6314676196169493, 0.6382976607046807, 0.6453703530874302, 0.6526766773356506, 0.6602076460202979, 0.6679543315818177, 0.6759078908938403, 0.6840595866433059, 0.6924008056820117, 0.700923074529211, 0.7096180722217812, 0.7184776407186567, 0.7274937930705825, 0.736658719565916, 0.7459647920589318, 0.7554045666798591, 0.7649707851163062, 0.7746563746446966, 0.7844544470780541, 0.7943582967838205, 0.8043613979123758, 0.8144574009641159, 0.8246401288104522, 0.8349035722720942, 0.8452418853466607, 0.8556493801670436, 0.8661205217621123, 0.8766499226822956, 0.8872323375443469, 0.8978626575420896, 0.9085359049632296, 0.9192472277462862, 0.9299918941063247, 0.940765287253428, 0.9515629002236542, 0.962380330838561, 0.9732132768062046, 0.9840575309736895, 0.9949089767390301, 1.0057635836279726, 1.0166174030397184, 1.0274665641639933, 1.0383072700706593, 1.0491357939720558, 1.0599484756573843, 1.0707417180977643, 1.0815119842200227, 1.0922557938468618, 1.1029697208006966, 1.1136503901682024, 1.124294475722451, 1.1348986974993802, 1.1454598195253123, 1.1559746476921666, 1.1664400277770857, 1.1768528436031782, 1.1872100153382137, 1.1975084979281103, 1.2077452796622048, 1.2179173808673895, 1.2280218527282674, 1.2380557762306315, 1.2480162612256358, 1.2579004456121652, 1.2677054946349533, 1.27742860029615, 1.2870669808780473, 1.2966178805747821, 1.306078569230866, 1.3154463421844487, 1.3247185202132281, 1.3338924495809277, 1.3429655021822875, 1.351935075784458, 1.360798594362677, 1.36955350852802, 1.3781972960450026, 1.3867274624366628, 1.3951415416747, 1.403437096952098, 1.4116117215355382, 1.419663039694771, 1.4275887077059286, 1.4353864149256046, 1.4430538849323349, 1.4505888767319197, 1.4579891860228111, 1.4652526465175777, 1.4723771313162466, 1.4793605543270851, 1.4862008717301627, 1.492896083478799, 1.499444234833782, 1.5058434179250149, 1.5120917733350447, 1.5181874916986877, 1.524128815312807, 1.5299140397500963, 1.5355415154705636, 1.5410096494242551, 1.5463169066386557, 1.5514618117840782, 1.5564429507103035, 1.5612589719476875};


 //For Alpha
 //float thd1_trac[508]={-0.6386183926115109, -0.6339726500821531, -0.6295673502271599, -0.6254057772492245, -0.6214910334393497, -0.6178260427917922, -0.6144135553119785, -0.6112561519957821, -0.6083562504521366, -0.6057161111353435, -0.6033378441487588, -0.6012234165778864, -0.5993746603082268, -0.5977932802816412, -0.5964808631443868, -0.5954388862403791, -0.5946687269045409, -0.5941716720132713, -0.5939489277519737, -0.594001629563163, -0.5943308522428067, -0.5949376201571152, -0.5958229175569394, -0.5969876989720773, -0.5984328996731055, -0.6001594461937321, -0.6021682669120153, -0.6044603026940811, -0.6070365176091198, -0.6098979097294182, -0.6130455220339454, -0.6164804534385623, -0.6202038699801928, -0.6242170161863667, -0.6285212266653043, -0.6331179379552768, -0.6380087006752433, -0.6431951920218562, -0.6486792286607133, -0.6544627800623535, -0.6605479823358307, -0.6669371526148216, -0.6736328040530493, -0.6806376614873484, -0.6879546778278883, -0.695587051235801, -0.7035382431487474, -0.7118119972144998, -0.7204123591914782, -0.7293436978729336, -0.738610727088063, -0.7482185288283258, -0.7581725775403244, -0.7684787656172639, -0.7791434301087412, -0.7901733806527016, -0.8015759286129869, -0.8133589173800977, -0.8255307537603168, -0.838100440337841, -0.8510776086443637, -0.8644725529086837, -0.8782962640830552, -0.8925604637504652, -0.9072776374047408, -0.9224610664597346, -0.9381248581808691, -0.954283972537447, -0.9709542447425734, -0.9881524019739103, -1.0058960724475463, -1.0242037846436958, -1.0430949540520686, -1.0625898543132544, -1.0827095690788913, -1.1034759203001123, -1.12491136798783, -1.1470388757846488, -1.169881735971215, -1.193463346837989, -1.2178069347426492, -1.2429352127212148, -1.2688699673317267, -1.295631565616814, -1.3232383748417056, -1.3517060891937602, -1.381046960138516, -1.4112689308446078, -1.4423746802273485, -1.4743605888734892, -1.5072156474419611, -1.5409203379533278, -1.5754455292974665, -1.6107514395953002, -1.6467867286690878, -1.683487792367582, -1.7207783351389636, -1.7585692962341652, -1.7967591966413607, -1.8352349572559188, -1.8738732138002394, -1.9125421218279355, -1.9511036083865443, -1.989415989426575, -2.0273368384426913, -2.064725966724359, -2.101448362711466, -2.137376939375793, -2.1723949542461534, -2.206397994497358, -2.239295455576482, -2.2710114813790927, -2.30148537223445, -2.330671499916899, -2.358538793883287, -2.385069878750384, -2.4102599498501363, -2.4341154727477847, -2.4566527857023943, -2.477896673216302, -2.497878965965361, -2.5166372091076656, -2.534213428401822, -2.5506530124755917, -2.5660037203561554, -2.5803148161055747, -2.5936363270039955, -2.606018417974658, -2.61751087257822, -2.6281626696364224, -2.638021644110693, -2.647134221026633, -2.6555452118066514, -2.6632976631964267, -2.6704327499291853, -2.6769897032794487, -2.6830057686552546, -2.6885161863257743, -2.693554190255964, -2.6981510208091763, -2.702335947778276, -2.7061363008168318, -2.7095775048690824, -2.71268311864723, -2.7154748745846917, -2.7179727190122973, -2.7201948515686434, -2.722157763073173, -2.723876271267853, -2.725363553976302, -2.726631179343464, -2.7276891329088846, -2.7285458413365093, -2.7292081926772123, -2.729681553080005, -2.7299697798968623, -2.730075231146577, -2.729998771317241, -2.7297397734967106, -2.729296117827459, -2.728664186288415, -2.7278388538131653, -2.726813475763129, -2.725579871787651, -2.7241283061223154, -2.7224474644042482, -2.7205244271210463, -2.718344639860894, -2.7158918805984418, -2.7131482243375125, -2.7100940055417713, -2.706707778922601, -2.7029662793248184, -2.6988443816614653, -2.694315062105179, -2.68934936205286, -2.6839163567501076, -2.6779831309000723, -2.671514764095754, -2.6644743295120232, -2.656822909979021, -2.6485196363336323, -2.639521753807518, -2.629784723147609, -2.619262364156662, -2.607907050350879, -2.5956699644027514, -2.5825014248891747, -2.568351295485601, -2.553169487988979, -2.536906570227926, -2.519514488800886, -2.5009474144102875, -2.481162714051177, -2.460122049191474, -2.437792592120839, -2.414148343727404, -2.389171525150362, -2.3628540033849896, -2.3351986976714967, -2.306220900478614, -2.275949435616838, -2.244427568349498, -2.211713580337046, -2.177880927733112, -2.1430179150895925, -2.1072268412920634, -2.0706226055764576, -2.0333307993203036, -1.9954853489431392, -1.9572258121893276, -1.9186944594749156, -1.8800332898012941, -1.8413811344964826, -1.8028709913538135, -1.7646277083612094, -1.7267661036686865, -1.6893895712551434, -1.6525891845946368, -1.6164432775022595, -1.581017455088131, -1.5463649697897375, -1.5125273878964294, -1.4795354699093837, -1.4474101919462998, -1.416163843399603, -1.385801146442014, -1.3563203542519702, -1.3277142958668664, -1.2999713455985316, -1.2730763035288262, -1.2470111805747264, -1.2217558869923173, -1.1972888271194206, -1.173587405842678, -1.150628453945244, -1.1283885803684892, -1.1068444597063392, -1.0859730631149327, -1.0657518404024475, -1.046158860472475, -1.0271729166112655, -1.0087736023931329, -0.9909413632705463, -0.973657528242202, -0.9569043253701198, -0.9406648843534192, -0.9249232288651121, -0.9096642609178396, -0.8948737391421691, -0.8805382525319719, -0.8666451909307189, -0.8531827132945418, -0.8401397145675703, -0.8275057918373152, -0.8152712102981265, -0.8034268694350291, -0.7919642697447455, -0.7808754802324391, -0.7701531068587187, -0.7597902620595922, -0.749780535420054, -0.7401179655484271, -0.7307970131717012, -0.7218125354509969, -0.713159761499657, -0.7048342690736971, -0.6968319623945599, -0.6891490510568731, -0.6817820299686084, -0.6747276602673922, -0.6679829511543317, -0.661545142585386, -0.6554116887597847, -0.6495802423451633, -0.6440486393797439, -0.6388148847930306, -0.6338771384879703, -0.6292337019292993, -0.6248830051849057, -0.6208235943693102, -0.6170541194409591, -0.6135733223077732, -0.6103800251984525, -0.6074731192602577, -0.6048515533475178, -0.602514322968842, -0.6004604593650191, -0.5986890186938597, -0.5971990713026981, -0.5959896910740446, -0.5950599448347884, -0.5944088818244999, -0.5940355232236273, -0.593938851747746, -0.5941178013193873, -0.5945712468343018, -0.5952979940442013, -0.5962967695829882, -0.5975662111681272, -0.5991048580130114, -0.6009111414898498, -0.6029833760856396, -0.6053197506960569, -0.6079183203035815, -0.6107769980866802, -0.6138935480064674, -0.6172655779158113, -0.620890533233351, -0.6247656912213992, -0.6288881559021662, -0.6332548536413055, -0.6378625294214345, -0.6427077438212646, -0.6477868707082436, -0.6530960956445236, -0.6586314149975706, -0.6643886357381981, -0.6703633759002537, -0.6765510656678922, -0.682946949048454, -0.689546086081589, -0.6963433555285513, -0.7033334579797087, -0.7105109193132249, -0.7178700944338303, -0.7254051712174042, -0.7331101745849828, -0.7409789706285953, -0.7490052707110266, -0.7571826354621936, -0.7655044785961099, -0.7739640704744294, -0.7825545413450704, -0.7912688841874195, -0.8000999570989022, -0.8090404851612231, -0.8180830617281469, -0.8272201490803027, -0.8364440783959092, -0.8457470489895982, -0.8551211267744403, -0.8645582419049115, -0.8740501855606925, -0.8835886058329556, -0.8931650026760003, -0.9027707218878467, -0.9123969480835741, -0.9220346966248592, -0.9316748044682857, -0.9413079198936364, -0.95092449107145, -0.9605147534268094, -0.9700687157534935, -0.9795761450294466, -0.9890265498809658, -0.9984091626391663, -1.007712919928237, -1.0169264417207988, -1.026038008791467, -1.0350355384955574, -1.0439065587960312, -1.0526381804582325, -1.0612170673292087, -1.0696294046164234, -1.0778608650800456, -1.085896573053917, -1.0937210662134589, -1.1013182550145788, -1.1086713797370025, -1.1157629650791014, -1.1225747722704207, -1.1290877486939617, -1.1352819750444085, -1.1411366100927889, -1.1466298331848117, -1.1517387846718243, -1.1564395045633398, -1.1607068698018705, -1.164514530698758, -1.1678348472387245, -1.1706388261665897, -1.1728960600183485, -1.1745746695575277, -1.1756412514340269, -1.1760608333042224, -1.1757968391458804, -1.1748110680764319, -1.1730636906440999, -1.1705132673111076, -1.167116794685109, -1.1628297859708074, -1.1576063930902116, -1.1513995789255553, -1.1441613491236797, -1.135843053791589, -1.1263957701075487, -1.1157707772338756, -1.103920134770609, -1.0907973751176379, -1.0763583182632102, -1.0605620144101517, -1.0433718152048246, -1.0247565678985757, -1.0046919183850154, -0.983161698714986, -0.9601593626330384, -0.9356894194724177, -0.9097688033582111, -0.8824281024986487, -0.8537125641755499, -0.8236827868979871, -0.79241501405018, -0.7600009548341465, -0.7265470791307594, -0.692173362595247, -0.6570114948959959, -0.6212026040696982, -0.5848945889711843, -0.5482391847961667, -0.5113889091672703, -0.47449404515972315, -0.4376998117473563, -0.4011438525293499, -0.36495414327182707, -0.32924738209871285, -0.29412788787430455, -0.25968699681566143, -0.22600291798662608, -0.1931409870065226, -0.1611542446108818, -0.1300842620256819, -0.0999621370725916, -0.0708095917347038, -0.0426401117611519, -0.015460080153811395, 0.010730132225613476, 0.03593514507377904, 0.060163632951780066, 0.08342748465252492, 0.10574106074814682, 0.12712054791126115, 0.14758340541909387, 0.16714789717933654, 0.18583270143136255, 0.20365658976407564, 0.22063816706753592, 0.23679566434741384, 0.25214677685817266, 0.2667085406605585, 0.2804972414135174, 0.29352834992250654, 0.3058164796529923, 0.3173753620599582, 0.3282178361702057, 0.33835584937927954, 0.34780046688861277, 0.35656188761317575, 0.3646494647397638, 0.3720717294159499, 0.3788364163051763, 0.3849504899597771, 0.390420171146175, 0.3952509624097633, 0.3994476722956031, 0.4030144377488116, 0.405954744308904, 0.4082714437884498, 0.40996676919079955, 0.4110423466767117, 0.4114992044374828, 0.41133777837441143, 0.41055791452280754, 0.4091588681947085, 0.4071392998493917, 0.40449726773610717, 0.4012302173904507, 0.39733496810601476, 0.39280769654788794, 0.38764391772585927, 0.3818384636049348, 0.3753854597008983, 0.36827830009190543, 0.3605096213761052, 0.35207127622351697, 0.34295430731130794, 0.3331489225996038, 0.3226444731044307, 0.31142943456051175, 0.2994913946445872, 0.2868170477552725, 0.27339219972334594, 0.25920178526150184, 0.24422990145820922, 0.22845986117747485, 0.21187427084248922, 0.19445513774845846, 0.17618401275299744, 0.15704217490535544, 0.1370108652587998, 0.11607157770592647, 0.09420641510446903, 0.07139851911466599, 0.04763258191123487, 0.02289544709417002, -0.0028231944967687106, -0.02953001098233865, -0.05722713843501892};
 //float thd2_trac[508]={1.287235535204266, 1.2879352995635795, 1.2891009458856524, 1.290731535205418, 1.2928257578412956, 1.295381938193683, 1.2983980408146452, 1.3018716776767005, 1.3058001165556345, 1.310180290430844, 1.3150088077971716, 1.3202819637745853, 1.3259957518963799, 1.3321458764530172, 1.3387277652670568, 1.345736582774862, 1.3531672432927988, 1.3610144243492068, 1.3692725799684304, 1.3779359537994018, 1.3869985919884154, 1.396454355703659, 1.4062969332275157, 1.4165198515414077, 1.4271164873368096, 1.4380800773948832, 1.4494037282857375, 1.4610804253464917, 1.4731030409050356, 1.48546434172345, 1.4981569956414833, 1.511173577406166, 1.5245065736785839, 1.5381483872129813, 1.552091340206712, 1.5663276768221794, 1.5808495648836716, 1.5956490967531591, 1.6107182893894623, 1.6260490835949284, 1.6416333424528884, 1.6574628489576249, 1.6735293028365865, 1.689824316562013, 1.7063394105461254, 1.7230660075105633, 1.7399954260169146, 1.7571188731408942, 1.7744274362681984, 1.7919120739851142, 1.8095636060318, 1.8273727022806998, 1.8453298706969197, 1.8634254442315485, 1.881649566592988, 1.8999921768353922, 1.9184429926973858, 1.9369914926184992, 1.9556268963553667, 1.9743381441148438, 1.9931138741171315, 2.0119423984990377, 2.03081167746609, 2.049709291602859, 2.068622412254234, 2.087537769897288, 2.1064416204349095, 2.1253197093595904, 2.1441572337604655, 2.1629388021804394, 2.1816483923754397, 2.2002693070870016, 2.2187841280156086, 2.237174668279079, 2.2554219237617104, 2.273506023910446, 2.291406182718732, 2.309100650861864, 2.3265666702143615, 2.3437804322941984, 2.3607170425433357, 2.3773504927692324, 2.3936536445345236, 2.409598226783083, 2.4251548515140935, 2.440293051835639, 2.4549813472075543, 2.4691873410673777, 2.482877856254643, 2.4960191136231344, 2.5085769588602735, 2.52051714171238, 2.5318056504426765, 2.5424091023437065, 2.552295188446636, 2.5614331672419306, 2.5697943983651035, 2.5773529030331277, 2.5840859338824753, 2.589974533199723, 2.595004055850669, 2.5991646319967, 2.602451545336842, 2.6048655053466208, 2.6064127967620028, 2.60710529605278, 2.6069603522546902, 2.6060005375069233, 2.604253280130349, 2.601750399313219, 2.598527564870693, 2.5946237078111185, 2.590080407568149, 2.5849412799965164, 2.579251387017373, 2.5730566846645067, 2.5664035217535632, 2.5593381969316775, 2.551906577812364, 2.544153782482243, 2.5361239209867628, 2.527859892470011, 2.519403232399168, 2.5107940036464016, 2.502070725011388, 2.493270330927081, 2.484428156491392, 2.475577942516427, 2.4667518559120096, 2.45798052136695, 2.449293060921493, 2.440717138612858, 2.432279007908289, 2.4240035601100294, 2.4159143723230363, 2.4080337539215333, 2.4003827907393807, 2.392981386447544, 2.3858483007758444, 2.3790011843918504, 2.372456610372913, 2.366230102303135, 2.3603361591000898, 2.354788276730258, 2.3495989670107393, 2.3447797737206613, 2.3403412862610873, 2.3362931511090226, 2.3326440813108835, 2.329401864254756, 2.3265733679499294, 2.3241645460274363, 2.32218044165723, 2.3206251905568824, 2.3195020232436607, 2.318813266657021, 2.318560345252302, 2.3187437816390424, 2.3193631968092023, 2.32041730997197, 2.321903937983057, 2.323819994327725, 2.326161487588561, 2.328923519301515, 2.332100281077248, 2.3356850508397806, 2.3396701880110893, 2.3440471274491452, 2.348806371928353, 2.3539374829360113, 2.3594290695468794, 2.365268775131111, 2.371443261649542, 2.3779381912959163, 2.3847382052595454, 2.391826899405916, 2.3991867967091824, 2.4067993163219303, 2.414644739237375, 2.4227021705910263, 2.4309494987673195, 2.4393633516268185, 2.447919050357032, 2.456590561680669, 2.4653504494356024, 2.474169826876732, 2.483018311446396, 2.4918639842197745, 2.5006733567545756, 2.5094113486545817, 2.518041279781352, 2.5265248816946384, 2.534822333533772, 2.542892328117805, 2.550692174471576, 2.558177943189524, 2.565304660922837, 2.572026559700479, 2.5782973856509686, 2.584070769874648, 2.589300661657263, 2.5939418209109255, 2.5979503627653164, 2.601284342812844, 2.6039043669643767, 2.6057742056404165, 2.6068613886274243, 2.607137754903899, 2.6065799315436684, 2.6051697177226014, 2.6028943539273364, 2.5997466624363814, 2.5957250524800544, 2.5908333914413824, 2.5850807511963643, 2.5784810454134153, 2.571052578711937, 2.562817531648132, 2.5538014064690397, 2.5440324576328885, 2.533541128610995, 2.522359512947429, 2.5105208534619914, 2.4980590892935077, 2.485008456552645, 2.4714031449301554, 2.457277009820213, 2.442663337407258, 2.4275946586967203, 2.4121026075682748, 2.396217817495223, 2.3799698514999252, 2.363387160103283, 2.346497062389484, 2.3293257457743577, 2.3118982805818655, 2.2942386460580866, 2.2763697649580044, 2.2583135443097277, 2.240090920383969, 2.2217219062692357, 2.2032256407754875, 2.184620437662933, 2.1659238344225487, 2.1471526400250402, 2.1283229812106454, 2.109450347017887, 2.090549631349938, 2.071635173456427, 2.0527207962703087, 2.0338198425864995, 2.014945209104561, 1.9961093783835813, 1.9773244487757826, 1.9586021624177261, 1.9399539313655079, 1.9213908619642788, 1.9029237775433971, 1.884563239527455, 1.8663195670506125, 1.8482028551578285, 1.8302229916717192, 1.812389672798549, 1.7947124175410458, 1.777200580979953, 1.759863366480158, 1.742709836871382, 1.725748924647497, 1.7089894412229218, 1.692440085279007, 1.6761094502281455, 1.6600060308183497, 1.6441382288964386, 1.628514358343636, 1.6131426491935088, 1.5980312509385806, 1.5831882350289344, 1.5686215965634394, 1.5543392551721276, 1.5403490550866983, 1.5266587643950775, 1.5132760734756305, 1.5002085926068673, 1.4874638487494984, 1.4750492814993617, 1.4629722382122416, 1.451239968304823, 1.4398596167400353, 1.4288382167098814, 1.4181826815343925, 1.4078997958016684, 1.3979962057809536, 1.3884784091483025, 1.3793527440724913, 1.3706253777173518, 1.3623022942254845, 1.3543892822571661, 1.3468919221670639, 1.3398155729098706, 1.3331653587740107, 1.326946156049833, 1.321162579745111, 1.3158189704658347, 1.3109193815841278, 1.3064675668174068, 1.3024669683433783, 1.2989207055741998, 1.2958315647097947, 1.2932019891850146, 1.2910340711180466, 1.2893295438581793, 1.2880897757199714, 1.2873157649780411, 1.2870081361825225, 1.287167137839719, 1.2877926414862124, 1.2888841421677137, 1.2904407603168087, 1.2924612450067245, 1.29494397854166, 1.2978869823284789, 1.3012879239599078, 1.3051441254261007, 1.3094525723598076, 1.3142099242104714, 1.3194125252347069, 1.3250564161845972, 1.331137346571352, 1.3376507873799375, 1.3445919441101795, 1.3519557700216414, 1.3597369794628706, 1.3679300611704437, 1.3765292914292167, 1.38552874699224, 1.3949223176666037, 1.4047037184798443, 1.4148665013502753, 1.4254040661934768, 1.4363096714059829, 1.447576443675842, 1.4591973870779475, 1.471165391419857, 1.4834732398109591, 1.4961136154344237, 1.509079107507159, 1.522362216418055, 1.5359553580390783, 1.5498508672072722, 1.5640410003783938, 1.5785179374549283, 1.5932737827923436, 1.6083005653880282, 1.623590238257126, 1.6391346769987039, 1.6549256775542938, 1.670954953158863, 1.6872141304818535, 1.7036947449529216, 1.7203882352636788, 1.7372859370328686, 1.7543790756182958, 1.7716587580542278, 1.7891159640881984, 1.8067415362859303, 1.824526169167767, 1.8424603973343052, 1.8605345825331927, 1.8787388996130698, 1.8970633213047305, 1.9154976017635839, 1.9340312588017727, 1.9526535547328083, 1.971353475746616, 1.9901197097286558, 2.008940622433649, 2.0278042319226954, 2.0466981811728964, 2.0656097087714715, 2.0845256176126203, 2.103432241526124, 2.1223154097828796, 2.141160409445982, 2.159951945568084, 2.1786740992790494, 2.197310283864585, 2.215843199009897, 2.234254783475642, 2.2525261665907754, 2.2706376190924096, 2.2885685040215127, 2.306297228599931, 2.323801198273684, 2.3410567744139845, 2.3580392375239514, 2.3747227582062336, 2.3910803786022212, 2.4070840075092077, 2.4227044329032346, 2.437911356117939, 2.452673452417769, 2.4669584631071357, 2.4807333245696617, 2.4939643396516646, 2.506617396495419, 2.51865823918603, 2.53005279329794, 2.5407675475268223, 2.5507699900210765, 2.560029094797357, 2.5685158498365173, 2.5762038143172887, 2.5830696882778095, 2.58909387422681, 2.5942610073518764, 2.5985604294909854, 2.601986582365671, 2.6045392979704776, 2.6062239684792154, 2.607051584284212, 2.6070386362782876, 2.6062068864667154, 2.6045830186178884, 2.602198187137712, 2.59908748707196, 2.5952893707550118, 2.5908450370795375, 2.585797817875452, 2.5801925828714567, 2.5740751806885274, 2.5674919288152047, 2.5604891610130776, 2.5531128364645483, 2.545408211445812, 2.537419571508199, 2.5291900201024577, 2.520761318232559, 2.512173768982069, 2.5034661405001137, 2.494675621145441, 2.4858378008553843, 2.4769866733372106, 2.468154654296366, 2.4593726115623697, 2.4506699036077597, 2.44207442355173, 2.433612646282177, 2.425309676809996, 2.4171892983858956, 2.4092740192647586, 2.401585117300071, 2.394142681796865, 2.386965652252214, 2.380071853773641, 2.373478029093806, 2.367199867199633, 2.3612520286704246, 2.355648167876431, 2.350400952230182, 2.345522078710676, 2.3410222878973648, 2.3369113757589774, 2.3331982034429934, 2.3298907053064, 2.3269958954182357, 2.3245198727502268, 2.322467825254233, 2.32084403300485, 2.3196518705628173, 2.3188938086903526, 2.3185714155234174, 2.3186853572788055, 2.3192353985458087, 2.320220402183751, 2.3216383288178584, 2.3234862358972546, 2.325760276250557, 2.328455696046905, 2.3315668320435976, 2.33508710797622, 2.3390090299234814, 2.3433241804574707, 2.3480232113710424, 2.353095834758159, 2.358530812210818, 2.3643159418885684, 2.370438043214375, 2.376882938955028, 2.3836354344567257, 2.3906792938287706, 2.397997212902579, 2.40557078884206, 2.4133804863480424, 2.4214056004874873, 2.4296242162921455, 2.4380131654160104, 2.446547980322009, 2.4552028466918436, 2.4639505550250096, 2.4727624527197567, 2.481608398315279, 2.4904567200240812, 2.4992741811964767, 2.508025955930946, 2.5166756186629997, 2.5251851522100224, 2.53351497938666, 2.541624023885515};
 //float thd1_trac[500]={1.57075092686252,1.57074907405733,1.57074714563651,1.57074513851526,1.57074304948251,1.57074087519520,1.57073861217083,1.57073625679341,1.57073380529095,1.57073125373955,1.57072859805754,1.57072583399559,1.57072295713024,1.57071996285744,1.57071684638505,1.57071360272901,1.57071022669620,1.57070671288478,1.57070305567081,1.57069924920418,1.57069528739284,1.57069116389739,1.57068687211782,1.57068240518802,1.57067775595861,1.57067291699104,1.57066788054204,1.57066263855082,1.57065718262999,1.57065150404928,1.57064559372116,1.57063944218739,1.57063303960583,1.57062637572929,1.57061943989486,1.57061222100386,1.57060470750419,1.57059688737313,1.57058874809603,1.57058027664893,1.57057145947596,1.57056228246642,1.57055273093722,1.57054278960229,1.57053244255381,1.57052167323426,1.57051046441068,1.57049879814637,1.57048665577298,1.57047401786005,1.57046086418418,1.57044717369672,1.57043292449037,1.57041809376283,1.57040265778206,1.57038659184722,1.57036987024963,1.57035246623095,1.57033435194111,1.57031549839372,1.57029587541896,1.57027545161558,1.57025419430198,1.57023206946166,1.57020904169010,1.57018507413837,1.57016012845335,1.57013416471673,1.57010714138110,1.57007901520394,1.57004974117715,1.57001927245672,1.56998756028615,1.56995455391990,1.56992020054083,1.56988444517691,1.56984723061216,1.56980849729609,1.56976818324781,1.56972622395688,1.56968255228020,1.56963709833497,1.56958978938599,1.56954054972990,1.56948930057434,1.56943595991121,1.56938044238549,1.56932265915932,1.56926251776939,1.56919992197896,1.56913477162413,1.56906696245354,1.56899638596140,1.56892292921420,1.56884647466977,1.56876689998951,1.56868407784248,1.56859787570185,1.56850815563293,1.56841477407231,1.56831758159861,1.56821642269318,1.56811113549173,1.56800155152504,1.56788749544989,1.56776878476855,1.56764522953713,1.56751663206160,1.56738278658203,1.56724347894355,1.56709848625398,1.56694757652761,1.56679050831466,1.56662703031510,1.56645688097741,1.56627978808068,1.56609546829964,1.56590362675234,1.56570395652917,1.56549613820291,1.56527983931878,1.56505471386393,1.56482040171532,1.56457652806533,1.56432270282388,1.56405851999664,1.56378355703787,1.56349737417731,1.56319951371956,1.56288949931557,1.56256683520449,1.56223100542505,1.56188147299536,1.56151767905951,1.56113904200018,1.56074495651547,1.56033479265896,1.55990789484141,1.55946358079256,1.55900114048171,1.55851983499557,1.55801889537136,1.55749752138411,1.55695488028608,1.55639010549663,1.55580229524094,1.55519051113546,1.55455377671866,1.55389107592467,1.55320135149841,1.55248350334989,1.55173638684586,1.55095881103685,1.55014953681746,1.54930727501814,1.54843068442617,1.54751836973418,1.54656887941408,1.54558070351457,1.54455227138044,1.54348194929203,1.54236803802304,1.54120877031545,1.54000230827018,1.53874674065236,1.53744008011057,1.53608026030935,1.53466513297496,1.53319246485459,1.53165993458974,1.53006512950516,1.52840554231520,1.52667856775034,1.52488149910740,1.52301152472805,1.52106572441121,1.51904106576630,1.51693440051577,1.51474246075694,1.51246185519506,1.51008906536170,1.50762044183479,1.50505220047957,1.50238041873248,1.49960103195364,1.49670982987721,1.49370245319331,1.49057439029978,1.48732097426755,1.48393738006909,1.48041862212599,1.47675955223906,1.47295485797202,1.46899906156889,1.46488651949455,1.46061142269863,1.45616779771403,1.45154950871405,1.44675026066506,1.44176360372623,1.43658293906294,1.43120152625642,1.42561249250937,1.41980884386439,1.41378347867040,1.40752920354986,1.40103875213790,1.39430480688130,1.38732002420151,1.38007706333982,1.37256861921394,1.36478745962293,1.35672646713944,1.34837868602446,1.33973737448754,1.33079606259323,1.32154861608085,1.31198930631639,1.30211288653079,1.29191467441528,1.28139064103974,1.27053750593134,1.25935283799665,1.24783516178886,1.23598406841256,1.22380033012121,1.21128601739868,1.19844461702986,1.18528114936012,1.17180228262793,1.15801644193876,1.14393391014376,1.12956691760985,1.11492971763597,1.10003864410375,1.08491214787107,1.06957080844593,1.05403731763514,1.03833643216741,1.02249489275408,1.00654130768130,0.990505999821482,0.974420816896740,0.958318905899279,0.942234453737187,0.926202397382329,0.910258107994362,0.894437054619184,0.878774454047137,0.863304914203981,0.848062078981481,0.833078282651806,0.818384221924844,0.804008653292862,0.789978122576586,0.776316732574452,0.763045953474309,0.750184479279871,0.737748132007346,0.725749813898551,0.714199506450323,0.703104313743144,0.692468546419117,0.682293841750218,0.672579314575101,0.663321733473019,0.654515716378385,0.646153939898175,0.638227356846410,0.630725416918982,0.623636285958860,0.616947059866931,0.610643969860789,0.604712576439947,0.599137950054059,0.593904837069347,0.588997810171929,0.584401402825137,0.580100227806035,0.576079080183015,0.572323025363898,0.568817473046770,0.565548238050182,0.562501589092407,0.559664286638731,0.557023610948797,0.554567381439901,0.552283968443510,0.550162298376856,0.548191853284502,0.546362665630325,0.544665309142217,0.543090886432516,0.541631014039192,0.540277805457547,0.539023852661035,0.537862206543339,0.536786356652738,0.535790210534070,0.534868072943452,0.534014625156072,0.533224904547713,0.532494284595789,0.531818455415343,0.531193404919157,0.530615400668621,0.530080972462805,0.529586895696985,0.529130175508307,0.528708031715063,0.528317884546805,0.527957341155097,0.527624182888760,0.527316353312819,0.527031946946817,0.526769198695578,0.526526473943641,0.526302259283473,0.526095153846877,0.525903861208875,0.525727181833500,0.525564006031370,0.525413307399636,0.525274136715707,0.525145616257192,0.525026934521522,0.524917341319905,0.524816143221412,0.524722699324224,0.524636417332234,0.524556749916415,0.524483191341525,0.524415274339846,0.524352567214774,0.524294671158118,0.524241217765991,0.524191866739155,0.524146303754592,0.524104238495952,0.524065402831369,0.524029549127902,0.523996448692623,0.523965890331026,0.523937679014131,0.523911634646221,0.523887590925768,0.523865394292590,0.523844902954826,0.523825985989746,0.523808522512869,0.523792400910257,0.523777518129232,0.523763779023115,0.523751095745900,0.523739387193109,0.523728578485302,0.523718600491041,0.523709389386289,0.523700886247494,0.523693036675787,0.523685790449932,0.523679101205839,0.523672926140605,0.523667225739232,0.523661963522274,0.523657105812823,0.523652621521353,0.523648481947066,0.523644660594463,0.523641133003991,0.523637876595674,0.523634870524754,0.523632095548394,0.523629533902622,0.523627169188722,0.523624986268337,0.523622971166637,0.523621110982913,0.523619393808043,0.523617808648295,0.523616345354981,0.523614994559517,0.523613747613468,0.523612596533203,0.523611533948799,0.523610553056873,0.523609647577037,0.523608811711698,0.523608040108950,0.523607327828314,0.523606670309117,0.523606063341290,0.523605503038423,0.523604985812883,0.523604508352847,0.523604067601098,0.523603660735457,0.523603285150709,0.523602938441926,0.523602618389074,0.523602322942792,0.523602050211276,0.523601798448165,0.523601566041358,0.523601351502699,0.523601153458436,0.523600970640441,0.523600801878075,0.523600646090703,0.523600502280771,0.523600369527419,0.523600246980585,0.523600133855561,0.523600029427969,0.523599933029124,0.523599844041751,0.523599761896032,0.523599686065958,0.523599616065963,0.523599551447810,0.523599491797727,0.523599436733751,0.523599385903286,0.523599338980847,0.523599295665971,0.523599255681296,0.523599218770785,0.523599184698085,0.523599153245016,0.523599124210171,0.523599097407629,0.523599072665763,0.523599049826140,0.523599028742509,0.523599009279864,0.523598991313577,0.523598974728603,0.523598959418742,0.523598945285958,0.523598932239754,0.523598920196589,0.523598909079346,0.523598898816837,0.523598889343347,0.523598880598214,0.523598872525438,0.523598865073326,0.523598858194160,0.523598851843889,0.523598845981850,0.523598840570506,0.523598835575206,0.523598830963963,0.523598826707248,0.523598822777806,0.523598819150473,0.523598815802023,0.523598812711014,0.523598809857653,0.523598807223669,0.523598804792195,0.523598802547662,0.523598800475696,0.523598798563031,0.523598796797419,0.523598795167553,0.523598793662997,0.523598792274117,0.523598790992019,0.523598789808494,0.523598788715962,0.523598787707428,0.523598786776434,0.523598785917018,0.523598785123677,0.523598784391332,0.523598783715291,0.523598783091227,0.523598782515143,0.523598781983351,0.523598781492445,0.523598781039282,0.523598780620959,0.523598780234798,0.523598779878328,0.523598779549263,0.523598779245499,0.523598778965089,0.523598778706238,0.523598778467288,0.523598778246709,0.523598778043090,0.523598777855125,0.523598777681612,0.523598777521440,0.523598777373582,0.523598777237091,0.523598777111095,0.523598776994786,0.523598776887419};
 //float thd2_trac[500]={9.07998647601927e-05,9.45054751295877e-05,9.83623167648648e-05,0.000102376559264912,0.000106554624783252,0.000110903199402044,0.000115429248123638,0.000120140002981189,0.000125043007894024,0.000130146110696835,0.000135457474708482,0.000140985598614069,0.000146739329308712,0.000152727874922454,0.000158960819703410,0.000165448131769932,0.000172200197387175,0.000179227820233558,0.000186542248169118,0.000194155181426224,0.000202078804104533,0.000210325795022985,0.000218909354157547,0.000227843213756664,0.000237141672573736,0.000246819607714657,0.000256892505704263,0.000267376488157032,0.000278288329810308,0.000289645491234029,0.000301466147481482,0.000313769215008031,0.000326574378134266,0.000339902131211319,0.000353773800069311,0.000368211582065028,0.000383238581422256,0.000398878843536015,0.000415157397723391,0.000432100291926402,0.000449734637867880,0.000468088656962495,0.000487191715361568,0.000507074385222307,0.000527768482165908,0.000549307121275444,0.000571724768425522,0.000595057297059890,0.000619342043841386,0.000644617869702473,0.000670925221438691,0.000698306196352369,0.000726804609045091,0.000756466064138174,0.000787338025672267,0.000819469895345820,0.000852913090533813,0.000887721127886972,0.000923949707577079,0.000961656802360474,0.00100090275187644,0.00104175035863151,0.00108426498583297,0.00112851466647265,0.00117457020960102,0.00122250531304474,0.00127239668308357,0.00132432415634315,0.00137837082758854,0.00143462318191937,0.00149317123548616,0.00155410867635782,0.00161753301749484,0.00168354574999301,0.00175225250814231,0.00182376323596947,0.00189819236548127,0.00197565899760703,0.00205628709418193,0.00214020567603033,0.00222754902938771,0.00231845691986141,0.00241307481781288,0.00251155412999962,0.00261405244110367,0.00272073376736751,0.00283176881880775,0.00294733527114642,0.00306761805100358,0.00319280963186838,0.00332311034153458,0.00345872868270648,0.00359988166699871,0.00374679516139182,0.00389970425024570,0.00405885361077216,0.00422449790482443,0.00439690218609436,0.00457634232392353,0.00476310544516836,0.00495749039257109,0.00515980820343524,0.00537038260633759,0.00558955053971894,0.00581766269001152,0.00605508405268481,0.00630219451553520,0.00655938946658930,0.00682708042572799,0.00710569570269677,0.00739568108183946,0.00769750053456727,0.00801163696048195,0.00833859295960208,0.00867889163497088,0.00903307742842359,0.00940171699051073,0.00978540008510898,0.0101847405314468,0.0106003771839785,0.0110329749522312,0.0114832258619409,0.0119518501591466,0.0124395974591285,0.0129472479420327,0.0134756135965211,0.0140255395140457,0.0145979052351781,0.0151936261506777,0.0158136549586491,0.0164589831808126,0.0171306427396862,0.0178297075990718,0.0185572954707784,0.0193145695894299,0.0201027405588556,0.0209230682718713,0.0217768639069699,0.0226654920046768,0.0235903726263665,0.0245529835986441,0.0255548628470745,0.0265976108215772,0.0276828930176415,0.0288124425965351,0.0299880631079185,0.0312116313188728,0.0324851001524815,0.0338105017404585,0.0351899505929796,0.0366256468900167,0.0381198798980758,0.0396750315161006,0.0412935799548731,0.0429781035535165,0.0447312847374607,0.0465559141214253,0.0484548947616255,0.0504312465606499,0.0524881108289082,0.0546287550057406,0.0568565775437173,0.0591751129588847,0.0615880370494280,0.0640991722850646,0.0667124933686483,0.0694321329710952,0.0722623876398705,0.0752077238806152,0.0782727844103182,0.0814623945794733,0.0847815689593910,0.0882355180891146,0.0918296553749939,0.0955696041336959,0.0994612047673720,0.103510522057191,0.107723852558252,0.112107732075914,0.116668943199665,0.121414522866390,0.126351769920208,0.131488252630652,0.136831816124839,0.142390589682522,0.148172993835375,0.154187747203173,0.160443872990231,0.166950705054686,0.173717893451622,0.180755409337821,0.188073549111680,0.195682937645752,0.203594530452014,0.211819614600690,0.220369808192541,0.229257058161732,0.238493636161691,0.248092132259682,0.258065446137336,0.268426775463921,0.279189601076956,0.290367668571062,0.301974965861017,0.314025696249001,0.326534246490078,0.339515149313997,0.352983039827201,0.366952605186771,0.381438526910154,0.396455415161906,0.412017734343930,0.428139719310923,0.444835281540869,0.462117904614704,0.480000528403334,0.498495421428098,0.517614040957005,0.537366880528204,0.557763304759230,0.578811371510320,0.600517641727111,0.622886977596492,0.645922330012082,0.669624516764669,0.693991993347374,0.719020618792436,0.744703419530068,0.771030354869548,0.797988088333925,0.825559769712271,0.853724833302281,0.882458818370101,0.911733218317848,0.941515365382303,0.971768357847651,1.00245103669794,1.03351801831951,1.06491978925497,1.09660286808163,1.12851003822720,1.16058065394683,1.19275101979631,1.22495484179123,1.25712374611542,1.28918785882514,1.32107643760107,1.35271854435142,1.38404374549552,1.41498282518183,1.44546849562683,1.47543608828618,1.50482420974010,1.53357534700407,1.56163640843662,1.58895918844089,1.61550074664117,1.64122369503005,1.66609638957510,1.69009302579269,1.71319364068915,1.73538402610350,1.75665556075156,1.77700497008936,1.79643402443959,1.81494918664375,1.83256122083302,1.84928477379344,1.86513793989697,1.88014181975183,1.89432008167207,1.90769853385593,1.92030471386822,1.93216750070990,1.94331675348168,1.95378297945110,1.96359703324594,1.97278984793952,1.98139219797772,1.98943449322376,1.99694660286200,2.00395770749625,2.01049617748943,2.01658947540498,2.02226408031233,2.02754543169220,2.03245789070999,2.03702471670277,2.04126805683608,2.04520894702079,2.04886732232914,2.05226203530536,2.05541088072476,2.05833062551141,2.06103704267470,2.06354494826772,2.06586824050312,2.06801994028432,2.07001223252165,2.07185650770289,2.07356340327765,2.07514284449437,2.07660408439822,2.07795574275911,2.07920584375148,2.08036185225255,2.08143070866418,2.08241886219582,2.08333230257318,2.08417659015967,2.08495688449618,2.08567797127960,2.08634428781227,2.08695994696416,2.08752875969616,2.08805425619864,2.08853970570251,2.08898813502285,2.08940234589604,2.08978493117204,2.09013828992279,2.09046464152705,2.09076603879052,2.09104438015838,2.09130142107541,2.09153878454675,2.09175797094998,2.09196036714697,2.09214725494134,2.09231981892532,2.09247915375696,2.09262627090674,2.09276210491010,2.09288751916024,2.09300331127356,2.09311021805781,2.09320892011148,2.09330004608061,2.09338417659789,2.09346184792706,2.09353355533399,2.09359975620455,2.09366087292774,2.09371729556153,2.09376938429735,2.09381747173826,2.09386186500461,2.09390284768014,2.09394068161030,2.09397560856406,2.09400785176928,2.09403761733133,2.09406509554356,2.09409046209799,2.09411387920358,2.09413549661919,2.09415545260771,2.09417387481721,2.09419088109481,2.09420658023822,2.09422107268993,2.09423445117812,2.09424680130858,2.09425820211133,2.09426872654525,2.09427844196415,2.09428741054709,2.09429568969566,2.09430333240087,2.09431038758181,2.09431690039844,2.09432291254028,2.09432846249301,2.09433358578455,2.09433831521235,2.09434268105312,2.09434671125652,2.09435043162397,2.09435386597371,2.09435703629320,2.09435996287983,2.09436266447076,2.09436515836286,2.09436746052339,2.09436958569220,2.09437154747605,2.09437335843572,2.09437503016640,2.09437657337189,2.09437799793316,2.09437931297156,2.09438052690721,2.09438164751295,2.09438268196403,2.09438363688410,2.09438451838760,2.09438533211888,2.09438608328838,2.09438677670594,2.09438741681165,2.09438800770421,2.09438855316724,2.09438905669346,2.09438952150708,2.09438995058440,2.09439034667292,2.09439071230891,2.09439104983364,2.09439136140839,2.09439164902825,2.09439191453495,2.09439215962862,2.09439238587867,2.09439259473386,2.09439278753155,2.09439296550629,2.09439312979773,2.09439328145788,2.09439342145787,2.09439355069417,2.09439366999434,2.09439378012229,2.09439388178322,2.09439397562810,2.09439406225785,2.09439414222720,2.09439421604822,2.09439428419362,2.09439434709976,2.09439440516945,2.09439445877454,2.09439450825827,2.09439455393751,2.09439459610478,2.09439463503007,2.09439467096264,2.09439470413259,2.09439473475231,2.09439476301788,2.09439478911029,2.09439481319662,2.09439483543110,2.09439485595612,2.09439487490310,2.09439489239337,2.09439490853892,2.09439492344314,2.09439493720147,2.09439494990201,2.09439496162609,2.09439497244878,2.09439498243938,2.09439499166187,2.09439500017530,2.09439500803418,2.09439501528885,2.09439502198575,2.09439502816777,2.09439503387449,2.09439503914246,2.09439504400540,2.09439504849447,2.09439505263840,2.09439505646373,2.09439505999496,2.09439506325469,2.09439506626380,2.09439506904156,2.09439507160575,2.09439507397281,2.09439507615787,2.09439507817494,2.09439508003692,2.09439508175576,2.09439508334244,2.09439508480713,2.09439508615921,2.09439508740734,2.09439508855951,2.09439508962309,2.09439509060490,2.09439509151123,2.09439509234788,2.09439509312020,2.09439509383314,2.09439509449127,2.09439509509880,2.09439509565962,2.09439509617732,2.09439509665522,2.09439509709637,2.09439509750361,2.09439509787954,2.09439509822657,2.09439509854691,2.09439509884263,2.09439509911561,2.09439509936760,2.09439509960022,2.09439509981496};
 float trac_tvect[500]={0,0.00200000000000000,0.00400000000000000,0.00600000000000000,0.00800000000000000,0.0100000000000000,0.0120000000000000,0.0140000000000000,0.0160000000000000,0.0180000000000000,0.0200000000000000,0.0220000000000000,0.0240000000000000,0.0260000000000000,0.0280000000000000,0.0300000000000000,0.0320000000000000,0.0340000000000000,0.0360000000000000,0.0380000000000000,0.0400000000000000,0.0420000000000000,0.0440000000000000,0.0460000000000000,0.0480000000000000,0.0500000000000000,0.0520000000000000,0.0540000000000000,0.0560000000000000,0.0580000000000000,0.0600000000000000,0.0620000000000000,0.0640000000000000,0.0660000000000000,0.0680000000000000,0.0700000000000000,0.0720000000000000,0.0740000000000000,0.0760000000000000,0.0780000000000000,0.0800000000000000,0.0820000000000000,0.0840000000000000,0.0860000000000000,0.0880000000000000,0.0900000000000000,0.0920000000000000,0.0940000000000000,0.0960000000000000,0.0980000000000000,0.100000000000000,0.102000000000000,0.104000000000000,0.106000000000000,0.108000000000000,0.110000000000000,0.112000000000000,0.114000000000000,0.116000000000000,0.118000000000000,0.120000000000000,0.122000000000000,0.124000000000000,0.126000000000000,0.128000000000000,0.130000000000000,0.132000000000000,0.134000000000000,0.136000000000000,0.138000000000000,0.140000000000000,0.142000000000000,0.144000000000000,0.146000000000000,0.148000000000000,0.150000000000000,0.152000000000000,0.154000000000000,0.156000000000000,0.158000000000000,0.160000000000000,0.162000000000000,0.164000000000000,0.166000000000000,0.168000000000000,0.170000000000000,0.172000000000000,0.174000000000000,0.176000000000000,0.178000000000000,0.180000000000000,0.182000000000000,0.184000000000000,0.186000000000000,0.188000000000000,0.190000000000000,0.192000000000000,0.194000000000000,0.196000000000000,0.198000000000000,0.200000000000000,0.202000000000000,0.204000000000000,0.206000000000000,0.208000000000000,0.210000000000000,0.212000000000000,0.214000000000000,0.216000000000000,0.218000000000000,0.220000000000000,0.222000000000000,0.224000000000000,0.226000000000000,0.228000000000000,0.230000000000000,0.232000000000000,0.234000000000000,0.236000000000000,0.238000000000000,0.240000000000000,0.242000000000000,0.244000000000000,0.246000000000000,0.248000000000000,0.250000000000000,0.252000000000000,0.254000000000000,0.256000000000000,0.258000000000000,0.260000000000000,0.262000000000000,0.264000000000000,0.266000000000000,0.268000000000000,0.270000000000000,0.272000000000000,0.274000000000000,0.276000000000000,0.278000000000000,0.280000000000000,0.282000000000000,0.284000000000000,0.286000000000000,0.288000000000000,0.290000000000000,0.292000000000000,0.294000000000000,0.296000000000000,0.298000000000000,0.300000000000000,0.302000000000000,0.304000000000000,0.306000000000000,0.308000000000000,0.310000000000000,0.312000000000000,0.314000000000000,0.316000000000000,0.318000000000000,0.320000000000000,0.322000000000000,0.324000000000000,0.326000000000000,0.328000000000000,0.330000000000000,0.332000000000000,0.334000000000000,0.336000000000000,0.338000000000000,0.340000000000000,0.342000000000000,0.344000000000000,0.346000000000000,0.348000000000000,0.350000000000000,0.352000000000000,0.354000000000000,0.356000000000000,0.358000000000000,0.360000000000000,0.362000000000000,0.364000000000000,0.366000000000000,0.368000000000000,0.370000000000000,0.372000000000000,0.374000000000000,0.376000000000000,0.378000000000000,0.380000000000000,0.382000000000000,0.384000000000000,0.386000000000000,0.388000000000000,0.390000000000000,0.392000000000000,0.394000000000000,0.396000000000000,0.398000000000000,0.400000000000000,0.402000000000000,0.404000000000000,0.406000000000000,0.408000000000000,0.410000000000000,0.412000000000000,0.414000000000000,0.416000000000000,0.418000000000000,0.420000000000000,0.422000000000000,0.424000000000000,0.426000000000000,0.428000000000000,0.430000000000000,0.432000000000000,0.434000000000000,0.436000000000000,0.438000000000000,0.440000000000000,0.442000000000000,0.444000000000000,0.446000000000000,0.448000000000000,0.450000000000000,0.452000000000000,0.454000000000000,0.456000000000000,0.458000000000000,0.460000000000000,0.462000000000000,0.464000000000000,0.466000000000000,0.468000000000000,0.470000000000000,0.472000000000000,0.474000000000000,0.476000000000000,0.478000000000000,0.480000000000000,0.482000000000000,0.484000000000000,0.486000000000000,0.488000000000000,0.490000000000000,0.492000000000000,0.494000000000000,0.496000000000000,0.498000000000000,0.500000000000000,0.502000000000000,0.504000000000000,0.506000000000000,0.508000000000000,0.510000000000000,0.512000000000000,0.514000000000000,0.516000000000000,0.518000000000000,0.520000000000000,0.522000000000000,0.524000000000000,0.526000000000000,0.528000000000000,0.530000000000000,0.532000000000000,0.534000000000000,0.536000000000000,0.538000000000000,0.540000000000000,0.542000000000000,0.544000000000000,0.546000000000000,0.548000000000000,0.550000000000000,0.552000000000000,0.554000000000000,0.556000000000000,0.558000000000000,0.560000000000000,0.562000000000000,0.564000000000000,0.566000000000000,0.568000000000000,0.570000000000000,0.572000000000000,0.574000000000000,0.576000000000000,0.578000000000000,0.580000000000000,0.582000000000000,0.584000000000000,0.586000000000000,0.588000000000000,0.590000000000000,0.592000000000000,0.594000000000000,0.596000000000000,0.598000000000000,0.600000000000000,0.602000000000000,0.604000000000000,0.606000000000000,0.608000000000000,0.610000000000000,0.612000000000000,0.614000000000000,0.616000000000000,0.618000000000000,0.620000000000000,0.622000000000000,0.624000000000000,0.626000000000000,0.628000000000000,0.630000000000000,0.632000000000000,0.634000000000000,0.636000000000000,0.638000000000000,0.640000000000000,0.642000000000000,0.644000000000000,0.646000000000000,0.648000000000000,0.650000000000000,0.652000000000000,0.654000000000000,0.656000000000000,0.658000000000000,0.660000000000000,0.662000000000000,0.664000000000000,0.666000000000000,0.668000000000000,0.670000000000000,0.672000000000000,0.674000000000000,0.676000000000000,0.678000000000000,0.680000000000000,0.682000000000000,0.684000000000000,0.686000000000000,0.688000000000000,0.690000000000000,0.692000000000000,0.694000000000000,0.696000000000000,0.698000000000000,0.700000000000000,0.702000000000000,0.704000000000000,0.706000000000000,0.708000000000000,0.710000000000000,0.712000000000000,0.714000000000000,0.716000000000000,0.718000000000000,0.720000000000000,0.722000000000000,0.724000000000000,0.726000000000000,0.728000000000000,0.730000000000000,0.732000000000000,0.734000000000000,0.736000000000000,0.738000000000000,0.740000000000000,0.742000000000000,0.744000000000000,0.746000000000000,0.748000000000000,0.750000000000000,0.752000000000000,0.754000000000000,0.756000000000000,0.758000000000000,0.760000000000000,0.762000000000000,0.764000000000000,0.766000000000000,0.768000000000000,0.770000000000000,0.772000000000000,0.774000000000000,0.776000000000000,0.778000000000000,0.780000000000000,0.782000000000000,0.784000000000000,0.786000000000000,0.788000000000000,0.790000000000000,0.792000000000000,0.794000000000000,0.796000000000000,0.798000000000000,0.800000000000000,0.802000000000000,0.804000000000000,0.806000000000000,0.808000000000000,0.810000000000000,0.812000000000000,0.814000000000000,0.816000000000000,0.818000000000000,0.820000000000000,0.822000000000000,0.824000000000000,0.826000000000000,0.828000000000000,0.830000000000000,0.832000000000000,0.834000000000000,0.836000000000000,0.838000000000000,0.840000000000000,0.842000000000000,0.844000000000000,0.846000000000000,0.848000000000000,0.850000000000000,0.852000000000000,0.854000000000000,0.856000000000000,0.858000000000000,0.860000000000000,0.862000000000000,0.864000000000000,0.866000000000000,0.868000000000000,0.870000000000000,0.872000000000000,0.874000000000000,0.876000000000000,0.878000000000000,0.880000000000000,0.882000000000000,0.884000000000000,0.886000000000000,0.888000000000000,0.890000000000000,0.892000000000000,0.894000000000000,0.896000000000000,0.898000000000000,0.900000000000000,0.902000000000000,0.904000000000000,0.906000000000000,0.908000000000000,0.910000000000000,0.912000000000000,0.914000000000000,0.916000000000000,0.918000000000000,0.920000000000000,0.922000000000000,0.924000000000000,0.926000000000000,0.928000000000000,0.930000000000000,0.932000000000000,0.934000000000000,0.936000000000000,0.938000000000000,0.940000000000000,0.942000000000000,0.944000000000000,0.946000000000000,0.948000000000000,0.950000000000000,0.952000000000000,0.954000000000000,0.956000000000000,0.958000000000000,0.960000000000000,0.962000000000000,0.964000000000000,0.966000000000000,0.968000000000000,0.970000000000000,0.972000000000000,0.974000000000000,0.976000000000000,0.978000000000000,0.980000000000000,0.982000000000000,0.984000000000000,0.986000000000000,0.988000000000000,0.990000000000000,0.992000000000000,0.994000000000000,0.996000000000000,0.998000000000000};
 float thd1=0;
 float thd2=0;
 int flag=0;

 float t1ini=0;
 float t2ini=0;
 float t1fi=0;
 float t2fi=0;
 //*********velocity desired array***********//
// float dt=0.002;
// float vel_track_d1[500];
// float vel_track_d2[500];
//	 vel_track_d1[i]=(thd1_trac[i+1]-thd1_trac[i])/dt;
//	 vel_track_d2[i]=(thd2_trac[i+1]-thd2_trac[i])/dt;
// }
 //float vel_track_d2[500] = {0.317506460004613,0.322174396066216,0.326717193506310,0.331136969846219,0.335435888294711,0.339616148342625,0.343679977020417,0.347629620802908,0.351467338142508,0.355195392607510,0.358816046602406,0.362331555643247,0.365744163162823,0.369056095815845,0.372269559257993,0.375386734369404,0.378409773895899,0.381340799479524,0.384181899052904,0.386935124569510,0.389602490047797,0.392185969901399,0.394687497535873,0.397108964187765,0.399452217986213,0.401719063217448,0.403911259773149,0.406030522766027,0.408078522295940,0.410056883351462,0.411967185832729,0.413810964682670,0.415589710114150,0.417304867922219,0.418957839870582,0.420549984143193,0.422082615851960,0.423557007592978,0.424974390043065,0.426335952591239,0.427642843997556,0.428896173075233,0.430097009389918,0.431246383972461,0.432345290040292,0.433394683724608,0.434395484799333,0.435348577409611,0.436254810796566,0.437115000016530,0.437929926652558,0.438700339516251,0.439426955338618,0.440110459448451,0.440751506436954,0.441350720807920,0.441908697612392,0.442426003066865,0.442903175155340,0.443340724213237,0.443739133494692,0.444098859721254,0.444420333612872,0.444703960400439,0.444950120320564,0.445159169091702,0.445331438372132,0.445467236200425,0.445566847417389,0.445630534070696,0.445658535802174,0.445651070217412,0.445608333239211,0.445530499443669,0.445417722380659,0.445270134878062,0.445087849330661,0.444870957973687,0.444619533142110,0.444333627514992,0.444013274346711,0.443658487684195,0.443269262571533,0.442845575242157,0.442387383298837,0.441894625882477,0.441367223829858,0.440805079820950,0.440208078516535,0.439576086686366,0.438908953328832,0.438206509782402,0.437468569829702,0.436694929794601,0.435885368633615,0.435039648021296,0.434157512431266,0.433238689213133,0.432282888666480,0.431289804111867,0.430259111961073,0.429190471786167,0.428083526388912,0.426937901871483,0.425753207709645,0.424529036828614,0.423264965683967,0.421960554347656,0.420615346600917,0.419228870034993,0.417800636161669,0.416330140533683,0.414816862877965,0.413260267242221,0.411659802156561,0.410014900812195,0.408324981258579,0.406589446620875,0.404807685339403,0.402979071433673,0.401102964791900,0.399178711489168,0.397205644135779,0.395183082258166,0.393110332714608,0.390986690148476,0.388811437480874,0.386583846445598,0.384303178169121,0.381968683797773,0.379579605175018,0.377135175571819,0.374634620472614,0.372077158419437,0.369462001917753,0.366788358405978,0.364055431292110,0.361262421059960,0.358408526447784,0.355492945702174,0.352514877909260,0.349473524406541,0.346368090276983,0.343197785927962,0.339961828756785,0.336659444905107,0.333289871102904,0.329852356604321,0.326346165215197,0.322770577413833,0.319124892564227,0.315408431222397,0.311620537533797,0.307760581722039,0.303827962664927,0.299822110557502,0.295742489656980,0.291588601106252,0.287359985831825,0.283056227508993,0.278676955589940,0.274221848385237,0.269690636192044,0.265083104459141,0.260399096978858,0.255638519094026,0.250801340908913,0.245887600490091,0.240897407043139,0.235830944050575,0.230688472354856,0.225470333168376,0.220176950995254,0.214808836443536,0.209366588910775,0.203850899122870,0.198262551505080,0.192602426366739,0.186871501877173,0.181070855814025,0.175201667062552,0.169265216846637,0.163262889672389,0.157196173964724,0.151066662381494,0.144876051786547,0.138626142868681,0.132318839392731,0.125956147071404,0.119540172048604,0.113073118988116,0.106557288761855,0.0999950757369694,0.0933889646620667,0.0867415271563976,0.0800554178082669,0.0733333698931471,0.0665781907229768,0.0597927566428735,0.0529800076937370,0.0461429419616133,0.0392846096380683,0.0324081068183935,0.0255165690658421,0.0186131647735621,0.0117010883566859,0.00478355330886249,-0.00213621484033144,-0.00905498563168461,-0.0159695308082242,-0.0228766314353202,-0.0297730849723399,-0.0366557122582378,-0.0435213643754651,-0.0503669293567821,-0.0571893387025790,-0.0639855736753958,-0.0707526713432882,-0.0774877303438171,-0.0841879163442361,-0.0908504671746746,-0.0974726976159079,-0.104052003823818,-0.110585867378088,-0.117071858943052,-0.123507641534260,-0.129890973385027,-0.136219710411223,-0.142491808275858,-0.148705324055820,-0.154858417517634,-0.160949352010409,-0.166976494986137,-0.172938318160409,-0.178833397326916,-0.184660411842286,-0.190418143797788,-0.196105476896080,-0.201721395052146,-0.207264980737976,-0.212735413091147,-0.218131965807933,-0.223454004840562,-0.228700985920827,-0.233872451927897,-0.238968030122466,-0.243987429264347,-0.248930436634742,-0.253796914978333,-0.258586799385041,-0.263300094126095,-0.267936869460539,-0.272497258426840,-0.276981453632663,-0.281389704056001,-0.285722311868342,-0.289979629291670,-0.294162055497571,-0.298270033558223,-0.302304047455859,-0.306264619159014,-0.310152305769340,-0.313967696746431,-0.317711411213040,-0.321384095345145,-0.324986419849860,-0.328519077532796,-0.331982780956575,-0.335378260192210,-0.338706260662824,-0.341967541080335,-0.345162871474991,-0.348293031316005,-0.351358807723179,-0.354360993767733,-0.357300386860238,-0.360177787224258,-0.362993996453698,-0.365749816150629,-0.368446046642268,-0.371083485773938,-0.373662927775409,-0.376185162197817,-0.378650972919137,-0.381061137214001,-0.383416424886363,-0.385717597461777,-0.387965407435908,-0.390160597577249,-0.392303900281354,-0.394396036972788,-0.396437717553388,-0.398429639893849,-0.400372489365486,-0.402266938410545,-0.404113646148374,-0.405913258014590,-0.407666405431895,-0.409373705509741,-0.411035760770828,-0.412653158902332,-0.414226472530521,-0.415756259015887,-0.417243060267425,-0.418687402575124,-0.420089796457424,-0.421450736523155,-0.422770701346553,-0.424050153352706,-0.425289538713824,-0.426489287253051,-0.427649812355935,-0.428771510888115,-0.429854763117254,-0.430899932639017,-0.431907366305795,-0.432877394156717,-0.433810329348361,-0.434706468085633,-0.435566089550588,-0.436389455829866,-0.437176811839246,-0.437928385243935,-0.438644386374998,-0.439325008140512,-0.439970425930591,-0.440580797516044,-0.441156262939924,-0.441696944401149,-0.442202946129155,-0.442674354250838,-0.443111236646221,-0.443513642795146,-0.443881603612750,-0.444215131273695,-0.444514219024716,-0.444778840985116,-0.445008951933956,-0.445204487084494,-0.445365361844952,-0.445491471564963,-0.445582691267266,-0.445638875365184,-0.445659857363956,-0.445645449546583,-0.445595442643909,-0.445509605487704,-0.445387684647225,-0.445229404048997,-0.445034464578453,-0.444802543665013,-0.444533294848537,-0.444226347327981,-0.443881305492455,-0.443497748433352,-0.443075229438772,-0.442613275469572,-0.442111386617250,-0.441569035543887,-0.440985666904625,-0.440360696752296,-0.439693511925532,-0.438983469420162,-0.438229895745002,-0.437432086262513,-0.436589304515789,-0.435700781542159,-0.434765715175156,-0.433783269337062,-0.432752573322004,-0.431672721073051,-0.430542770455078,-0.429361742525369,-0.428128620805812,-0.426842350558454,-0.425501838069109,-0.424105949942544,-0.422653512413251,-0.421143310676619,-0.419574088247232,-0.417944546347049,-0.416253343333839,-0.414499094173559,-0.412680369966656,-0.410795697534916,-0.408843559080446,-0.406822391924250,-0.404730588336838,-0.402566495472834,-0.400328415421025,-0.398014605384667,-0.395623278006779,-0.393152601855690,-0.390600702087657,-0.387965661306222,-0.385245520634692,-0.382438281024866,-0.379541904821917,-0.376554317607924,-0.373473410348829,-0.370297041868406,-0.367023041675507,-0.363649213170603,-0.360173337259262,-0.356593176399783,-0.352906479113296,-0.349110984983880,-0.345204430177831,-0.341184553507357,-0.337049103066428,-0.332795843464123,-0.328422563676306,-0.323927085538550,-0.319307272896574,-0.314561041426892,-0.309686369139156,-0.304681307561355,-0.299543993607493,-0.294272662115819,-0.288865659043513,-0.283321455287650,-0.277638661098950,-0.271816041040096,-0.265852529429184,-0.259747246199848,-0.253499513089844,-0.247108870064378,-0.240575091859230,-0.233898204518834,-0.227078501789135,-0.220116561210798,-0.213013259746031,-0.205769788760102,-0.198387668167782,-0.190868759546931,-0.183215278013782,-0.175429802653498,-0.167515285294395,-0.159475057422642,-0.151312835035838,-0.143032721248221,-0.134639206473119,-0.126137166029155,-0.117531855038544,-0.108828900515590,-0.100034290574091,-0.0911543607183207,-0.0821957772191073,-0.0731655176201995,-0.0640708484576480,-0.0549193003219317,-0.0457186404317800,-0.0364768429315765,-0.0272020571615461,-0.0179025741847139,-0.00858679188782685,0.000736821004154731,0.0100597616375098,0.0193735300916376,0.0286696664081931,0.0379397872120491,0.0471756215482400,0.0563690455783472,0.0655121157973504,0.0745971004619539,0.0836165089488361,0.0925631188003984,0.101430000253477,0.110210538085903,0.118898450662630,0.127487806099458,0.135973035511050,0.144348943344674,0.152610714842361,0.160753920706491,0.168774519077541,0.176668854957851,0.184433657239130,0.192066033510091,0.199563462834679,0.206923786701857,0.214145198353410,0.221226230698585,0.228165743024061,0.234962906702507,0.241617190096988,0.248128342848164,0.254496379723684,0.260721564191924,0.266804391874592,0.272745574014033,0.278546021080484,0.284206826628403,0.289729251498033,0.295114708443378,0.300364747256543,0.305481040444972,0.310465369507146,0.315319611840509,0.315319611840509};
 float vel_track_d1[647] = {0, -5.205409785053516, -5.1923689753839986, -5.178312903022175, -5.163219434480726, -5.147066466150873, -5.129831994672262, -5.111494189675769, -5.092031468723612, -5.0714225742676255, -5.049646652393324, -5.026683333116677, -5.002512811948856, -4.977115932440546, -4.950474269380445, -4.922570212298916, -4.893387048917452, -4.862909048146291, -4.8311215422376375, -4.798011007666469, -4.76356514431514, -4.727772952516196, -4.690624807519416, -4.652112530923402, -4.612229458646588, -4.570970504985006, -4.528332222340003, -4.484312856206429, -4.4389123950234755, -4.392132614523092, -4.343977116235465, -4.294451359838747, -4.243562689074665, -4.191320350998895, -4.137735508359386, -4.082821244953072, -4.026592563855735, -3.9690663784460734, -3.910261496240408, -3.850198595534371, -3.78890019497391, -3.72639061615887, -3.6626959394755465, -3.597843953380808, -3.5318640974063564, -3.464787399196423, -3.396646405933623, -3.327475110534439, -3.2573088730332156, -3.1861843376095322, -3.114139345714362, -3.0412128457989462, -2.967444800136332, -2.8928760892644734, -2.8175484145587237, -2.741504199458622, -2.664786489866122, -2.587438854230184, -2.509505283801561, -2.4310300935604934, -2.3520578242650636, -2.2726331460681815, -2.1928007641254244, -2.1126053265736466, -2.032091335253172, -1.951303059495535, -1.8702844532786367, -1.789079076015776, -1.7077300172111398, -1.626279825176713, -1.5447704399815798, -1.4632431307655125, -1.381738437515212, -1.300296117371924, -1.2189550955234996, -1.137753420670573, -1.0567282250769638, -0.9759156891478993, -0.8953510104833251, -0.8150683773190393, -0.7351009462555069, -0.6554808241587828, -0.5762390540948736, -0.4974056051529896, -0.4190093660044747, -0.3410781420262188, -0.2636386558165782, -0.1867165509275015, -0.11033639862845224, -0.0345217075149451, 0.040705064214607845, 0.11532249401291494, 0.18931017793444305, 0.2626487114779641, 0.3353196684910964, 0.40730557830059855, 0.47858990125027034, 0.5491570027921222, 0.6189921262889087, 0.6880813646760187, 0.7564116311142843, 0.8239706287727078, 0.89074681985013, 0.9567293939665156, 1.021908236009894, 1.086273893556644, 1.1498175439308422, 1.212530961006264, 1.274406481802437, 1.3354369729545734, 1.395615797105787, 1.4549367792684453, 1.5133941732037304, 1.5709826278464956, 1.6276971538049523, 1.6835330899553913, 1.7384860701471494, 1.7925519900242604, 1.8457269739635684, 1.8980073421340782, 1.94938957765467, 1.9998702938525126, 2.049446201589533, 2.0981140766405115, 2.1458707270956, 2.1927129607527407, 2.238637552465894, 2.2836412114106697, 2.3277205482268304, 2.3708720419893803, 2.4130920069657114, 2.4543765591039657, 2.494721582205983, 2.5341226937342087, 2.5725752101860566, 2.61007411200076, 2.646614007925985, 2.682189098808019, 2.716793140735141, 2.7504194075008703, 2.7830606523278067, 2.8147090688215304, 2.8453562510994956, 2.8749931530865913, 2.903610046929739, 2.931196480549958, 2.9577412342955967, 2.9832322767457953, 3.0076567196730686, 3.0310007722252896, 3.0532496944097876, 3.07438774996871, 3.094398158799194, 3.1132630490833257, 3.1309634093441563, 3.147479040706891, 3.162788509673664, 3.17686910181314, 3.189696776825568, 3.2012461255201963, 3.211490329349642, 3.2204011232450647, 3.2279487626060144, 3.2341019954263417, 3.2388280406966397, 3.242092574347044, 3.243859724200271, 3.2440920755414937, 3.242750689146312, 3.239795133774148, 3.235183535370445, 3.2288726454263172, 3.220817931138986, 3.2109736902662944, 3.199293193717201, 3.185728859114778, 3.170232458693356, 3.152755364975668, 3.1332488376966117, 3.111664355360255, 3.087953994656445, 3.0620708606496905, 3.0339695701961378, 3.003606790400015, 2.9709418330897686, 2.9359373051978666, 2.8985598136471724, 2.8587807217187455, 2.8165769520932527, 2.771931829635199, 2.7248359546872547, 2.6752880951686486, 2.623296083151039, 2.5688776989950535, 2.5120615235966204, 2.4528877370150193, 2.39140883988892, 2.327690272686811, 2.2618109073297976, 2.193863385977879, 2.1239542832015013, 2.0522040702849464, 1.9787468640942163, 1.9037299478923964, 1.827313057433444, 1.7496674325233608, 1.6709746417366, 1.591425195710372, 1.5112169721043789, 1.4305534824069488, 1.3496420169447632, 1.268691709309211, 1.1879115646014071, 1.107508497355414, 1.0276854244212763, 0.9486394557523536, 0.870560221891914, 0.7936283714174985, 0.7180142649210741, 0.6438768847337739, 0.5713629719243385, 0.500606394565617, 0.4317277441457934, 0.364834150714477, 0.30001930199630156, 0.237363647487554, 0.17693476551761123, 0.11878786936991848, 0.06296642771763672, 0.00950287479040135, -0.04158061338060959, -0.09027129875566198, -0.136565037159031, -0.18046542800359555, -0.22198297309417026, -0.26113425727525286, -0.297941161182258, -0.3324301140705255, -0.36463139257036925, -0.3945784693113463, -0.4223074137214011, -0.44785634590949197, -0.4712649433775695, -0.49257399937407964, -0.5118250309973371, -0.5290599345902924, -0.5443206856173832, -0.5576490799588663, -0.5690865134244105, -0.5786737962703015, -0.5864509995220368, -0.5924573300164493, -0.596731031189901, -0.5993093068282773, -0.6002282651630941, -0.599522880884773, -0.5972269728738433, -0.593373195603486, -0.5879930424000368, -0.581116858900721, -0.5727738652480108, -0.5629921856950548, -0.551798884477317, -0.5392200069140873, -0.5252806248570718, -0.5100048856955808, -0.4934160642416918, -0.4755366169145736, -0.456388237706995, -0.4359919155151326, -0.41436799244609634, -0.391536222805855, -0.3675158324875083, -0.34232557854180223, -0.31598380874292564, -0.28850852098216695, -0.25991742236808335, -0.2302279879058955, -0.1994575186733405, -0.1676231994052757, -0.1347421554140915, -0.10083150878259506, -0.06590843377579647, -0.029990211414032686, 0.006905716854521682, 0.04476169641948191, 0.08355980778457228, 0.12328181589993381, 0.16390912062408391, 0.2054227083767013, 0.24780310505750913, 0.2910303303153561, 0.335083853247653, 0.3799425496328612, 0.4255846607935099, 0.47198775420032035, 0.519128685938286, 0.5669835651593291, 0.6155277206503773, 0.6647356696689033, 0.7145810891789339, 0.7650367896541721, 0.816074691595392, 0.8676658049396879, 0.9197802115141762, 0.9723870507120647, 1.0254545085659483, 1.0789498103797035, 1.1328392170947832, 1.1870880255600014, 1.2416605728593488, 1.2965202448613211, 1.351629489129258, 1.4069498323369678, 1.4624419023061552, 1.5180654547831685, 1.5737794050364462, 1.629541864367312, 1.6853101815634264, 1.7410409893487966, 1.7966902558164133, 1.852213340838016, 1.9075650573857628, 1.9626997376999133, 2.017571304178012, 2.0721333448510126, 2.1263391932589415, 2.1801420125224236, 2.2334948833548918, 2.286350895734701, 2.338663243928951, 2.390385324500921, 2.4414708369429605, 2.4918738864964096, 2.5415490887372716, 2.5904516754446383, 2.638537601267532, 2.685763650674633, 2.732087544653372, 2.777468046622378, 2.8218650669981082, 2.86523976585934, 2.9075546531549534, 2.94877368589902, 2.9888623618077315, 3.0277878088533217, 3.06551887021822, 3.1020261841641084, 3.137282258358909, 3.171261538227832, 3.2039404689465645, 3.2352975507179416, 3.265313387029345, 3.2939707256289252, 3.321254492005765, 3.347151815215832, 3.37165204593598, 3.394746766699097, 3.4164297942874677, 3.436697174348996, 3.4555471683173353, 3.4729802327956025, 3.488998991582337, 3.50360820060161, 3.5168147059868593, 3.5286273956744716, 3.5390571448285777, 3.5481167555087567, 3.5558208909770292, 3.5621860050937815, 3.5672302672430933, 3.5709734832722604, 3.5734370129073545, 3.5746436841447013, 3.574617705088684, 3.5733845737291325, 3.5709709861266314, 3.5674047434770815, 3.5627146585006653, 3.5569304615963304, 3.5500827071781313, 3.5422026805807527, 3.5333223059221264, 3.5234740552516906, 3.5126908593171855, 3.5010060202450286, 3.4884531263902616, 3.475065969602592, 3.46087846512369, 3.4459245742761158, 3.4302382301323875, 3.4138532662612575, 3.396803348673205, 3.3791219110354542, 3.3608420932172423, 3.341996683185633, 3.3226180622815127, 3.3027381538468514, 3.282388375201728, 3.2615995929025643, 3.2404020812452083, 3.218825483938814, 3.196898778856261, 3.1746502457856707, 3.152107437072671, 3.12929715104332, 3.106245408097119, 3.082977429349598, 3.059517617695462, 3.0358895411736753, 3.012115918492708, 2.988218606598758, 2.9642185901518903, 2.940135972772151, 2.9159899699393588, 2.891798903408127, 2.8675801970241555, 2.8433503738006793, 2.8191250541572677, 2.7949189551815246, 2.7707458908208804, 2.746618772873244, 2.7225496126826454, 2.698549523436178, 2.674628722952044, 2.650796536873834, 2.6270614021680627, 2.60343087084447, 2.5799116138025546, 2.556509424732012, 2.533229223976141, 2.510075062286843, 2.487050124397816, 2.464156732336076, 2.441396348412006, 2.4187695778045137, 2.3962761706984304, 2.37391502388401, 2.351684181773561, 2.329580836767875, 2.307601328908393, 2.285741144767761, 2.26399491550372, 2.242356414036084, 2.220818551276871, 2.1993733713747132, 2.1780120458961827, 2.156724866915649, 2.1355012389449035, 2.1143296696602976, 2.0931977593720563, 2.072092189202124, 2.050998707904539, 2.0299021173166842, 2.008786256376238, 1.9876339836923385, 1.9664271586338211, 1.9451466209207124, 1.9237721687039855, 1.9022825351406314, 1.8806553634677925, 1.8588671806031576, 1.8368933693251877, 1.8147081390764153, 1.7922844955023387, 1.7695942088097327, 1.746607781118431, 1.723294412969617, 1.6996219692159142, 1.6755569445806862, 1.6510644291932997, 1.626108074507776, 1.6006500600599938, 1.574651061602289, 1.548070221262493, 1.5208651204511592, 1.4929917563724082, 1.4644045231103076, 1.4350561984137755, 1.4048979374342851, 1.3738792748593243, 1.3419481370394726, 1.3090508659217015, 1.275132256780831, 1.2401356119509654, 1.2040028130009262, 1.1666744139616214, 1.1280897584736993, 1.0881871238765661, 1.0469038954687149, 1.0041767742755003, 0.9599420217848709, 0.9141357451091237, 0.8666942260087684, 0.8175542970265404, 0.7666537677204488, 0.7139319035474601, 0.6593299593226909, 0.6027917683944506, 0.5442643876250597, 0.4836987969862039, 0.4210506510604062, 0.3562810779163261, 0.28935751881831173, 0.22025459989938323, 0.14895502452652587, 0.07545047243545655, -0.0002575108364322176, -0.07815665329499732, -0.15822314598262777, -0.24042090593448529, -0.32470093737868577, -0.4110008166151591, -0.4992443258731438, -0.5893412602062942, -0.6811874291948739, -0.7746648716280835, -0.8696422966682493, -0.9659757591751472, -1.0635095701055086, -1.1620774355411978, -1.2615038101312925, -1.361605443053887, -1.4621930873773559, -1.5630733373622197, -1.6640505531591576, -1.764928828855622, -1.8655139581339186, -1.9656153520044573, -2.0650478651833835, -2.1636334915274835, -2.2612028942916305, -2.3575967435124077, -2.4526668400611795, -2.5462770136350232, -2.638303789466001, -2.7286368257947444, -2.817179130549435, -2.9038470712046403, -2.9885701962072684, -3.071290889535172, -3.1519638821035088, -3.2305556446289017, -3.307043686629457, -3.381415785392333, -3.4536691672776842, -3.523809661731714, -3.5918508461612872, -3.657813197262466, -3.721723261957882, -3.78361285856349, -3.8435183164965414, -3.901479760673648, -3.957540444806229, -4.0117461361356686, -4.064144552678423, -4.114784852893405, -4.163717176692478, -4.210992235975125, -4.256660952282193, -4.300774138800922, -4.343382223639725, -4.384535011194818, -4.4242814783468365, -4.462669602270763, -4.499746216728634, -4.535556893829868, -4.570145848422857, -4.60355586245148, -4.635828226804834, -4.667002698397843, -4.697117470399914, -4.726209153746663, -4.754312768229796, -4.781461741666909, -4.807687915792669, -4.8330215576840025, -4.857491375671236, -4.88112453881101, -4.90394669913416, -4.925982015956537, -4.9472531816787955, -4.96778144855231, -4.98758665599569, -5.00668725808584, -5.0251003509381995, -5.04284169972638, -5.059925765150214, -5.076365729193316, -5.092173520059917, -5.107359836208302, -5.121934169432795, -5.135904826955972, -5.149278952540359, -5.1620625466258785, -5.174260485536819, -5.185876539793632, -5.196913391607855, -5.207372651620662, -5.217254874990779, -5.226559576903017, -5.235285247621152, -5.243429367196267, -5.250988419935071, -5.2579579087752295, -5.264332369678437, -5.270105386194906, -5.2752696043207035, -5.279816747817079, -5.283737634109664, -5.287022190938018, -5.2896594738954805, -5.291637685022221, -5.292944192585747, -5.293565552216106, -5.293487529540119, -5.292695124462898, -5.2911725972404895, -5.28890349647948, -5.2858706892109915, -5.2820563931550435, -5.277442211297445, -5.2720091688970845, -5.265737753014587, -5.258607954665428, -5.250599313653625, -5.241690966165502, -5.231861695157602, -5.221089983570737, -5.209354070377869, -5.196632009449475, -5.182901731213107, -5.1681411070376155, -5.152328016277574, -5.1354404158559515, -5.117456412267796, -5.0983543358394385, -5.0781128170714895, -5.056710864833335, -5.034127946196065, -5.0103440676242945, -4.985339857243254, -4.959096647864092, -4.931596560430629, -4.9028225875248355, -4.872758676550126, -4.841389812210162};
 float vel_track_d2[647]={0, 0.0, 3.678476005781639, 3.609710695350099, 3.5398883561019723, 3.469029623044406, 3.397155869270585, 3.3242892240992195, 3.2504525886238866, 3.175669648552093, 3.0999648842364724, 3.023363577785987, 2.945891817177748, 2.867576497256885, 2.788445317569943, 2.708526776944442, 2.6278501647648556, 2.5464455489032645, 2.4643437602575036, 2.3815763739016838, 2.2981756868316605, 2.21417469232843, 2.12960705097176, 2.0445070583612335, 1.9589096096018777, 1.8728501606637415, 1.786364686705233, 1.6994896374999957, 1.6122618901143193, 1.524718698992289, 1.4368976436415215, 1.3488365741146646, 1.2605735545055952, 1.172146804690244, 1.0835946405556296, 0.9949554129815574, 0.90626744582889, 0.817568973225602, 0.7288980764130759, 0.6402926204648329, 0.5517901911352707, 0.46342803215804196, 0.37524298325686267, 0.2872714191660686, 0.19954918992903803, 0.11211156275292566, 0.024993165664843886, -0.06177206677560054, -0.1481509454723806, -0.23411107629334182, -0.3196209068572209, -0.40464977044196715, -0.4891679268356208, -0.5731465999997409, -0.65655801241149, -0.7393754159865651, -0.8215731195038156, -0.9031265124673782, -0.9840120853680245, -1.0642074463285134, -1.1436913341305033, -1.222443627640124, -1.300445351688606, -1.377678679434391, -1.454126931316413, -1.5297745706509547, -1.6046071960051922, -1.6786115304353588, -1.751775407740741, -1.8240877558437507, -1.8955385774653832, -1.9661189282258462, -2.0358208923378918, -2.1046375560529462, -2.1725629790252388, -2.2395921637463623, -2.3057210232394487, -2.370946347153735, -2.435265766437822, -2.498677716750719, -2.5611814007601152, -2.6227767494910736, -2.683464382860268, -2.7432455695519664, -2.8021221863566703, -2.860096677115953, -2.9171720113776445, -2.973351642895139, -3.0286394680610895, -3.083039784381403, -3.1365572490852367, -3.1891968379391678, -3.240963804357344, -3.29186363886258, -3.341902028960897, -3.3910848194884657, -3.439417973454484, -3.4869075334456046, -3.5335595835923606, -3.579380212139327, -3.6243754746264623, -3.6685513576916184, -3.711913743499773, -3.75446837478588, -3.7962208205231107, -3.8371764421728516, -3.877340360526005, -3.9167174230865243, -3.9553121719839712, -3.9931288123709052, -4.0301711812683605, -4.066442716823326, -4.1019464279142825, -4.136684864074147, -4.170660085655586, -4.203873634197941, -4.236326502914389, -4.268019107255827, -4.29895125545765, -4.329122119017259, -4.358530203017352, -4.387173316210968, -4.415048540807653, -4.4421522018418536, -4.468479836073458, -4.494026160301923, -4.518785039017703, -4.542749451283412, -4.565911456760219, -4.5882621607724605, -4.609791678303221, -4.630489096833057, -4.6503424379020775, -4.669338617299346, -4.687463403773795, -4.704701376153531, -4.721035878779145, -4.7364489751402505, -4.75092139962785, -4.764432507284866, -4.776960221492654, -4.788480979483478, -4.798969675633091, -4.8083996024372855, -4.8167423891624095, -4.823967938097362, -4.830044358440921, -4.834937897791269, -4.838612871323977, -4.8410315887057465, -4.84215427887591, -4.841939012870444, -4.840341624886779, -4.837315631906036, -4.832812152217869, -4.826779823295491, -4.819164719586377, -4.809910270856532, -4.798957181900542, -4.78624335454203, -4.7717038130262734, -4.755270634097308, -4.736872883252363, -4.716436558907744, -4.6938845464353784, -4.66913658437279, -4.642109245334813, -4.612715934584566, -4.580866909482839, -4.546469323509661, -4.509427298878377, -4.469642032247589, -4.427011938420266, -4.381432837348875, -4.3327981902175905, -4.280999390712026, -4.225926117946199, -4.167466757788674, -4.105508899475529, -4.039939914461832, -3.9706476242873934, -3.8975210639178304, -3.820451346397913, -3.7393326337274435, -3.6540632176031984, -3.564546711981642, -3.4706933572488663, -3.37242143320321, -3.2696587748123895, -3.162344381137938, -3.050430103566315, -2.9338823949008885, -2.81268409589408, -2.686836230594125, -2.5563597766610213, -2.421297371773934, -2.281714912671373, -2.137702999647162, -1.9893781766138763, -1.8368839157967831, -1.6803912966689705, -1.5200993315732658, -1.3562348955249437, -1.189052225085807, -1.0188319610651142, -0.8458797217393288, -0.6705242069592887, -0.49311484854369647, -0.3140190378066454, -0.1336189764065132, 0.047691789110515526, 0.22951207634491766, 0.4114369372332227, 0.5930616005521694, 0.7739853950346487, 0.9538155624995714, 1.1321708751160786, 1.3086849791760224, 1.483009398868751, 1.654816146875071, 1.823799903351575, 1.9896797402371158, 2.152200382881053, 2.3111330152128517, 2.46627564727786, 2.6174530746422286, 2.7645164676292633, 2.9073426344049524, 3.0458330057086536, 3.1799123907039206, 3.3095275530921064, 3.4346456547875714, 3.5552526113614147, 3.6713513993248403, 3.782960350767972, 3.890111465807644, 3.9928487683328906, 4.091226725565777, 4.185308747354843, 4.27516577688325, 4.360874980650631, 4.442518542329854, 4.5201825622796505, 4.5939560621969795, 4.663930092503487, 4.73019693866128, 4.792849421481726, 4.8519802857910905, 4.907681671277642, 4.9600446591418486, 5.009158888056642, 5.055112233043501, 5.097990541062192, 5.13787741734667, 5.174854056903377, 5.208999115906276, 5.240388618137081, 5.269095892018849, 5.295191534171573, 5.318743395812953, 5.339816588691814, 5.358473507609318, 5.374773866872684, 5.388774748370905, 5.400530659216751, 5.410093597158938, 5.417513122207007, 5.4228364331012076, 5.426108447485089, 5.427371884751064, 5.426667350735492, 5.42403342351816, 5.4195067397531105, 5.4131220809928715, 5.404912459629485, 5.394909204088361, 5.383142043025924, 5.36963918830935, 5.354427416622509, 5.337532149579105, 5.318977532260294, 5.29878651012583, 5.276980904260209, 5.253581484969239, 5.228608043717942, 5.202079463434206, 5.17401378722826, 5.144428285549951, 5.113339521843674, 5.080763416750345, 5.046715310897176, 5.011210026349744, 4.974261926754542, 4.935884976237759, 4.896092797101237, 4.854898726351475, 4.8123158711104175, 4.768357162932224, 4.723035411042353, 4.676363354545465, 4.628353713574507, 4.579019239418725, 4.52837276360929, 4.476427245955428, 4.423195821508297, 4.36869184642652, 4.312928942718952, 4.255921041788291, 4.197682426764215, 4.138227773533454, 4.077572190416601, 4.015731256407751, 3.9527210579036742, 3.8885582238213923, 3.8232599590291017, 3.756844075961552, 3.6893290243524834, 3.620733918944463, 3.5510785650769705, 3.480383482048044, 3.4086699241185903, 3.3359598990585493, 3.262276184113344, 3.1876423392823705, 3.112082717806164, 3.035622473749111, 2.9582875665912223, 2.88010476273437, 2.8011016338422845, 2.7213065519419155, 2.640748681232097, 2.559457966544443, 2.477465118427502, 2.3948015948364043, 2.3114995794191184, 2.2275919564166413, 2.1431122822078708, 2.0580947535508987, 1.972574172577235, 1.8865859086443226, 1.8001658571316081, 1.7133503953236096, 1.6261763355090997, 1.5386808754720427, 1.4509015465444808, 1.362876159424542, 1.2746427479750633, 1.1862395112257618, 1.0977047538296425, 1.0090768252223326, 0.9203940577513503, 0.8316947040560851, 0.7430168739652743, 0.6543984712138462, 0.5658771302561316, 0.4774901534688736, 0.3892744490334721, 0.3012664697737977, 0.21350215323501232, 0.12601686327118333, 0.038845333399151194, -0.047978387832214864, -0.1344209892206738, -0.22044994681724717, -0.30603357116454344, -0.3911410516677094, -0.4757424979505709, -0.5598089780270987, -0.6433125531865036, -0.7262263094625077, -0.8085243856231772, -0.8901819975987157, -0.9711754593242361, -1.05148219995721, -1.131080777478255, -1.209950888696354, -1.288073375677934, -1.3654302286788544, -1.4420045856229358, -1.517780728235718, -1.5927440749170518, -1.6668811704785291, -1.740179672853337, -1.812628336936073, -1.8842169956705401, -1.9549365385518325, -2.0247788876965878, -2.0937369716323984, -2.1618046969792415, -2.228976918191683, -2.295249405503741, -2.360618811279358, -2.4250826348973797, -2.488639186350561, -2.551287548713921, -2.61302753963355, -2.6738596719798613, -2.7337851138213853, -2.7928056478377927, -2.850923630320912, -2.90814194986877, -2.9644639858985578, -3.0198935670887606, -3.0744349298381657, -3.12809267684655, -3.1808717358949856, -3.232777318903035, -3.2838148813265633, -3.333990081968108, -3.3833087432392217, -3.431776811929632, -3.4794003205123047, -3.5261853490217154, -3.5721379875299775, -3.6172642992244874, -3.661570284115623, -3.705061843360169, -3.747744744218129, -3.7896245856083866, -3.8307067642794346, -3.870996441546426, -3.9104985106031, -3.949217564341634, -3.9871578636787586, -4.024323306337063, -4.060717396030977, -4.096343212030118, -4.131203379026838, -4.165300037272668, -4.198634812911939, -4.231208788462282, -4.263022473361411, -4.294075774525674, -4.324367966846765, -4.35389766353711, -4.38266278626942, -4.410660535001276, -4.4378873574288935, -4.464338917963273, -4.490010066142247, -4.514894804395486, -4.5389862550535565, -4.562276626521422, -4.584757178496712, -4.606418186147709, -4.627248903136261, -4.647237523401793, -4.6663711415653175, -4.684635711887597, -4.702016005647791, -4.71849556685533, -4.7340566661745465, -4.748680252988358, -4.762345905468757, -4.775031778600836, -4.786714550049753, -4.797369363804371, -4.806969771532499, -4.815487671599117, -4.822893245707727, -4.8291548931569395, -4.834239162718911, -4.838110682170438, -4.840732085570232, -4.842063938363228, -4.842064660508127, -4.840690447798834, -4.8378951917014135, -4.833630398022703, -4.827845104851624, -4.820485800325458, -4.8114963408395495, -4.800817870474483, -4.788388742569427, -4.774144444483041, -4.758017526843239, -4.739937538701278, -4.719830970310534, -4.6976212054477, -4.673228485522595, -4.646569887963802, -4.617559321762054, -4.586107543366191, -4.552122196521957, -4.515507880058333, -4.476166247995295, -4.43399614685458, -4.388893795393312, -4.340753012470611, -4.289465499096923, -4.234921181103024, -4.177008619105582, -4.115615492676472, -4.0506291656216, -3.9819373392359636, -3.909428800026038, -3.8329942678681506, -3.7525273496902267, -3.667925602531985, -3.5790917082492713, -3.4859347600351698, -3.388371658367584, -3.286328610960676, -3.179742727651147, -3.0685636971162777, -2.9527555277040207, -2.8322983297917603, -2.7071901118459474, -2.577448557216533, -2.4431127435158295, -2.304244761827834, -2.160931189108095, -2.0132843642124976, -1.861443416667885, -1.7055749975850576, -1.5458736645747595, -1.382561877134536, -1.2158895661404934, -1.0461332504344, -0.8735946851397003, -0.698599039869463, -0.521492619708408, -0.3426401573851101, -0.1624217204184153, 0.018770708536397507, 0.20053690723048634, 0.38247226417637004, 0.5641717157389703, 0.7452336784807279, 0.9252638857216722, 1.1038790414489297, 1.2807102124199332, 1.4554058900034805, 1.6276346663755548, 1.7970874841670148, 1.9634794341236717, 2.126551090341433, 2.2860693871886717, 2.441828054813411, 2.593647641194907, 2.7413751575323664, 2.8848833901202187, 3.0240699261438464, 3.1588559426514173, 3.289184808056067, 3.415020543865721, 3.5363461913747174, 3.6531621241102097, 3.765484342323655, 3.873342780759903, 3.9767796560112867, 4.0758478747328075, 4.170609519352886, 4.261134423599655, 4.347498846285102, 4.4297842484377625, 4.5080761759628825, 4.582463247666757, 4.6530362465079245, 4.7198873104636325, 4.783109218223558, 4.84279476419519, 4.899036216678754, 4.951924852883205, 5.001550564277646, 5.048001525870038, 5.091363923168168, 5.131721730820993, 5.169156537283226, 5.203747410191473, 5.235570797534339, 5.2647004600916425, 5.291207431025679, 5.315159998871333, 5.3366237105699765, 5.355661391528321, 5.372333180019228, 5.386696573551674, 5.398806485113094, 5.408715307453404, 5.416472983821807, 5.422127083742456, 5.425722882670292, 5.427303444471232, 5.4269097058728955, 5.42458056213746, 5.420352953332985, 5.414261950698274, 5.406340842664226, 5.396621220190023, 5.385133061129199, 5.371904813419537, 5.356963476917387, 5.340334683752945, 5.322042777124225, 5.302110888464662, 5.280561012966034, 5.25741408342717, 5.23269004245952, 5.206407913046274, 5.178585867517738, 5.149241294948315, 5.11839086704724, 5.0860506025923735, 5.052235930438909, 5.0169617511820475, 4.980242497502174, 4.942092193264691, 4.902524511394057, 4.861552830598304, 4.819190290948683, 4.775449848367419, 4.73034432804198, 4.683886476791299, 4.6360890143897215, 4.586964683849781, 4.536526300679911, 4.4847868010852165, 4.431759289109549, 4.377457082671454, 4.321893758491346, 4.265083195830077, 4.207039619018582, 4.147777638699002, 4.087312291720102, 4.025659079616384, 3.9628340055788414, 3.8988536098379933, 3.8337350033651463, 3.767495899792417, 3.700154645445708, 3.63173024738328, 3.5622423993344476, 3.4917115054192704, 3.420158701538778, 3.347605874318149, 3.2740756774914948, 3.1995915456164425, 3.124177705014941, 3.0478591818214884, 2.970661807059627, 2.8926122186446745, 2.813737860233645, 2.7340669768457504, 2.653628607200309, 2.5724525727112146, 2.4905694631126574, 2.4080106186920025};
 //*********velocity desired arry***********//
float time_vectt=0;


/*********fxn var***********/
float d_theta1=0;
float d_theta2=0;
float vd_theta1=0;
float vd_theta2=0;
/*********fxn var***********/
/* USER CODE END PV */

/* Private function prototypes -----------------------------------------------*/
void SystemClock_Config(void);
static void MX_GPIO_Init(void);
static void MX_ADC1_Init(void);
static void MX_ADC2_Init(void);
static void MX_TIM3_Init(void);
static void MX_TIM4_Init(void);
static void MX_TIM5_Init(void);
static void MX_USART3_UART_Init(void);
static void MX_TIM9_Init(void);
/* USER CODE BEGIN PFP */

/* USER CODE END PFP */

/* Private user code ---------------------------------------------------------*/
/* USER CODE BEGIN 0 */
#include"impl_tsk.h"

int _write(int file, char *ptr, int len){

	/* Implement your write code here, this is used by puts and printf for example */
	int i=0;
	for (i=0; i<len; i++){
		ITM_SendChar((ptr++));
	}
	return len;

}

void HAL_TIM_PeriodElapsedCallback(TIM_HandleTypeDef* htim)
{
	  timeblock+=65535;
}

void Motor_control_1(int PWM,int cap) {
  if (PWM >= 0) {
    HAL_GPIO_WritePin(GPIOD, GPIO_PIN_12, GPIO_PIN_RESET);
  }
  else if (PWM < 0) {
    HAL_GPIO_WritePin(GPIOD, GPIO_PIN_12, GPIO_PIN_SET);
  }
  if (fabs(PWM) > cap) {
    PWM = cap;
  }

  TIM4->CCR3 = fabs(PWM);
HAL_TIM_PWM_Start(&htim4, TIM_CHANNEL_3);
}

void Motor_control_2(int PWM,int cap) {
  if (PWM >= 0) {
    HAL_GPIO_WritePin(GPIOD, GPIO_PIN_13, GPIO_PIN_SET);
  }
  else if (PWM < 0) {
    HAL_GPIO_WritePin(GPIOD, GPIO_PIN_13, GPIO_PIN_RESET);
  }
  if (fabs(PWM) > cap) {
    PWM = cap;
  }

  TIM4->CCR4 = fabs(PWM);
  HAL_TIM_PWM_Start(&htim4, TIM_CHANNEL_4);
}
/* USER CODE END 0 */

/**
  * @brief  The application entry point.
  * @retval int
  */
int main(void)
{
  /* USER CODE BEGIN 1 */
	char msg[10];
  /* USER CODE END 1 */

  /* MCU Configuration--------------------------------------------------------*/

  /* Reset of all peripherals, Initializes the Flash interface and the Systick. */
  HAL_Init();

  /* USER CODE BEGIN Init */

  /* USER CODE END Init */

  /* Configure the system clock */
  SystemClock_Config();

  /* USER CODE BEGIN SysInit */
  ITM_Port32(31)=1;
  /* USER CODE END SysInit */

  /* Initialize all configured peripherals */
  MX_GPIO_Init();
  MX_ADC1_Init();
  MX_ADC2_Init();
  MX_TIM3_Init();
  MX_TIM4_Init();
  MX_TIM5_Init();
  MX_USART3_UART_Init();
  MX_TIM9_Init();
  /* USER CODE BEGIN 2 */
  ITM_Port32(31) = 2;

  HAL_TIM_Encoder_Start_IT(&htim3, TIM_CHANNEL_ALL);
    HAL_TIM_Encoder_Start_IT(&htim5, TIM_CHANNEL_ALL);
    HAL_TIM_Base_Start_IT(&htim9);
  //set timer to some intial value to remove the bounce
    TIM3->CNT=32767;
    TIM5->CNT=32767;

    for(int i=0;i<200;i++){
    	  HAL_ADC_Start(&hadc1);
    	  HAL_ADC_PollForConversion(&hadc1, HAL_MAX_DELAY);
    	  raw = HAL_ADC_GetValue(&hadc1);
    	  inivolt+=(raw*3.3/ 4096);
      }
      inivolt=inivolt/200;

      for(int i=0;i<200;i++){
       	  HAL_ADC_Start(&hadc2);
       	  HAL_ADC_PollForConversion(&hadc2, HAL_MAX_DELAY);
       	  raw = HAL_ADC_GetValue(&hadc2);
       	  inivolt2+=(raw*3.3/ 4096);
	 }
	 inivolt2=inivolt2/200;

  /* USER CODE END 2 */

  /* Infinite loop */
  /* USER CODE BEGIN WHILE */
  while (1)
  {
    /* USER CODE END WHILE */

    /* USER CODE BEGIN 3 */

////////////////////////////////////////////////current_start//////////////////////////////////////////////
//cuiwali motor2
// ADC conversion
	HAL_ADC_Start(&hadc1);
	HAL_ADC_PollForConversion(&hadc1, HAL_MAX_DELAY);
	raw = HAL_ADC_GetValue(&hadc1);
	volt=(raw*3.3/ 4096);
	current2=(inivolt-volt)*10  + 0.2;
// Kalman Filtering
	old_estimate2=estimate2;
    measurement2=current2; // current measurement
    kalman_gain2= estimate_variance2/(estimate_variance2+measurement_variance2); // Kalman gain
    estimate2=estimate2 + kalman_gain2*(measurement2-estimate2); // update in estimate
    estimate_variance2=(1-kalman_gain2)*(estimate_variance2) + fabs(old_estimate2-estimate2)*estimate_measurement_weight2;  //update in estimate variance


// control loop
	  E_rror_m2 = D_current2 - estimate2;
	  P_wm_m2=kp2*E_rror_m2;
	  Motor_control_2(P_wm_m2,1000);



//robokits motor1
// ADC conversion
	HAL_ADC_Start(&hadc2);
	HAL_ADC_PollForConversion(&hadc2, HAL_MAX_DELAY);
	raw2 = HAL_ADC_GetValue(&hadc2);
	volt2=(raw2*3.3/ 4096);
	current=(inivolt2-volt2)*10;
// Kalman Filtering
	old_estimate=estimate;
    measurement=current; // current measurement
    kalman_gain= estimate_variance/(estimate_variance+measurement_variance); // Kalman gain
    estimate=estimate + kalman_gain*(measurement-estimate); // update in estimate
	estimate_variance=(1-kalman_gain)*(estimate_variance) + fabs(old_estimate-estimate)*estimate_measurement_weight;  //update in estimate
// control loop
	  E_rror_m1 = D_current - estimate;
	  P_wm_m1=kp*E_rror_m1;
	  Motor_control_1(P_wm_m1,1000);
////////////////////////////////////////////////current_end//////////////////////////////////////////////
////////////////////////////////////////////////th and thdot_start///////////////////////////////////////
//read encoder
	  raw_enc1=(TIM3->CNT);
	  raw_enc2=(TIM5->CNT);
	if(raw_enc1 != prev_enc1){
		real_enc1+=(raw_enc1-prev_enc1);
		prev_enc1=raw_enc1;
	}
	if(raw_enc2 != prev_enc2){
		real_enc2+=(raw_enc2-prev_enc2);
		prev_enc2=raw_enc2;
	}

	  eth2=(real_enc1/(2*4096))*6.28;
	  eth1=-(real_enc2/2000)*6.28;

	  th1=eth1+ spth1;
	  th2=eth2-th1+spth2 + spth1;


	  //////////////th_dot
	  now_time=__HAL_TIM_GET_COUNTER(&htim9)+timeblock;
	  D_t=now_time-prev_time;
	  DE_rrorm1=((th1-prev_th1)/D_t)*10E6;
	  DE_rrorm2=((th2-prev_th2)/D_t)*10E6;

	  prev_th1=th1;
	  prev_th2=th2;
	  prev_time=now_time;


	  // Kalman Filtering
		old_estimate3=estimate3;
		measurement3=DE_rrorm1; // current measurement
		kalman_gain3= estimate_variance3/(estimate_variance3+measurement_variance3); // Kalman gain
		estimate3=estimate3 + kalman_gain3*(measurement3-estimate3); // update in estimate
		estimate_variance3=(1-kalman_gain3)*(estimate_variance3) + fabs(old_estimate3-estimate3)*estimate_measurement_weight3;  //update in estimate variance

		// Kalman Filtering
		old_estimate4=estimate4;
		measurement4=DE_rrorm2; // current measurement
		kalman_gain4= estimate_variance4/(estimate_variance4+measurement_variance4); // Kalman gain
		estimate4=estimate4 + kalman_gain4*(measurement4-estimate4); // update in estimate
		estimate_variance4=(1-kalman_gain4)*(estimate_variance4) + fabs(old_estimate4-estimate4)*estimate_measurement_weight4;  //update in estimate variance

////////////////////////////////////////////////th and thdot_end///////////////////////////////////////

/////////////////////////////////tracj_sec_strt////////////////////////////////////////////////////
		data+=0.005;
	    arr_indx=data;
	    time_vectt+=0.002*arr_indx;
////////////////////////////////me implemetation////////////////////////////////////////////////////
//	    if(data>=500){
//	    	if(flag==0){
//	    		t1ini=th1;
//	    		t2ini=th2;
//	    		t1fi=1.57;
//	    		t2fi=0;
//	    		flag=1;
//	    	}
//	    	int arr_indx_1=arr_indx-500;
//	    	thd1=t1ini + 3*(t1fi-t1ini)*trac_tvect[arr_indx_1]*trac_tvect[arr_indx_1] - 2*(t1fi-t1ini)*trac_tvect[arr_indx_1]*trac_tvect[arr_indx_1]*trac_tvect[arr_indx_1];
//	    	thd2=t2ini + 3*(t2fi-t2ini)*trac_tvect[arr_indx_1]*trac_tvect[arr_indx_1] - 2*(t2fi-t2ini)*trac_tvect[arr_indx_1]*trac_tvect[arr_indx_1]*trac_tvect[arr_indx_1];
//	    	vel_DError_d1=6*(t1fi-t1ini)*trac_tvect[arr_indx_1]-6*(t1fi-t1ini)*trac_tvect[arr_indx_1]*trac_tvect[arr_indx_1];
//	    	vel_DError_d2=6*(t2fi-t2ini)*trac_tvect[arr_indx_1]-6*(t2fi-t2ini)*trac_tvect[arr_indx_1]*trac_tvect[arr_indx_1];
//
//	    	if(data>=1000){
//	    		data=1;
//	    		Motor_control_1(0,800);
//	    		Motor_control_2(0,800);
//	    		flag=0;
//	    		HAL_Delay(1000);
//	    	}
//	    }
//	    else{
//	    	thd1=thd1_trac[arr_indx];
//	    	thd2=thd2_trac[arr_indx];
//	    	vel_DError_d1=vel_track_d1[arr_indx];
//	    	vel_DError_d2=vel_track_d2[arr_indx];
//	    }
///////////////////////////////////////////////////////////////////////////////////////////////////////
//	    D_current= (0.8*(thd1-th1))*10+ (vel_DError_d1-estimate3)*0.001;							/////
//	   	D_current2= (0.8*(thd2-th2))*10 +(vel_DError_d2-estimate4)*0.001;							/////
//////////////////////////////me implemetation done////////////////////////////////////////////////////

//	  D_current= (1*(thd1-th1))*10+ (vel_DError_d1-estimate3)*0.000;
//	  D_current2= (1*(thd2-th2))*10 +(vel_DError_d2-estimate4)*0.000;

/////////////////////////////////tracj_sec_clsd////////////////////////////////////////////////////
	  sprintf(msg, "%d\r\n",arr_indx);
	  HAL_UART_Transmit(&huart3, (uint8_t*)msg, strlen(msg), HAL_MAX_DELAY);


//*************************implementation tsk1**************************//

	  float des_m1_crnt=0;
	  float des_m2_crnt=0;
	  motor_trqctrl(&des_m1_crnt,&des_m2_crnt);
	  D_current=des_m1_crnt;
	  D_current2=des_m2_crnt;

//*************************implementation tsk1 end**************************//

//*************************implementation tsk2**************************//

//	  traj_ctrl(&d_theta1,&d_theta2,&vd_theta1,&vd_theta2);
//	  thd1=d_theta1;
//	  thd2=d_theta2;
//	  vel_DError_d1=vd_theta1;
//	  vel_DError_d2=vd_theta2;
//	  //for ellipse
//	  D_current= (0.9*(thd1-th1))*10+ (vel_DError_d1-estimate3)*0.001;
//	  D_current2= (0.9*(thd2-th2))*10 +(vel_DError_d2-estimate4)*0.001;
	  //for aplha
//	  D_current= (0.95*(thd1-th1))*10+ (vel_DError_d1-estimate3)*0.00085;
//	  D_current2= (0.95*(thd2-th2))*10 +(vel_DError_d2-estimate4)*0.00085;

//*************************implementation tsk2 end**************************//

	  ////////////////////////////test zone///////////////////////////
//	  Motor_control_1(-100,800);
//	  Motor_control_2(100,800);
//	  D_current=0;//m1
//	  D_current2=0;//m2
//    D_current= (1*(0-th1))*10;
//    D_current2= (1*(0-th2))*10;
	  ////////////////////////////test zone///////////////////////////

  }
  /* USER CODE END 3 */
}

/**
  * @brief System Clock Configuration
  * @retval None
  */
void SystemClock_Config(void)
{
  RCC_OscInitTypeDef RCC_OscInitStruct = {0};
  RCC_ClkInitTypeDef RCC_ClkInitStruct = {0};

  /** Configure the main internal regulator output voltage
  */
  __HAL_RCC_PWR_CLK_ENABLE();
  __HAL_PWR_VOLTAGESCALING_CONFIG(PWR_REGULATOR_VOLTAGE_SCALE1);

  /** Initializes the RCC Oscillators according to the specified parameters
  * in the RCC_OscInitTypeDef structure.
  */
  RCC_OscInitStruct.OscillatorType = RCC_OSCILLATORTYPE_HSE;
  RCC_OscInitStruct.HSEState = RCC_HSE_ON;
  RCC_OscInitStruct.PLL.PLLState = RCC_PLL_ON;
  RCC_OscInitStruct.PLL.PLLSource = RCC_PLLSOURCE_HSE;
  RCC_OscInitStruct.PLL.PLLM = 8;
  RCC_OscInitStruct.PLL.PLLN = 336;
  RCC_OscInitStruct.PLL.PLLP = RCC_PLLP_DIV2;
  RCC_OscInitStruct.PLL.PLLQ = 7;
  if (HAL_RCC_OscConfig(&RCC_OscInitStruct) != HAL_OK)
  {
    Error_Handler();
  }

  /** Initializes the CPU, AHB and APB buses clocks
  */
  RCC_ClkInitStruct.ClockType = RCC_CLOCKTYPE_HCLK|RCC_CLOCKTYPE_SYSCLK
                              |RCC_CLOCKTYPE_PCLK1|RCC_CLOCKTYPE_PCLK2;
  RCC_ClkInitStruct.SYSCLKSource = RCC_SYSCLKSOURCE_PLLCLK;
  RCC_ClkInitStruct.AHBCLKDivider = RCC_SYSCLK_DIV1;
  RCC_ClkInitStruct.APB1CLKDivider = RCC_HCLK_DIV4;
  RCC_ClkInitStruct.APB2CLKDivider = RCC_HCLK_DIV2;

  if (HAL_RCC_ClockConfig(&RCC_ClkInitStruct, FLASH_LATENCY_5) != HAL_OK)
  {
    Error_Handler();
  }
}

/**
  * @brief ADC1 Initialization Function
  * @param None
  * @retval None
  */
static void MX_ADC1_Init(void)
{

  /* USER CODE BEGIN ADC1_Init 0 */

  /* USER CODE END ADC1_Init 0 */

  ADC_ChannelConfTypeDef sConfig = {0};

  /* USER CODE BEGIN ADC1_Init 1 */

  /* USER CODE END ADC1_Init 1 */

  /** Configure the global features of the ADC (Clock, Resolution, Data Alignment and number of conversion)
  */
  hadc1.Instance = ADC1;
  hadc1.Init.ClockPrescaler = ADC_CLOCK_SYNC_PCLK_DIV4;
  hadc1.Init.Resolution = ADC_RESOLUTION_12B;
  hadc1.Init.ScanConvMode = DISABLE;
  hadc1.Init.ContinuousConvMode = DISABLE;
  hadc1.Init.DiscontinuousConvMode = DISABLE;
  hadc1.Init.ExternalTrigConvEdge = ADC_EXTERNALTRIGCONVEDGE_NONE;
  hadc1.Init.ExternalTrigConv = ADC_SOFTWARE_START;
  hadc1.Init.DataAlign = ADC_DATAALIGN_RIGHT;
  hadc1.Init.NbrOfConversion = 1;
  hadc1.Init.DMAContinuousRequests = DISABLE;
  hadc1.Init.EOCSelection = ADC_EOC_SINGLE_CONV;
  if (HAL_ADC_Init(&hadc1) != HAL_OK)
  {
    Error_Handler();
  }

  /** Configure for the selected ADC regular channel its corresponding rank in the sequencer and its sample time.
  */
  sConfig.Channel = ADC_CHANNEL_14;
  sConfig.Rank = 1;
  sConfig.SamplingTime = ADC_SAMPLETIME_3CYCLES;
  if (HAL_ADC_ConfigChannel(&hadc1, &sConfig) != HAL_OK)
  {
    Error_Handler();
  }
  /* USER CODE BEGIN ADC1_Init 2 */

  /* USER CODE END ADC1_Init 2 */

}

/**
  * @brief ADC2 Initialization Function
  * @param None
  * @retval None
  */
static void MX_ADC2_Init(void)
{

  /* USER CODE BEGIN ADC2_Init 0 */

  /* USER CODE END ADC2_Init 0 */

  ADC_ChannelConfTypeDef sConfig = {0};

  /* USER CODE BEGIN ADC2_Init 1 */

  /* USER CODE END ADC2_Init 1 */

  /** Configure the global features of the ADC (Clock, Resolution, Data Alignment and number of conversion)
  */
  hadc2.Instance = ADC2;
  hadc2.Init.ClockPrescaler = ADC_CLOCK_SYNC_PCLK_DIV4;
  hadc2.Init.Resolution = ADC_RESOLUTION_12B;
  hadc2.Init.ScanConvMode = DISABLE;
  hadc2.Init.ContinuousConvMode = DISABLE;
  hadc2.Init.DiscontinuousConvMode = DISABLE;
  hadc2.Init.ExternalTrigConvEdge = ADC_EXTERNALTRIGCONVEDGE_NONE;
  hadc2.Init.ExternalTrigConv = ADC_SOFTWARE_START;
  hadc2.Init.DataAlign = ADC_DATAALIGN_RIGHT;
  hadc2.Init.NbrOfConversion = 1;
  hadc2.Init.DMAContinuousRequests = DISABLE;
  hadc2.Init.EOCSelection = ADC_EOC_SINGLE_CONV;
  if (HAL_ADC_Init(&hadc2) != HAL_OK)
  {
    Error_Handler();
  }

  /** Configure for the selected ADC regular channel its corresponding rank in the sequencer and its sample time.
  */
  sConfig.Channel = ADC_CHANNEL_8;
  sConfig.Rank = 1;
  sConfig.SamplingTime = ADC_SAMPLETIME_3CYCLES;
  if (HAL_ADC_ConfigChannel(&hadc2, &sConfig) != HAL_OK)
  {
    Error_Handler();
  }
  /* USER CODE BEGIN ADC2_Init 2 */

  /* USER CODE END ADC2_Init 2 */

}

/**
  * @brief TIM3 Initialization Function
  * @param None
  * @retval None
  */
static void MX_TIM3_Init(void)
{

  /* USER CODE BEGIN TIM3_Init 0 */

  /* USER CODE END TIM3_Init 0 */

  TIM_Encoder_InitTypeDef sConfig = {0};
  TIM_MasterConfigTypeDef sMasterConfig = {0};

  /* USER CODE BEGIN TIM3_Init 1 */

  /* USER CODE END TIM3_Init 1 */
  htim3.Instance = TIM3;
  htim3.Init.Prescaler = 0;
  htim3.Init.CounterMode = TIM_COUNTERMODE_UP;
  htim3.Init.Period = 65535;
  htim3.Init.ClockDivision = TIM_CLOCKDIVISION_DIV1;
  htim3.Init.AutoReloadPreload = TIM_AUTORELOAD_PRELOAD_DISABLE;
  sConfig.EncoderMode = TIM_ENCODERMODE_TI1;
  sConfig.IC1Polarity = TIM_ICPOLARITY_RISING;
  sConfig.IC1Selection = TIM_ICSELECTION_DIRECTTI;
  sConfig.IC1Prescaler = TIM_ICPSC_DIV1;
  sConfig.IC1Filter = 0;
  sConfig.IC2Polarity = TIM_ICPOLARITY_RISING;
  sConfig.IC2Selection = TIM_ICSELECTION_DIRECTTI;
  sConfig.IC2Prescaler = TIM_ICPSC_DIV1;
  sConfig.IC2Filter = 0;
  if (HAL_TIM_Encoder_Init(&htim3, &sConfig) != HAL_OK)
  {
    Error_Handler();
  }
  sMasterConfig.MasterOutputTrigger = TIM_TRGO_RESET;
  sMasterConfig.MasterSlaveMode = TIM_MASTERSLAVEMODE_DISABLE;
  if (HAL_TIMEx_MasterConfigSynchronization(&htim3, &sMasterConfig) != HAL_OK)
  {
    Error_Handler();
  }
  /* USER CODE BEGIN TIM3_Init 2 */

  /* USER CODE END TIM3_Init 2 */

}

/**
  * @brief TIM4 Initialization Function
  * @param None
  * @retval None
  */
static void MX_TIM4_Init(void)
{

  /* USER CODE BEGIN TIM4_Init 0 */

  /* USER CODE END TIM4_Init 0 */

  TIM_MasterConfigTypeDef sMasterConfig = {0};
  TIM_OC_InitTypeDef sConfigOC = {0};

  /* USER CODE BEGIN TIM4_Init 1 */

  /* USER CODE END TIM4_Init 1 */
  htim4.Instance = TIM4;
  htim4.Init.Prescaler = 84;
  htim4.Init.CounterMode = TIM_COUNTERMODE_UP;
  htim4.Init.Period = 1000;
  htim4.Init.ClockDivision = TIM_CLOCKDIVISION_DIV1;
  htim4.Init.AutoReloadPreload = TIM_AUTORELOAD_PRELOAD_DISABLE;
  if (HAL_TIM_PWM_Init(&htim4) != HAL_OK)
  {
    Error_Handler();
  }
  sMasterConfig.MasterOutputTrigger = TIM_TRGO_RESET;
  sMasterConfig.MasterSlaveMode = TIM_MASTERSLAVEMODE_DISABLE;
  if (HAL_TIMEx_MasterConfigSynchronization(&htim4, &sMasterConfig) != HAL_OK)
  {
    Error_Handler();
  }
  sConfigOC.OCMode = TIM_OCMODE_PWM1;
  sConfigOC.Pulse = 0;
  sConfigOC.OCPolarity = TIM_OCPOLARITY_HIGH;
  sConfigOC.OCFastMode = TIM_OCFAST_DISABLE;
  if (HAL_TIM_PWM_ConfigChannel(&htim4, &sConfigOC, TIM_CHANNEL_3) != HAL_OK)
  {
    Error_Handler();
  }
  if (HAL_TIM_PWM_ConfigChannel(&htim4, &sConfigOC, TIM_CHANNEL_4) != HAL_OK)
  {
    Error_Handler();
  }
  /* USER CODE BEGIN TIM4_Init 2 */

  /* USER CODE END TIM4_Init 2 */
  HAL_TIM_MspPostInit(&htim4);

}

/**
  * @brief TIM5 Initialization Function
  * @param None
  * @retval None
  */
static void MX_TIM5_Init(void)
{

  /* USER CODE BEGIN TIM5_Init 0 */

  /* USER CODE END TIM5_Init 0 */

  TIM_Encoder_InitTypeDef sConfig = {0};
  TIM_MasterConfigTypeDef sMasterConfig = {0};

  /* USER CODE BEGIN TIM5_Init 1 */

  /* USER CODE END TIM5_Init 1 */
  htim5.Instance = TIM5;
  htim5.Init.Prescaler = 0;
  htim5.Init.CounterMode = TIM_COUNTERMODE_UP;
  htim5.Init.Period = 65535;
  htim5.Init.ClockDivision = TIM_CLOCKDIVISION_DIV1;
  htim5.Init.AutoReloadPreload = TIM_AUTORELOAD_PRELOAD_DISABLE;
  sConfig.EncoderMode = TIM_ENCODERMODE_TI1;
  sConfig.IC1Polarity = TIM_ICPOLARITY_RISING;
  sConfig.IC1Selection = TIM_ICSELECTION_DIRECTTI;
  sConfig.IC1Prescaler = TIM_ICPSC_DIV1;
  sConfig.IC1Filter = 0;
  sConfig.IC2Polarity = TIM_ICPOLARITY_RISING;
  sConfig.IC2Selection = TIM_ICSELECTION_DIRECTTI;
  sConfig.IC2Prescaler = TIM_ICPSC_DIV1;
  sConfig.IC2Filter = 0;
  if (HAL_TIM_Encoder_Init(&htim5, &sConfig) != HAL_OK)
  {
    Error_Handler();
  }
  sMasterConfig.MasterOutputTrigger = TIM_TRGO_RESET;
  sMasterConfig.MasterSlaveMode = TIM_MASTERSLAVEMODE_DISABLE;
  if (HAL_TIMEx_MasterConfigSynchronization(&htim5, &sMasterConfig) != HAL_OK)
  {
    Error_Handler();
  }
  /* USER CODE BEGIN TIM5_Init 2 */

  /* USER CODE END TIM5_Init 2 */

}

/**
  * @brief TIM9 Initialization Function
  * @param None
  * @retval None
  */
static void MX_TIM9_Init(void)
{

  /* USER CODE BEGIN TIM9_Init 0 */

  /* USER CODE END TIM9_Init 0 */

  TIM_ClockConfigTypeDef sClockSourceConfig = {0};

  /* USER CODE BEGIN TIM9_Init 1 */

  /* USER CODE END TIM9_Init 1 */
  htim9.Instance = TIM9;
  htim9.Init.Prescaler = 168;
  htim9.Init.CounterMode = TIM_COUNTERMODE_UP;
  htim9.Init.Period = 0xffff-1;
  htim9.Init.ClockDivision = TIM_CLOCKDIVISION_DIV1;
  htim9.Init.AutoReloadPreload = TIM_AUTORELOAD_PRELOAD_DISABLE;
  if (HAL_TIM_Base_Init(&htim9) != HAL_OK)
  {
    Error_Handler();
  }
  sClockSourceConfig.ClockSource = TIM_CLOCKSOURCE_INTERNAL;
  if (HAL_TIM_ConfigClockSource(&htim9, &sClockSourceConfig) != HAL_OK)
  {
    Error_Handler();
  }
  /* USER CODE BEGIN TIM9_Init 2 */

  /* USER CODE END TIM9_Init 2 */

}

/**
  * @brief USART3 Initialization Function
  * @param None
  * @retval None
  */
static void MX_USART3_UART_Init(void)
{

  /* USER CODE BEGIN USART3_Init 0 */

  /* USER CODE END USART3_Init 0 */

  /* USER CODE BEGIN USART3_Init 1 */

  /* USER CODE END USART3_Init 1 */
  huart3.Instance = USART3;
  huart3.Init.BaudRate = 115200;
  huart3.Init.WordLength = UART_WORDLENGTH_8B;
  huart3.Init.StopBits = UART_STOPBITS_1;
  huart3.Init.Parity = UART_PARITY_NONE;
  huart3.Init.Mode = UART_MODE_TX_RX;
  huart3.Init.HwFlowCtl = UART_HWCONTROL_NONE;
  huart3.Init.OverSampling = UART_OVERSAMPLING_16;
  if (HAL_UART_Init(&huart3) != HAL_OK)
  {
    Error_Handler();
  }
  /* USER CODE BEGIN USART3_Init 2 */

  /* USER CODE END USART3_Init 2 */

}

/**
  * @brief GPIO Initialization Function
  * @param None
  * @retval None
  */
static void MX_GPIO_Init(void)
{
  GPIO_InitTypeDef GPIO_InitStruct = {0};

  /* GPIO Ports Clock Enable */
  __HAL_RCC_GPIOC_CLK_ENABLE();
  __HAL_RCC_GPIOH_CLK_ENABLE();
  __HAL_RCC_GPIOA_CLK_ENABLE();
  __HAL_RCC_GPIOB_CLK_ENABLE();
  __HAL_RCC_GPIOD_CLK_ENABLE();

  /*Configure GPIO pin Output Level */
  HAL_GPIO_WritePin(GPIOD, GPIO_PIN_12|GPIO_PIN_13, GPIO_PIN_RESET);

  /*Configure GPIO pins : PD12 PD13 */
  GPIO_InitStruct.Pin = GPIO_PIN_12|GPIO_PIN_13;
  GPIO_InitStruct.Mode = GPIO_MODE_OUTPUT_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_HIGH;
  HAL_GPIO_Init(GPIOD, &GPIO_InitStruct);

}

/* USER CODE BEGIN 4 */
//////////////////////////////////////////////////////
//if(arr_indx>498){
//	*des_theta1=thd1_trac[1000-(arr_indx+4)];
//	*des_theta2=thd2_trac[1000-(arr_indx+4)];
//	*des_thetad1=vel_track_d1[1000-(arr_indx+4)];
//	*des_thetad2=vel_track_d2[1000-(arr_indx+4)];
//	if(arr_indx>=995){
//		data=1;
//	}
//}
//else{
//	*des_theta1=thd1_trac[arr_indx];
//	*des_theta2=thd2_trac[arr_indx];
//	*des_thetad1=vel_track_d1[arr_indx];
//	*des_thetad2=vel_track_d2[arr_indx];
//}
/////////////////////////////////////////////////////
/* USER CODE END 4 */

/**
  * @brief  This function is executed in case of error occurrence.
  * @retval None
  */
void Error_Handler(void)
{
  /* USER CODE BEGIN Error_Handler_Debug */
  /* User can add his own implementation to report the HAL error return state */
  __disable_irq();
  while (1)
  {
  }
  /* USER CODE END Error_Handler_Debug */
}

#ifdef  USE_FULL_ASSERT
/**
  * @brief  Reports the name of the source file and the source line number
  *         where the assert_param error has occurred.
  * @param  file: pointer to the source file name
  * @param  line: assert_param error line source number
  * @retval None
  */
void assert_failed(uint8_t *file, uint32_t line)
{
  /* USER CODE BEGIN 6 */
  /* User can add his own implementation to report the file name and line number,
     ex: printf("Wrong parameters value: file %s on line %d\r\n", file, line) */
  /* USER CODE END 6 */
}
#endif /* USE_FULL_ASSERT */
